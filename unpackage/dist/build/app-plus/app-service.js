if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const o=(e,t)=>{const a=e.__vccOpts||e;for(const[o,s]of t)a[o]=s;return a};const s=o({name:"CustomTabbar",props:{current:{type:String,default:""}},data:()=>({safeAreaBottom:0,tabs:[{name:"home",path:"/pages/index/index",text:"é¦–é¡µ"},{name:"mine",path:"/pages/mine/mine",text:"æˆ‘çš„"}]}),created(){var e;const t=uni.getSystemInfoSync();this.safeAreaBottom=(null==(e=t.safeAreaInsets)?void 0:e.bottom)||0},methods:{switchTab(e){this.current!==e.path&&uni.reLaunch({url:e.path})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"tabbar",style:e.normalizeStyle({paddingBottom:l.safeAreaBottom+"px"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.tabs,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"tabbar-item",key:a,onClick:e=>n.switchTab(t)},[e.createElementVNode("view",{class:"icon-wrap"},["home"===t.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-box"},[e.createElementVNode("view",{class:e.normalizeClass(["home-icon",{active:o.current===t.path}])},[e.createElementVNode("view",{class:"home-roof"}),e.createElementVNode("view",{class:"home-body"})],2)])):e.createCommentVNode("",!0),"mine"===t.name?(e.openBlock(),e.createElementBlock("view",{key:1,class:"icon-box"},[e.createElementVNode("view",{class:e.normalizeClass(["user-icon",{active:o.current===t.path}])},[e.createElementVNode("view",{class:"user-head"}),e.createElementVNode("view",{class:"user-body"})],2)])):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:e.normalizeClass(["tabbar-text",{active:o.current===t.path}])},e.toDisplayString(t.text),3)],8,["onClick"])))),128))],4)}],["__scopeId","data-v-c88f34f5"]]),l=e=>new Promise(((t,a)=>{const o=uni.getStorageSync("token"),s={"Content-Type":"application/json",...e.header};s["X-Client-Type"]="app",o&&(s.Authorization=`Bearer ${o}`),uni.request({url:"https://dns.6qu.cc/api"+e.url,method:e.method||"GET",data:e.data,header:s,success:e=>{if(401===e.statusCode)return uni.removeStorageSync("token"),uni.removeStorageSync("userInfo"),uni.showToast({title:"è¯·é‡æ–°ç™»å½•",icon:"none"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500),void a(e.data);e.data.code>=200&&e.data.code<300?t(e.data):(uni.showToast({title:e.data.message||"è¯·æ±‚å¤±è´¥",icon:"none"}),a(e.data))},fail:e=>{uni.showToast({title:"ç½‘ç»œé”™è¯¯",icon:"none"}),a(e)}})}));function n(){return l({url:"/announcements",method:"GET"})}const i=function(e){return l({url:`/announcements/${e}/read`,method:"POST"})};const c=function(){return l({url:"/domains",method:"GET"})},r=function(e={}){return l({url:"/subdomains",method:"GET",data:e})},d=function(e,t){return l({url:`/subdomains/${e}/renew`,method:"POST",data:t})},m=e=>{uni.setStorageSync("token",e)},u=e=>{uni.setStorageSync("userInfo",JSON.stringify(e))},p=()=>{const e=uni.getStorageSync("userInfo");return e?JSON.parse(e):null},h=()=>!!uni.getStorageSync("token"),E=()=>{uni.removeStorageSync("token"),uni.removeStorageSync("userInfo")};const w=o({components:{CustomTabbar:s},data:()=>({statusBarHeight:20,navBarHeight:88,announcements:[],domains:[],myDomains:[],isLoggedIn:!1,loading:!0}),onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight,this.navBarHeight=e.statusBarHeight+44},onShow(){this.isLoggedIn=h(),this.loadData()},onPullDownRefresh(){this.loadData().then((()=>uni.stopPullDownRefresh()))},methods:{async loadData(){var e,a,o;this.loading=!0;try{const t=await n();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[];const s=await c();if(this.domains=(null==(a=s.data)?void 0:a.domains)||[],this.isLoggedIn){const e=await r();this.myDomains=(null==(o=e.data)?void 0:o.subdomains)||[]}}catch(s){t("error","at pages/index/index.vue:243","åŠ è½½æ•°æ®å¤±è´¥",s)}finally{this.loading=!1}},goToAnnouncements(){uni.navigateTo({url:"/pages/announcement/list"})},goToPurchase(){uni.navigateTo({url:"/pages/domain/purchase"})},goToMyDomains(){this.isLoggedIn?uni.navigateTo({url:"/pages/domain/list"}):uni.navigateTo({url:"/pages/login/login"})},goToRecharge(){this.isLoggedIn?uni.navigateTo({url:"/pages/recharge/recharge"}):uni.navigateTo({url:"/pages/login/login"})},goToRecords(){this.isLoggedIn?uni.navigateTo({url:"/pages/record/record"}):uni.navigateTo({url:"/pages/login/login"})},selectDomain(e){uni.navigateTo({url:`/pages/domain/purchase?domainId=${e.id}`})},goToDomainDetail(e){uni.navigateTo({url:`/pages/domain/detail?id=${e.id}`})}}},[["render",function(t,o,l,n,i,c){const r=a(e.resolveDynamicComponent("custom-tabbar"),s);return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:i.statusBarHeight+"px"})},[e.createElementVNode("view",{class:"nav-content"},[e.createElementVNode("view",{class:"nav-brand"},[e.createElementVNode("text",{class:"nav-logo"},"å…­è¶£DNS")])])],4),e.createElementVNode("view",{class:"page-content",style:e.normalizeStyle({paddingTop:i.navBarHeight+"px"})},[e.createElementVNode("view",{class:"hero-section"},[e.createElementVNode("view",{class:"hero-bg"}),e.createElementVNode("view",{class:"hero-content"},[e.createElementVNode("text",{class:"hero-title"},"ä¸“ä¸šDNSè§£ææœåŠ¡"),e.createElementVNode("text",{class:"hero-subtitle"},"ç¨³å®š Â· å¿«é€Ÿ Â· å®‰å…¨"),e.createElementVNode("view",{class:"hero-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},e.toDisplayString(i.domains.length),1),e.createElementVNode("text",{class:"stat-label"},"å¯ç”¨åŸŸå")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},e.toDisplayString(i.myDomains.length),1),e.createElementVNode("text",{class:"stat-label"},"æˆ‘çš„åŸŸå")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},"24/7"),e.createElementVNode("text",{class:"stat-label"},"å…¨å¤©æœåŠ¡")])])])]),i.announcements.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"notice-bar",onClick:o[0]||(o[0]=(...e)=>c.goToAnnouncements&&c.goToAnnouncements(...e))},[e.createElementVNode("view",{class:"notice-tag"},"é€šçŸ¥"),e.createElementVNode("swiper",{class:"notice-swiper",vertical:"",autoplay:"",circular:"",interval:3e3},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.announcements,(t=>(e.openBlock(),e.createElementBlock("swiper-item",{key:t.id},[e.createElementVNode("text",{class:"notice-text"},e.toDisplayString(t.title),1)])))),128))]),e.createElementVNode("text",{class:"notice-arrow"},"â€º")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"service-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"å¿«æ·æœåŠ¡")]),e.createElementVNode("view",{class:"service-grid"},[e.createElementVNode("view",{class:"service-card",onClick:o[1]||(o[1]=(...e)=>c.goToPurchase&&c.goToPurchase(...e))},[e.createElementVNode("view",{class:"service-icon-wrap blue"},[e.createElementVNode("text",{class:"service-icon"},"ğŸŒ")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"æ³¨å†ŒåŸŸå"),e.createElementVNode("text",{class:"service-desc"},"å¿«é€Ÿæ³¨å†ŒäºŒçº§åŸŸå")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:o[2]||(o[2]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"service-icon-wrap green"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ“Š")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"service-desc"},"ç®¡ç†DNSè§£æè®°å½•")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:o[3]||(o[3]=(...e)=>c.goToRecharge&&c.goToRecharge(...e))},[e.createElementVNode("view",{class:"service-icon-wrap orange"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ’³")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"è´¦æˆ·å……å€¼"),e.createElementVNode("text",{class:"service-desc"},"ä½¿ç”¨å¡å¯†å……å€¼ä½™é¢")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:o[4]||(o[4]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"service-icon-wrap purple"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ“‹")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"service-desc"},"æŸ¥çœ‹è´­ä¹°ä¸ç»­è´¹è®°å½•")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"domain-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"å¯é€‰åŸŸååç¼€"),e.createElementVNode("text",{class:"section-more",onClick:o[5]||(o[5]=(...e)=>c.goToPurchase&&c.goToPurchase(...e))},"å…¨éƒ¨ â€º")]),e.createElementVNode("view",{class:"domain-cards"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id,onClick:e=>c.selectDomain(t)},[e.createElementVNode("view",{class:"domain-card-header"},[e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(t.name.split(".").pop()),1),t.allow_register?(e.openBlock(),e.createElementBlock("view",{key:0,class:"domain-badge"},"å¯æ³¨å†Œ")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"domain-full"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:"domain-card-footer"},[e.createElementVNode("text",{class:"domain-registered"},e.toDisplayString(t.subdomains_count)+" å·²æ³¨å†Œ",1),e.createElementVNode("view",{class:"domain-register-btn"},"ç«‹å³æ³¨å†Œ")])],8,["onClick"])))),128))]),0!==i.domains.length||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“­"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¯ç”¨åŸŸå")]))]),i.isLoggedIn&&i.myDomains.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"my-domain-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"æˆ‘çš„åŸŸå"),e.createElementVNode("text",{class:"section-more",onClick:o[6]||(o[6]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},"ç®¡ç† â€º")]),e.createElementVNode("view",{class:"my-domain-cards"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.myDomains.slice(0,3),(t=>(e.openBlock(),e.createElementBlock("view",{class:"my-domain-card",key:t.id,onClick:e=>c.goToDomainDetail(t)},[e.createElementVNode("view",{class:"my-domain-left"},[e.createElementVNode("view",{class:e.normalizeClass(["my-domain-status",{expired:t.is_expired,active:!t.is_expired}])},null,2),e.createElementVNode("view",{class:"my-domain-content"},[e.createElementVNode("text",{class:"my-domain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("text",{class:"my-domain-meta"},e.toDisplayString(t.records_count)+" æ¡è§£æè®°å½•",1)])]),e.createElementVNode("view",{class:"my-domain-right"},[e.createElementVNode("text",{class:e.normalizeClass(["my-domain-expire",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":`${t.days_remaining}å¤©`),3),e.createElementVNode("text",{class:"my-domain-arrow"},"â€º")])],8,["onClick"])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"feature-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬")]),e.createElementVNode("view",{class:"feature-list"},[e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"âš¡"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"æé€Ÿè§£æ"),e.createElementVNode("text",{class:"feature-desc"},"åŸºäºCloudflareå…¨çƒCDNï¼Œæ¯«ç§’çº§å“åº”")])]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"ğŸ›¡ï¸"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"å®‰å…¨å¯é "),e.createElementVNode("text",{class:"feature-desc"},"DDoSé˜²æŠ¤ï¼ŒSSLåŠ å¯†ï¼Œæ•°æ®å®‰å…¨æœ‰ä¿éšœ")])]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"ğŸ’¡"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"ç®€å•æ˜“ç”¨"),e.createElementVNode("text",{class:"feature-desc"},"å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œä¸€é”®é…ç½®DNSè®°å½•")])])])]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"footer-text"},"å…­è¶£DNS Â· ä¸“ä¸šåŸŸåè§£ææœåŠ¡"),e.createElementVNode("text",{class:"footer-copyright"},"Â© 2024 All Rights Reserved")]),e.createElementVNode("view",{class:"bottom-space"})],4),e.createVNode(r,{current:"/pages/index/index"})])}]]);function v(e){return l({url:"/auth/captcha",method:"GET",data:e?{id:e}:{}})}function V(){return l({url:"/auth/me",method:"GET"})}const g=o({components:{CustomTabbar:s},data:()=>({statusBarHeight:20,navBarHeight:88,isLoggedIn:!1,userInfo:null,unreadCount:0}),computed:{isAdmin(){var e,t;return"admin"===(null==(e=this.userInfo)?void 0:e.role)||"demo"===(null==(t=this.userInfo)?void 0:t.role)},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)},roleText(){var e;const t=null==(e=this.userInfo)?void 0:e.role;return"admin"===t?"ç®¡ç†å‘˜":"demo"===t?"æ¼”ç¤º":"ç”¨æˆ·"}},onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight,this.navBarHeight=e.statusBarHeight+44},onShow(){this.isLoggedIn=h(),this.isLoggedIn?(this.loadUserInfo(),this.loadUnreadCount()):this.userInfo=null},methods:{async loadUserInfo(){try{const e=await V();this.userInfo=e.data,u(e.data)}catch(e){this.userInfo=p()}},async loadUnreadCount(){var e;try{const t=await l({url:"/announcements/unread",method:"GET"});this.unreadCount=(null==(e=t.data)?void 0:e.unread_count)||0}catch(a){t("error","at pages/mine/mine.vue:214","è·å–æœªè¯»å…¬å‘Šå¤±è´¥",a)}},goToLogin(){uni.navigateTo({url:"/pages/login/login"})},goToRecharge(){this.isLoggedIn?uni.navigateTo({url:"/pages/recharge/recharge"}):uni.navigateTo({url:"/pages/login/login"})},goToMyDomains(){this.isLoggedIn?uni.navigateTo({url:"/pages/domain/list"}):uni.navigateTo({url:"/pages/login/login"})},goToRecords(){this.isLoggedIn?uni.navigateTo({url:"/pages/record/record"}):uni.navigateTo({url:"/pages/login/login"})},goToAnnouncements(){uni.navigateTo({url:"/pages/announcement/list"})},goToSettings(){uni.navigateTo({url:"/pages/settings/settings"})},goToAdmin(){uni.navigateTo({url:"/pages/admin/index"})},handleLogout(){uni.showModal({title:"æç¤º",content:"ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ",success:e=>{e.confirm&&(E(),this.isLoggedIn=!1,this.userInfo=null,uni.showToast({title:"å·²é€€å‡ºç™»å½•",icon:"success"}))}})}}},[["render",function(t,o,l,n,i,c){var r,d,m,u,p,h,E,w;const v=a(e.resolveDynamicComponent("custom-tabbar"),s);return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:i.statusBarHeight+"px"})},[e.createElementVNode("view",{class:"nav-content"},[e.createElementVNode("text",{class:"nav-title"},"ä¸ªäººä¸­å¿ƒ")])],4),e.createElementVNode("view",{class:"page-content","scroll-y":"",style:e.normalizeStyle({paddingTop:i.navBarHeight+"px"})},[e.createElementVNode("view",{class:"user-section"},[e.createElementVNode("view",{class:"user-bg"}),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"user-content"},[e.createElementVNode("view",{class:"avatar-wrap"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString((null==(m=null==(d=null==(r=i.userInfo)?void 0:r.username)?void 0:d.charAt(0))?void 0:m.toUpperCase())||"U"),1)]),e.createElementVNode("view",{class:e.normalizeClass(["user-status",{admin:c.isAdmin,demo:c.isDemo}])},[e.createElementVNode("text",{class:"status-text"},e.toDisplayString(c.roleText),1)],2)]),e.createElementVNode("text",{class:"username"},e.toDisplayString((null==(u=i.userInfo)?void 0:u.username)||"ç”¨æˆ·"),1),e.createElementVNode("text",{class:"email"},e.toDisplayString((null==(p=i.userInfo)?void 0:p.email)||""),1)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"user-content guest",onClick:o[0]||(o[0]=(...e)=>c.goToLogin&&c.goToLogin(...e))},[e.createElementVNode("view",{class:"avatar-wrap"},[e.createElementVNode("view",{class:"avatar guest"},[e.createElementVNode("text",{class:"avatar-text"},"ğŸ‘¤")])]),e.createElementVNode("text",{class:"username"},"ç‚¹å‡»ç™»å½•"),e.createElementVNode("text",{class:"email"},"ç™»å½•åäº«å—å®Œæ•´æœåŠ¡")]))]),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"overview-card"},[e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(h=i.userInfo)?void 0:h.balance_text)||"Â¥0.00"),1),e.createElementVNode("text",{class:"overview-label"},"è´¦æˆ·ä½™é¢")]),e.createElementVNode("view",{class:"overview-divider"}),e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(E=i.userInfo)?void 0:E.used_domains)||0),1),e.createElementVNode("text",{class:"overview-label"},"å·²ç”¨åŸŸå")]),e.createElementVNode("view",{class:"overview-divider"}),e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(w=i.userInfo)?void 0:w.max_domains)||0),1),e.createElementVNode("text",{class:"overview-label"},"åŸŸåä¸Šé™")])])):e.createCommentVNode("",!0),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:1,class:"quick-actions"},[e.createElementVNode("view",{class:"action-item",onClick:o[1]||(o[1]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"action-text"},"æˆ‘çš„åŸŸå")]),e.createElementVNode("view",{class:"action-item",onClick:o[2]||(o[2]=(...e)=>c.goToRecharge&&c.goToRecharge(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸ’³"),e.createElementVNode("text",{class:"action-text"},"å……å€¼")]),e.createElementVNode("view",{class:"action-item",onClick:o[3]||(o[3]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"action-text"},"è®°å½•")]),e.createElementVNode("view",{class:"action-item",onClick:o[4]||(o[4]=(...e)=>c.goToAnnouncements&&c.goToAnnouncements(...e))},[e.createElementVNode("view",{class:"action-icon"},[e.createTextVNode(" ğŸ“¢ "),i.unreadCount>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-badge"},[e.createElementVNode("text",{class:"badge-text"},e.toDisplayString(i.unreadCount>99?"99+":i.unreadCount),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"action-text"},"å…¬å‘Š")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"menu-section-title"},"æœåŠ¡ä¸è®¾ç½®"),e.createElementVNode("view",{class:"menu-card"},[e.createElementVNode("view",{class:"menu-item",onClick:o[5]||(o[5]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap blue"},[e.createElementVNode("text",{class:"menu-icon"},"ğŸŒ")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"menu-desc"},"æŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„åŸŸå")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:o[6]||(o[6]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap green"},[e.createElementVNode("text",{class:"menu-icon"},"ğŸ“")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"menu-desc"},"è´­ä¹°å’Œç»­è´¹å†å²")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:o[7]||(o[7]=(...e)=>c.goToSettings&&c.goToSettings(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap gray"},[e.createElementVNode("text",{class:"menu-icon"},"âš™ï¸")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"è´¦æˆ·è®¾ç½®"),e.createElementVNode("text",{class:"menu-desc"},"å¯†ç ã€å®‰å…¨è®¾ç½®")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])]),c.isAdmin?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["menu-card admin-card",{"demo-card":c.isDemo}])},[e.createElementVNode("view",{class:"menu-item",onClick:o[8]||(o[8]=(...e)=>c.goToAdmin&&c.goToAdmin(...e))},[e.createElementVNode("view",{class:e.normalizeClass(["menu-icon-wrap",c.isDemo?"orange":"red"])},[e.createElementVNode("text",{class:"menu-icon"},e.toDisplayString(c.isDemo?"ğŸ‘ï¸":"ğŸ›¡ï¸"),1)],2),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},e.toDisplayString(c.isDemo?"æ¼”ç¤ºä¸­å¿ƒ":"ç®¡ç†ä¸­å¿ƒ"),1),e.createElementVNode("text",{class:"menu-desc"},e.toDisplayString(c.isDemo?"æŸ¥çœ‹ç³»ç»Ÿæ•°æ®ï¼ˆåªè¯»ï¼‰":"ç³»ç»Ÿç®¡ç†ä¸æ•°æ®ç»Ÿè®¡"),1)]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])],2)):e.createCommentVNode("",!0)]),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:2,class:"logout-section"},[e.createElementVNode("view",{class:"logout-btn",onClick:o[9]||(o[9]=(...e)=>c.handleLogout&&c.handleLogout(...e))},[e.createElementVNode("text",{class:"logout-text"},"é€€å‡ºç™»å½•")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"footer-info"},[e.createElementVNode("text",{class:"version-text"},"å…­è¶£DNS v1.0.0")]),e.createElementVNode("view",{class:"bottom-space"})],4),e.createVNode(v,{current:"/pages/mine/mine"})])}]]);const N=o({data:()=>({form:{email:"",password:"",captcha:"",captcha_id:""},needCaptcha:!0,captchaUrl:""}),onLoad(){this.refreshCaptcha()},methods:{async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(o){t("error","at pages/login/login.vue:96","è·å–éªŒè¯ç å¤±è´¥",o)}},async handleLogin(){var e;if(this.form.email)if(this.form.password)if(this.form.captcha)try{uni.showLoading({title:"ç™»å½•ä¸­..."});const t=await(e={email:this.form.email,password:this.form.password,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},l({url:"/auth/login",method:"POST",data:e}));uni.hideLoading(),m(t.data.access_token),u(t.data.user),uni.showToast({title:"ç™»å½•æˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.reLaunch({url:"/pages/mine/mine"})}),1500)}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¯†ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},goToRegister(){uni.navigateTo({url:"/pages/register/register"})},goToForgotPassword(){uni.navigateTo({url:"/pages/forgot-password/forgot-password"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"ğŸŒ")]),e.createElementVNode("text",{class:"brand-name"},"å…­è¶£DNS"),e.createElementVNode("text",{class:"brand-slogan"},"ä¸“ä¸šåŸŸåè§£ææœåŠ¡")]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("text",{class:"form-title"},"è´¦å·ç™»å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>l.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±"},null,512),[[e.vModelText,l.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[1]||(a[1]=e=>l.form.password=e),placeholder:"è¯·è¾“å…¥å¯†ç "},null,512),[[e.vModelText,l.form.password]])])]),l.needCaptcha?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>l.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,l.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:l.captchaUrl,onClick:a[3]||(a[3]=(...e)=>n.refreshCaptcha&&n.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"btn-primary",onClick:a[4]||(a[4]=(...e)=>n.handleLogin&&n.handleLogin(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç™» å½•")]),e.createElementVNode("view",{class:"form-footer"},[e.createElementVNode("text",{class:"forgot-link",onClick:a[5]||(a[5]=(...e)=>n.goToForgotPassword&&n.goToForgotPassword(...e))},"å¿˜è®°å¯†ç ï¼Ÿ")])]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-tip"},"è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ"),e.createElementVNode("text",{class:"register-link",onClick:a[6]||(a[6]=(...e)=>n.goToRegister&&n.goToRegister(...e))},"ç«‹å³æ³¨å†Œ")]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"footer-text"},"Â© 2024 å…­è¶£DNS Â· å®‰å…¨å¯é çš„DNSæœåŠ¡")])])}]]);const f=o({data:()=>({smtpConfigured:!0,step:1,form:{email:"",username:"",password:"",confirmPassword:"",token:"",captcha:"",captcha_id:""},captchaUrl:""}),onLoad(e){e.token?(this.form.token=e.token,this.step=2,this.smtpConfigured=!0):this.checkSmtp()},methods:{async checkSmtp(){var e;try{const t=await l({url:"/auth/smtp-status",method:"GET"});this.smtpConfigured=(null==(e=t.data)?void 0:e.configured)||!1,this.refreshCaptcha()}catch(t){this.smtpConfigured=!1,this.refreshCaptcha()}},async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(o){t("error","at pages/register/register.vue:182","è·å–éªŒè¯ç å¤±è´¥",o)}},async sendVerifyEmail(){var e;if(this.form.email)if(this.form.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={email:this.form.email,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},l({url:"/auth/register/send",method:"POST",data:e})),uni.hideLoading(),uni.showModal({title:"éªŒè¯é‚®ä»¶å·²å‘é€",content:"è¯·å‰å¾€é‚®ç®±ç‚¹å‡»éªŒè¯é“¾æ¥å®Œæˆæ³¨å†Œ",showCancel:!1,confirmText:"æˆ‘çŸ¥é“äº†"})}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},async completeRegister(){var e;if(this.form.token){if(this.validateForm())try{uni.showLoading({title:"æ³¨å†Œä¸­..."});const t=await(e={token:this.form.token,username:this.form.username,password:this.form.password},l({url:"/auth/register/complete",method:"POST",data:e}));uni.hideLoading(),m(t.data.access_token),u(t.data.user),uni.showToast({title:"æ³¨å†ŒæˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.switchTab({url:"/pages/mine/mine"})}),1500)}catch(t){uni.hideLoading()}}else uni.showToast({title:"éªŒè¯é“¾æ¥æ— æ•ˆ",icon:"none"})},async handleRegister(){var e,t;if(this.validateForm())try{uni.showLoading({title:"æ³¨å†Œä¸­..."});const a=await(t={username:this.form.username,email:this.form.email,password:this.form.password},l({url:"/auth/register",method:"POST",data:t}));uni.hideLoading(),(null==(e=a.data)?void 0:e.access_token)&&(m(a.data.access_token),u(a.data.user)),uni.showToast({title:"æ³¨å†ŒæˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.switchTab({url:"/pages/mine/mine"})}),1500)}catch(a){uni.hideLoading()}},validateForm(){return!this.form.username||this.form.username.length<3||this.form.username.length>20?(uni.showToast({title:"ç”¨æˆ·åéœ€3-20ä¸ªå­—ç¬¦",icon:"none"}),!1):this.smtpConfigured||this.form.email?!this.form.password||this.form.password.length<6||this.form.password.length>32?(uni.showToast({title:"å¯†ç éœ€6-32ä¸ªå­—ç¬¦",icon:"none"}),!1):this.form.password===this.form.confirmPassword||(uni.showToast({title:"ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´",icon:"none"}),!1):(uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"}),!1)},goToLogin(){uni.navigateTo({url:"/pages/login/login"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"âœ¨")]),e.createElementVNode("text",{class:"brand-name"},"åˆ›å»ºè´¦å·"),e.createElementVNode("text",{class:"brand-slogan"},"åŠ å…¥å…­è¶£DNSï¼Œå¼€å¯åŸŸåä¹‹æ—…")]),e.createElementVNode("view",{class:"form-card"},[l.smtpConfigured?(e.openBlock(),e.createElementBlock("view",{key:0,class:"steps"},[e.createElementVNode("view",{class:e.normalizeClass(["step",{active:l.step>=1}])},[e.createElementVNode("view",{class:"step-num"},"1"),e.createElementVNode("text",{class:"step-text"},"éªŒè¯é‚®ç®±")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:l.step>=2}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step",{active:l.step>=2}])},[e.createElementVNode("view",{class:"step-num"},"2"),e.createElementVNode("text",{class:"step-text"},"å®Œå–„ä¿¡æ¯")],2)])):e.createCommentVNode("",!0),l.smtpConfigured&&1===l.step?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>l.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€"},null,512),[[e.vModelText,l.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>l.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,l.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:l.captchaUrl,onClick:a[2]||(a[2]=(...e)=>n.refreshCaptcha&&n.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[3]||(a[3]=(...e)=>n.sendVerifyEmail&&n.sendVerifyEmail(...e))},[e.createElementVNode("text",{class:"btn-text"},"å‘é€éªŒè¯é‚®ä»¶")])])):e.createCommentVNode("",!0),l.smtpConfigured&&2===l.step?(e.openBlock(),e.createElementBlock("view",{key:2,class:"form-content"},[e.createElementVNode("view",{class:"tip-card"},[e.createElementVNode("text",{class:"tip-icon"},"âœ…"),e.createElementVNode("text",{class:"tip-text"},"é‚®ç®±éªŒè¯æˆåŠŸï¼Œè¯·å®Œå–„è´¦å·ä¿¡æ¯")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ‘¤"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>l.form.username=e),placeholder:"ç”¨æˆ·å (3-20ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,l.form.username]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>l.form.password=e),placeholder:"å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,l.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[6]||(a[6]=e=>l.form.confirmPassword=e),placeholder:"ç¡®è®¤å¯†ç "},null,512),[[e.vModelText,l.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[7]||(a[7]=(...e)=>n.completeRegister&&n.completeRegister(...e))},[e.createElementVNode("text",{class:"btn-text"},"å®Œæˆæ³¨å†Œ")])])):e.createCommentVNode("",!0),l.smtpConfigured?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ‘¤"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[8]||(a[8]=e=>l.form.username=e),placeholder:"ç”¨æˆ·å (3-20ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,l.form.username]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[9]||(a[9]=e=>l.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±"},null,512),[[e.vModelText,l.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[10]||(a[10]=e=>l.form.password=e),placeholder:"å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,l.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[11]||(a[11]=e=>l.form.confirmPassword=e),placeholder:"ç¡®è®¤å¯†ç "},null,512),[[e.vModelText,l.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[12]||(a[12]=(...e)=>n.handleRegister&&n.handleRegister(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç«‹å³æ³¨å†Œ")])]))]),e.createElementVNode("view",{class:"login-section"},[e.createElementVNode("text",{class:"login-tip"},"å·²æœ‰è´¦å·ï¼Ÿ"),e.createElementVNode("text",{class:"login-link",onClick:a[13]||(a[13]=(...e)=>n.goToLogin&&n.goToLogin(...e))},"ç«‹å³ç™»å½•")])])}]]);const y=o({data:()=>({hasToken:!1,step:1,form:{email:"",token:"",password:"",confirmPassword:"",captcha:"",captcha_id:""},captchaUrl:""}),onLoad(e){e.token?(this.form.token=e.token,this.hasToken=!0):this.refreshCaptcha()},methods:{async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(o){t("error","at pages/forgot-password/forgot-password.vue:140","è·å–éªŒè¯ç å¤±è´¥",o)}},async sendResetEmail(){var e;if(this.form.email)if(this.form.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={email:this.form.email,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},l({url:"/auth/forgot-password",method:"POST",data:e})),uni.hideLoading(),this.step=2}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},async resetPassword(){var e;if(!this.form.password||this.form.password.length<6||this.form.password.length>32)uni.showToast({title:"å¯†ç éœ€6-32ä¸ªå­—ç¬¦",icon:"none"});else if(this.form.password===this.form.confirmPassword)try{uni.showLoading({title:"é‡ç½®ä¸­..."}),await(e={token:this.form.token,password:this.form.password},l({url:"/auth/reset-password",method:"POST",data:e})),uni.hideLoading(),uni.showModal({title:"é‡ç½®æˆåŠŸ",content:"å¯†ç å·²é‡ç½®ï¼Œè¯·ä½¿ç”¨æ–°å¯†ç ç™»å½•",showCancel:!1,success:()=>{uni.redirectTo({url:"/pages/login/login"})}})}catch(t){uni.hideLoading()}else uni.showToast({title:"ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´",icon:"none"})},goToLogin(){uni.navigateTo({url:"/pages/login/login"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"ğŸ”‘")]),e.createElementVNode("text",{class:"brand-name"},e.toDisplayString(l.hasToken?"é‡ç½®å¯†ç ":"å¿˜è®°å¯†ç "),1),e.createElementVNode("text",{class:"brand-slogan"},e.toDisplayString(l.hasToken?"è®¾ç½®æ‚¨çš„æ–°å¯†ç ":"é€šè¿‡é‚®ç®±æ‰¾å›æ‚¨çš„å¯†ç "),1)]),e.createElementVNode("view",{class:"form-card"},[l.hasToken?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"steps"},[e.createElementVNode("view",{class:e.normalizeClass(["step",{active:l.step>=1}])},[e.createElementVNode("view",{class:"step-num"},"1"),e.createElementVNode("text",{class:"step-text"},"éªŒè¯é‚®ç®±")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:l.step>=2}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step",{active:l.step>=2}])},[e.createElementVNode("view",{class:"step-num"},"2"),e.createElementVNode("text",{class:"step-text"},"é‡ç½®å¯†ç ")],2)])),l.hasToken||1!==l.step?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>l.form.email=e),placeholder:"è¯·è¾“å…¥æ³¨å†Œé‚®ç®±"},null,512),[[e.vModelText,l.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>l.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,l.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:l.captchaUrl,onClick:a[2]||(a[2]=(...e)=>n.refreshCaptcha&&n.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[3]||(a[3]=(...e)=>n.sendResetEmail&&n.sendResetEmail(...e))},[e.createElementVNode("text",{class:"btn-text"},"å‘é€é‡ç½®é‚®ä»¶")])])),l.hasToken||2!==l.step?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"form-content"},[e.createElementVNode("view",{class:"success-card"},[e.createElementVNode("text",{class:"success-icon"},"ğŸ“¬"),e.createElementVNode("text",{class:"success-title"},"é‚®ä»¶å·²å‘é€"),e.createElementVNode("text",{class:"success-text"},"é‡ç½®å¯†ç é‚®ä»¶å·²å‘é€åˆ° "+e.toDisplayString(l.form.email),1),e.createElementVNode("text",{class:"success-tip"},"è¯·å‰å¾€é‚®ç®±ç‚¹å‡»é“¾æ¥é‡ç½®å¯†ç ")]),e.createElementVNode("view",{class:"btn-secondary",onClick:a[4]||(a[4]=e=>l.step=1)},[e.createElementVNode("text",{class:"btn-text-secondary"},"é‡æ–°å‘é€")])])),l.hasToken?(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-content"},[e.createElementVNode("view",{class:"tip-card"},[e.createElementVNode("text",{class:"tip-icon"},"âœ…"),e.createElementVNode("text",{class:"tip-text"},"éªŒè¯æˆåŠŸï¼Œè¯·è®¾ç½®æ–°å¯†ç ")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>l.form.password=e),placeholder:"æ–°å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,l.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[6]||(a[6]=e=>l.form.confirmPassword=e),placeholder:"ç¡®è®¤æ–°å¯†ç "},null,512),[[e.vModelText,l.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[7]||(a[7]=(...e)=>n.resetPassword&&n.resetPassword(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç¡®è®¤é‡ç½®")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"login-section"},[e.createElementVNode("text",{class:"login-tip"},"æƒ³èµ·å¯†ç äº†ï¼Ÿ"),e.createElementVNode("text",{class:"login-link",onClick:a[8]||(a[8]=(...e)=>n.goToLogin&&n.goToLogin(...e))},"è¿”å›ç™»å½•")])])}]]);const x=o({data:()=>({subdomains:[],loading:!0,refreshing:!1}),onShow(){this.loadData()},methods:{async onRefresh(){this.refreshing=!0,await this.loadData(),this.refreshing=!1},async loadData(){var e;this.loading=!0;try{const t=await r();this.subdomains=(null==(e=t.data)?void 0:e.subdomains)||[]}catch(a){t("error","at pages/domain/list.vue:84","åŠ è½½åŸŸåå¤±è´¥",a)}finally{this.loading=!1}},goToDetail(e){uni.navigateTo({url:`/pages/domain/detail?id=${e.id}`})},goToPurchase(){uni.navigateTo({url:"/pages/domain/purchase"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"header-title"},"æˆ‘çš„åŸŸå"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.subdomains.length)+" ä¸ª",1)])]),e.createElementVNode("scroll-view",{class:"domain-list","scroll-y":"","refresher-enabled":"","refresher-triggered":l.refreshing,onRefresherrefresh:a[1]||(a[1]=(...e)=>n.onRefresh&&n.onRefresh(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.subdomains,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id,onClick:e=>n.goToDetail(t)},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["status-dot",{expired:t.is_expired}])},null,2)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("view",{class:"domain-meta"},[e.createElementVNode("text",{class:"meta-item"},e.toDisplayString((null==(a=t.plan)?void 0:a.name)||"å¥—é¤"),1),e.createElementVNode("text",{class:"meta-dot"},"Â·"),e.createElementVNode("text",{class:"meta-item"},e.toDisplayString(t.records_count)+" æ¡è®°å½•",1)])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("text",{class:e.normalizeClass(["expire-text",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":`${t.days_remaining}å¤©`),3),e.createElementVNode("text",{class:"arrow"},"â€º")])],8,["onClick"])})),128)),l.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-state"},[e.createElementVNode("text",{class:"loading-text"},"åŠ è½½ä¸­...")])):e.createCommentVNode("",!0),0!==l.subdomains.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"empty-title"},"æš‚æ— åŸŸå"),e.createElementVNode("text",{class:"empty-desc"},"ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ³¨å†Œæ‚¨çš„ç¬¬ä¸€ä¸ªåŸŸå"),e.createElementVNode("view",{class:"empty-btn",onClick:a[0]||(a[0]=(...e)=>n.goToPurchase&&n.goToPurchase(...e))},[e.createElementVNode("text",{class:"empty-btn-text"},"ç«‹å³æ³¨å†Œ")])])),e.createElementVNode("view",{class:"bottom-space"})],40,["refresher-triggered"]),e.createElementVNode("view",{class:"fab",onClick:a[2]||(a[2]=(...e)=>n.goToPurchase&&n.goToPurchase(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")])])}]]);const k=o({data:()=>({domains:[],plans:[],selectedDomain:null,selectedPlan:null,subdomainName:"",couponCode:"",couponLoading:!1,couponApplied:!1,couponInfo:null}),computed:{finalPrice(){return this.selectedPlan?this.selectedPlan.price<=0?"å…è´¹":this.couponApplied&&this.couponInfo?"Â¥"+this.couponInfo.final_price:"Â¥"+this.selectedPlan.price:"Â¥0"}},onLoad(e){this.loadDomains(e.domainId)},methods:{async loadDomains(e){var a;try{const t=await c();if(this.domains=(null==(a=t.data)?void 0:a.domains)||[],e){const t=this.domains.find((t=>t.id==e));t&&this.selectDomain(t)}}catch(o){t("error","at pages/domain/purchase.vue:192","åŠ è½½åŸŸåå¤±è´¥",o)}},async selectDomain(e){var a,o;this.selectedDomain=e,this.selectedPlan=null,this.cancelCoupon();try{const t=await(o=e.id,l({url:`/domains/${o}/plans`,method:"GET"}));this.plans=(null==(a=t.data)?void 0:a.plans)||[]}catch(s){t("error","at pages/domain/purchase.vue:203","åŠ è½½å¥—é¤å¤±è´¥",s)}},selectPlan(e){this.selectedPlan=e,this.cancelCoupon()},async handleCoupon(){if(this.couponCode.trim()){if(!this.couponLoading){this.couponLoading=!0;try{const t=await(e={code:this.couponCode.trim(),plan_id:this.selectedPlan.id,price:this.selectedPlan.price},l({url:"/coupon/validate",method:"POST",data:e}));this.couponInfo=t.data,this.couponApplied=!0,uni.showToast({title:"ä¼˜æƒ ç å·²åº”ç”¨",icon:"success"})}catch(a){t("error","at pages/domain/purchase.vue:228","éªŒè¯ä¼˜æƒ ç å¤±è´¥",a)}var e;this.couponLoading=!1}}else uni.showToast({title:"è¯·è¾“å…¥ä¼˜æƒ ç ",icon:"none"})},cancelCoupon(){this.couponCode="",this.couponApplied=!1,this.couponInfo=null},async handlePurchase(){if(!h())return void uni.navigateTo({url:"/pages/login/login"});if(!this.subdomainName)return void uni.showToast({title:"è¯·è¾“å…¥äºŒçº§åŸŸå",icon:"none"});const e=this.subdomainName.length;var t;if(e<this.selectedPlan.min_length||e>this.selectedPlan.max_length)uni.showToast({title:`åŸŸåé•¿åº¦éœ€${this.selectedPlan.min_length}-${this.selectedPlan.max_length}å­—ç¬¦`,icon:"none"});else try{uni.showLoading({title:"è´­ä¹°ä¸­..."});const e={domain_id:this.selectedDomain.id,plan_id:this.selectedPlan.id,name:this.subdomainName};this.couponApplied&&this.couponCode&&(e.coupon_code=this.couponCode.trim()),await(t=e,l({url:"/purchase",method:"POST",data:t})),uni.hideLoading(),uni.showToast({title:"è´­ä¹°æˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/domain/list"})}),1500)}catch(a){uni.hideLoading()}}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"page-title"},"æ³¨å†ŒåŸŸå"),e.createElementVNode("text",{class:"page-subtitle"},"é€‰æ‹©å¿ƒä»ªçš„åŸŸååç¼€å¼€å§‹æ³¨å†Œ")]),e.createElementVNode("view",{class:"steps-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:!0,done:l.selectedDomain}])},[e.createElementVNode("view",{class:"step-dot"},"1"),e.createElementVNode("text",{class:"step-label"},"é€‰æ‹©åŸŸå")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:l.selectedDomain}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:l.selectedDomain,done:l.selectedPlan}])},[e.createElementVNode("view",{class:"step-dot"},"2"),e.createElementVNode("text",{class:"step-label"},"é€‰æ‹©å¥—é¤")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:l.selectedPlan}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:l.selectedPlan}])},[e.createElementVNode("view",{class:"step-dot"},"3"),e.createElementVNode("text",{class:"step-label"},"å¡«å†™ä¿¡æ¯")],2)]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"é€‰æ‹©åŸŸååç¼€"),e.createElementVNode("text",{class:"section-count"},e.toDisplayString(l.domains.length)+" ä¸ªå¯é€‰",1)]),e.createElementVNode("view",{class:"domain-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.domains,(t=>{var a,o;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["domain-card",{active:(null==(a=l.selectedDomain)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>n.selectDomain(t)},[(null==(o=l.selectedDomain)?void 0:o.id)===t.id?(e.openBlock(),e.createElementBlock("view",{key:0,class:"domain-check"},"âœ“")):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(t.name.split(".").pop()),1),e.createElementVNode("text",{class:"domain-full"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"domain-count"},e.toDisplayString(t.subdomains_count)+" å·²æ³¨å†Œ",1)],10,["onClick"])})),128))])]),l.selectedDomain?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"é€‰æ‹©å¥—é¤æ–¹æ¡ˆ")]),e.createElementVNode("view",{class:"plan-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.plans,(t=>{var a,o;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["plan-card",{active:(null==(a=l.selectedPlan)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>n.selectPlan(t)},[e.createElementVNode("view",{class:"plan-radio"},[(null==(o=l.selectedPlan)?void 0:o.id)===t.id?(e.openBlock(),e.createElementBlock("view",{key:0,class:"radio-inner"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"plan-content"},[e.createElementVNode("view",{class:"plan-top"},[e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"plan-price"},e.toDisplayString(t.price>0?"Â¥"+t.price:"å…è´¹"),1)]),e.createElementVNode("view",{class:"plan-tags"},[e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.duration_text),1),e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.min_length)+"-"+e.toDisplayString(t.max_length)+"å­—ç¬¦",1),e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.max_records_text)+"è®°å½•",1)])])],10,["onClick"])})),128))])])):e.createCommentVNode("",!0),l.selectedPlan?(e.openBlock(),e.createElementBlock("view",{key:1,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"è®¾ç½®æ‚¨çš„åŸŸå")]),e.createElementVNode("view",{class:"domain-input-card"},[e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{class:"subdomain-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.subdomainName=e),placeholder:`è¾“å…¥${l.selectedPlan.min_length}-${l.selectedPlan.max_length}ä¸ªå­—ç¬¦`},null,8,["placeholder"]),[[e.vModelText,l.subdomainName]]),e.createElementVNode("view",{class:"domain-suffix-box"},[e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(l.selectedDomain.name),1)])]),l.subdomainName?(e.openBlock(),e.createElementBlock("view",{key:0,class:"preview-row"},[e.createElementVNode("text",{class:"preview-label"},"é¢„è§ˆï¼š"),e.createElementVNode("text",{class:"preview-domain"},e.toDisplayString(l.subdomainName)+"."+e.toDisplayString(l.selectedDomain.name),1)])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0),l.selectedPlan&&l.selectedPlan.price>0?(e.openBlock(),e.createElementBlock("view",{key:2,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ä¼˜æƒ ç "),e.createElementVNode("text",{class:"section-optional"},"é€‰å¡«")]),e.createElementVNode("view",{class:"coupon-input-card"},[e.createElementVNode("view",{class:"coupon-input-row"},[e.withDirectives(e.createElementVNode("input",{class:"coupon-input","onUpdate:modelValue":a[1]||(a[1]=e=>l.couponCode=e),placeholder:"è¾“å…¥ä¼˜æƒ ç ",disabled:l.couponApplied},null,8,["disabled"]),[[e.vModelText,l.couponCode]]),l.couponApplied?(e.openBlock(),e.createElementBlock("view",{key:1,class:"coupon-btn cancel",onClick:a[3]||(a[3]=(...e)=>n.cancelCoupon&&n.cancelCoupon(...e))},[e.createElementVNode("text",null,"å–æ¶ˆ")])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"coupon-btn",onClick:a[2]||(a[2]=(...e)=>n.handleCoupon&&n.handleCoupon(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.couponLoading?"éªŒè¯ä¸­...":"ä½¿ç”¨"),1)]))]),l.couponApplied&&l.couponInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"coupon-result"},[e.createElementVNode("view",{class:"coupon-success"},[e.createElementVNode("text",{class:"coupon-icon"},"ğŸ‰"),e.createElementVNode("text",{class:"coupon-msg"},e.toDisplayString(l.couponInfo.coupon.name),1)]),e.createElementVNode("view",{class:"coupon-discount"},[e.createElementVNode("text",null,"ä¼˜æƒ  -Â¥"+e.toDisplayString(l.couponInfo.discount),1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0),l.selectedPlan?(e.openBlock(),e.createElementBlock("view",{key:3,class:"footer"},[e.createElementVNode("view",{class:"footer-left"},[e.createElementVNode("text",{class:"price-label"},"åº”ä»˜é‡‘é¢"),e.createElementVNode("text",{class:"price-value"},e.toDisplayString(n.finalPrice),1),l.couponApplied&&l.couponInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"price-original"},"åŸä»· Â¥"+e.toDisplayString(l.selectedPlan.price),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"submit-btn",onClick:a[4]||(a[4]=(...e)=>n.handlePurchase&&n.handlePurchase(...e))},[e.createElementVNode("text",{class:"submit-text"},"ç«‹å³æ³¨å†Œ")])])):e.createCommentVNode("",!0)])}]]);const b=o({data:()=>({subdomainId:null,subdomain:{},records:[],renewPlans:[],selectedRenewPlan:null,showAddRecord:!1,showEditRecord:!1,showRenewModal:!1,recordTypes:["A","AAAA","CNAME","TXT","MX"],newRecord:{type:"A",name:"@",content:""},editingRecord:{id:null,type:"",name:"",content:"",ttl:300,proxied:!1}}),onLoad(e){this.subdomainId=e.id,this.loadData()},methods:{async loadData(){var e,a,o,s;try{const t=await(s=this.subdomainId,l({url:`/subdomains/${s}`,method:"GET"}));this.subdomain=(null==(e=t.data)?void 0:e.subdomain)||{}}catch(n){t("error","at pages/domain/detail.vue:220","è·å–åŸŸåä¿¡æ¯å¤±è´¥",n)}try{const e=await function(e){return l({url:`/subdomains/${e}/records`,method:"GET"})}(this.subdomainId);this.records=(null==(a=e.data)?void 0:a.records)||[]}catch(n){t("error","at pages/domain/detail.vue:228","è·å–DNSè®°å½•å¤±è´¥",n),this.records=[]}try{const e=await function(e){return l({url:`/subdomains/${e}/renew-plans`,method:"GET"})}(this.subdomainId);this.renewPlans=(null==(o=e.data)?void 0:o.plans)||[]}catch(n){t("error","at pages/domain/detail.vue:237","è·å–ç»­è´¹å¥—é¤å¤±è´¥",n),this.renewPlans=[]}},formatDate:e=>e?e.split("T")[0]:"-",onTypeChange(e){this.newRecord.type=this.recordTypes[e.detail.value]},async addRecord(){var e,t;if(this.newRecord.content)try{uni.showLoading({title:"æ·»åŠ ä¸­..."}),await(e=this.subdomainId,t=this.newRecord,l({url:`/subdomains/${e}/records`,method:"POST",data:t})),uni.hideLoading(),uni.showToast({title:"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showAddRecord=!1,this.newRecord={type:"A",name:"@",content:""},this.loadData()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},editRecord(e){this.editingRecord={id:e.id,type:e.type,name:e.name,content:e.content,ttl:e.ttl||300,proxied:e.proxied||!1},this.showEditRecord=!0},async saveEditRecord(){var e,t;if(this.editingRecord.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.editingRecord.id,t={content:this.editingRecord.content,ttl:this.editingRecord.ttl,proxied:this.editingRecord.proxied},l({url:`/records/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showEditRecord=!1,this.loadData()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},deleteRecord(e){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡DNSè®°å½•å—ï¼Ÿ",success:async t=>{if(t.confirm)try{await(a=e.id,l({url:`/records/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.loadData()}catch(o){}var a}})},async handleRenew(){if(this.selectedRenewPlan)try{uni.showLoading({title:"ç»­è´¹ä¸­..."}),await d(this.subdomainId,this.selectedRenewPlan.id),uni.hideLoading(),uni.showToast({title:"ç»­è´¹æˆåŠŸ",icon:"success"}),this.showRenewModal=!1,this.loadData()}catch(e){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©ç»­è´¹å¥—é¤",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"åˆ é™¤åæ— æ³•æ¢å¤ï¼Œç¡®å®šè¦åˆ é™¤å—ï¼Ÿ",success:async e=>{if(e.confirm)try{await function(e,t={}){return l({url:`/subdomains/${e}`,method:"DELETE",data:t})}(this.subdomainId),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),setTimeout((()=>uni.navigateBack()),1500)}catch(t){}}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"åŸŸåè¯¦æƒ…")]),e.createElementVNode("view",{class:"info-card"},[e.createElementVNode("view",{class:"domain-header"},[e.createElementVNode("text",{class:"domain-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(l.subdomain.full_name),1)]),e.createElementVNode("view",{class:"status-row"},[e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{expired:l.subdomain.is_expired}])},e.toDisplayString(l.subdomain.is_expired?"å·²è¿‡æœŸ":"æ­£å¸¸è¿è¡Œ"),3),e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(null==(i=l.subdomain.plan)?void 0:i.name),1)]),e.createElementVNode("view",{class:"info-grid"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"åˆ°æœŸæ—¶é—´"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.formatDate(l.subdomain.expires_at)),1)]),l.subdomain.is_expired?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"å‰©ä½™å¤©æ•°"),e.createElementVNode("text",{class:"info-value highlight"},e.toDisplayString(l.subdomain.days_remaining)+" å¤©",1)]))]),e.createElementVNode("view",{class:"action-btns"},[e.createElementVNode("view",{class:"action-btn primary",onClick:a[0]||(a[0]=e=>l.showRenewModal=!0)},[e.createElementVNode("text",{class:"action-text"},"ç»­è´¹")]),e.createElementVNode("view",{class:"action-btn danger",onClick:a[1]||(a[1]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",{class:"action-text"},"åˆ é™¤åŸŸå")])])]),e.createElementVNode("view",{class:"records-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"DNSè®°å½•"),e.createElementVNode("view",{class:"section-badge"},e.toDisplayString(l.records.length),1),e.createElementVNode("view",{class:"section-action",onClick:a[2]||(a[2]=e=>l.showAddRecord=!0)},[e.createElementVNode("text",{class:"action-icon"},"+"),e.createElementVNode("text",{class:"action-label"},"æ·»åŠ ")])]),e.createElementVNode("view",{class:"record-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id},[e.createElementVNode("view",{class:"record-main"},[e.createElementVNode("view",{class:"record-row"},[e.createElementVNode("view",{class:e.normalizeClass(["type-badge",t.type.toLowerCase()])},e.toDisplayString(t.type),3),e.createElementVNode("text",{class:"record-name"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"content-box"},[e.createElementVNode("text",{class:"record-content"},e.toDisplayString(t.content),1)])]),e.createElementVNode("view",{class:"record-actions"},[e.createElementVNode("text",{class:"record-btn edit",onClick:e=>n.editRecord(t)},"ç¼–è¾‘",8,["onClick"]),e.createElementVNode("text",{class:"record-btn delete",onClick:e=>n.deleteRecord(t)},"åˆ é™¤",8,["onClick"])])])))),128)),0===l.records.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¡"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— DNSè®°å½•"),e.createElementVNode("text",{class:"empty-hint"},'ç‚¹å‡»ä¸Šæ–¹"æ·»åŠ "æŒ‰é’®åˆ›å»ºè®°å½•')])):e.createCommentVNode("",!0)])]),l.showAddRecord?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>l.showAddRecord=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"æ·»åŠ DNSè®°å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("picker",{range:l.recordTypes,onChange:a[3]||(a[3]=(...e)=>n.onTypeChange&&n.onTypeChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(l.newRecord.type||"è¯·é€‰æ‹©"),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[4]||(a[4]=e=>l.newRecord.name=e),placeholder:"@è¡¨ç¤ºæ ¹åŸŸå"},null,512),[[e.vModelText,l.newRecord.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[5]||(a[5]=e=>l.newRecord.content=e),placeholder:"è¯·è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,l.newRecord.content]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[6]||(a[6]=e=>l.showAddRecord=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>n.addRecord&&n.addRecord(...e))},[e.createElementVNode("text",null,"ç¡®å®š")])])])])):e.createCommentVNode("",!0),l.showRenewModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[11]||(a[11]=e.withModifiers((e=>l.showRenewModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç»­è´¹"),e.createElementVNode("view",{class:"plan-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.renewPlans,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["plan-opt",{active:(null==(a=l.selectedRenewPlan)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>l.selectedRenewPlan=t},[e.createElementVNode("text",{class:"plan-opt-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"plan-opt-price"},"Â¥"+e.toDisplayString(t.price),1),e.createElementVNode("text",{class:"plan-opt-duration"},e.toDisplayString(t.duration_text),1)],10,["onClick"])})),128))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[9]||(a[9]=e=>l.showRenewModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>n.handleRenew&&n.handleRenew(...e))},[e.createElementVNode("text",null,"ç¡®å®šç»­è´¹")])])])])):e.createCommentVNode("",!0),l.showEditRecord?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[16]||(a[16]=e.withModifiers((e=>l.showEditRecord=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘DNSè®°å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("view",{class:"picker disabled"},e.toDisplayString(l.editingRecord.type),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.createElementVNode("view",{class:"picker disabled"},e.toDisplayString(l.editingRecord.name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[12]||(a[12]=e=>l.editingRecord.content=e),placeholder:"è¯·è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,l.editingRecord.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"TTL (ç§’)"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[13]||(a[13]=e=>l.editingRecord.ttl=e),placeholder:"300"},null,512),[[e.vModelText,l.editingRecord.ttl]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=e=>l.showEditRecord=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[15]||(a[15]=(...e)=>n.saveEditRecord&&n.saveEditRecord(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const _=function(e){return l({url:"/redeem",method:"POST",data:e})};const C=o({data:()=>({userInfo:null,redeemCode:"",codeValue:"",codeVerified:!1}),onShow(){this.loadUserInfo()},methods:{async loadUserInfo(){try{const e=await V();this.userInfo=e.data,u(e.data)}catch(e){t("error","at pages/recharge/recharge.vue:102","è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",e)}},async verifyCode(){var e,t;if(this.redeemCode)try{uni.showLoading({title:"éªŒè¯ä¸­..."});const a=await(t={code:this.redeemCode},l({url:"/redeem/verify",method:"POST",data:t}));uni.hideLoading(),this.codeValue=(null==(e=a.data)?void 0:e.value_text)||"",this.codeVerified=!0,uni.showToast({title:"å¡å¯†æœ‰æ•ˆ",icon:"success"})}catch(a){uni.hideLoading(),this.codeVerified=!1,this.codeValue=""}else uni.showToast({title:"è¯·è¾“å…¥å¡å¯†",icon:"none"})},async handleRedeem(){var e,t;if(this.codeVerified)try{uni.showLoading({title:"å……å€¼ä¸­..."});const a=await _({code:this.redeemCode});uni.hideLoading(),uni.showToast({title:"å……å€¼æˆåŠŸ",icon:"success"}),this.userInfo.balance=null==(e=a.data)?void 0:e.balance,this.userInfo.balance_text=null==(t=a.data)?void 0:t.balance_text,u(this.userInfo),this.redeemCode="",this.codeValue="",this.codeVerified=!1}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å…ˆéªŒè¯å¡å¯†",icon:"none"})}}},[["render",function(t,a,o,s,l,n){var i,c;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"balance-section"},[e.createElementVNode("view",{class:"balance-bg"}),e.createElementVNode("view",{class:"balance-content"},[e.createElementVNode("text",{class:"balance-label"},"è´¦æˆ·ä½™é¢"),e.createElementVNode("view",{class:"balance-row"},[e.createElementVNode("text",{class:"balance-symbol"},"Â¥"),e.createElementVNode("text",{class:"balance-value"},e.toDisplayString((null==(c=null==(i=l.userInfo)?void 0:i.balance)?void 0:c.toFixed(2))||"0.00"),1)]),e.createElementVNode("text",{class:"balance-tip"},"ä½™é¢å¯ç”¨äºè´­ä¹°å’Œç»­è´¹åŸŸå")])]),e.createElementVNode("view",{class:"recharge-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-icon"},"ğŸ’³"),e.createElementVNode("text",{class:"card-title"},"å¡å¯†å……å€¼")]),e.createElementVNode("view",{class:"input-section"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”‘"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[0]||(a[0]=e=>l.redeemCode=e),placeholder:"è¯·è¾“å…¥å……å€¼å¡å¯†"},null,512),[[e.vModelText,l.redeemCode]])]),e.createElementVNode("view",{class:"verify-btn",onClick:a[1]||(a[1]=(...e)=>n.verifyCode&&n.verifyCode(...e))},[e.createElementVNode("text",{class:"verify-text"},"éªŒè¯")])]),l.codeValue?(e.openBlock(),e.createElementBlock("view",{key:0,class:"code-result"},[e.createElementVNode("view",{class:"result-icon"},"âœ“"),e.createElementVNode("view",{class:"result-info"},[e.createElementVNode("text",{class:"result-label"},"å¡å¯†é‡‘é¢"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(l.codeValue),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["submit-btn",{disabled:!l.codeVerified}]),onClick:a[2]||(a[2]=(...e)=>n.handleRedeem&&n.handleRedeem(...e))},[e.createElementVNode("text",{class:"submit-text"},e.toDisplayString(l.codeVerified?"ç¡®è®¤å……å€¼":"è¯·å…ˆéªŒè¯å¡å¯†"),1)],2)]),e.createElementVNode("view",{class:"tips-card"},[e.createElementVNode("view",{class:"tips-header"},[e.createElementVNode("text",{class:"tips-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"tips-title"},"å……å€¼è¯´æ˜")]),e.createElementVNode("view",{class:"tips-list"},[e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"1"),e.createElementVNode("text",{class:"tip-text"},"è¯·è¾“å…¥æ­£ç¡®çš„å¡å¯†è¿›è¡Œå……å€¼")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"2"),e.createElementVNode("text",{class:"tip-text"},"æ¯å¼ å¡å¯†åªèƒ½ä½¿ç”¨ä¸€æ¬¡")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"3"),e.createElementVNode("text",{class:"tip-text"},"å……å€¼æˆåŠŸåä½™é¢ç«‹å³åˆ°è´¦")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"4"),e.createElementVNode("text",{class:"tip-text"},"å¦‚æœ‰é—®é¢˜è¯·è”ç³»å®¢æœå¤„ç†")])])])])}]]);const D=o({data:()=>({records:[],page:1,perPage:20,total:0,loading:!1,refreshing:!1,hasMore:!0}),onLoad(){this.loadData()},methods:{async onRefresh(){this.refreshing=!0,this.page=1,this.records=[],this.hasMore=!0,await this.loadData(),this.refreshing=!1},async loadData(){var e,a;this.loading=!0;try{const t=await function(e={}){return l({url:"/purchase-records",method:"GET",data:e})}(this.page,this.perPage),o=(null==(e=t.data)?void 0:e.records)||[];this.records=[...this.records,...o];const s=(null==(a=t.data)?void 0:a.pagination)||{};this.total=s.total||0,this.hasMore=this.page<(s.pages||1)}catch(o){t("error","at pages/record/record.vue:91","åŠ è½½è®°å½•å¤±è´¥",o)}finally{this.loading=!1}},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.total)+" æ¡",1)]),e.createElementVNode("scroll-view",{class:"record-list","scroll-y":"","refresher-enabled":"","refresher-triggered":l.refreshing,onRefresherrefresh:a[0]||(a[0]=(...e)=>n.onRefresh&&n.onRefresh(...e)),onScrolltolower:a[1]||(a[1]=(...e)=>n.loadMore&&n.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["record-icon","renew"===t.type?"renew":"buy"])},e.toDisplayString("renew"===t.type?"ç»­":"è´­"),3)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"record-domain"},e.toDisplayString(t.subdomain_name),1),e.createElementVNode("view",{class:"record-tags"},[e.createElementVNode("text",{class:"tag plan"},e.toDisplayString(t.plan_name),1),e.createElementVNode("text",{class:e.normalizeClass(["tag type",t.type])},e.toDisplayString("renew"===t.type?"ç»­è´¹":"è´­ä¹°"),3)])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("text",{class:"record-price"},e.toDisplayString(t.price_text),1),e.createElementVNode("text",{class:"record-time"},e.toDisplayString(n.formatDate(t.created_at)),1)])])))),128)),0!==l.records.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— äº¤æ˜“è®°å½•")])),l.hasMore&&!l.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"load-more"},[e.createElementVNode("text",{class:"load-more-text"},"ä¸Šæ‹‰åŠ è½½æ›´å¤š")])):e.createCommentVNode("",!0),l.loading?(e.openBlock(),e.createElementBlock("view",{key:2,class:"load-more"},[e.createElementVNode("text",{class:"load-more-text"},"åŠ è½½ä¸­...")])):e.createCommentVNode("",!0),!l.hasMore&&l.records.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"no-more"},[e.createElementVNode("text",{class:"no-more-text"},"â€” å·²åŠ è½½å…¨éƒ¨ â€”")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bottom-space"})],40,["refresher-triggered"])])}]]);const S=o({data:()=>({announcements:[],loading:!0,showModal:!1,currentAnnouncement:{}}),onLoad(){this.loadData()},methods:{async loadData(){var e;this.loading=!0;try{const t=await n();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[]}catch(a){t("error","at pages/announcement/list.vue:82","åŠ è½½å…¬å‘Šå¤±è´¥",a)}finally{this.loading=!1}},async showDetail(e){if(this.currentAnnouncement=e,this.showModal=!0,h()&&!e.is_read)try{await i(e.id),e.is_read=!0}catch(t){}},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ç³»ç»Ÿå…¬å‘Š"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.announcements.length)+" æ¡",1)]),e.createElementVNode("view",{class:"announcement-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.announcements,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["announcement-card",{unread:!t.is_read}]),key:t.id,onClick:e=>n.showDetail(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"title-row"},[t.is_read?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"unread-dot"})),e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1)]),t.is_important?(e.openBlock(),e.createElementBlock("view",{key:0,class:"important-tag"},"ğŸ”¥ é‡è¦")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"card-content"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(n.formatDate(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],10,["onClick"])))),128)),0!==l.announcements.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¢"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å…¬å‘Š")]))]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[1]||(a[1]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.currentAnnouncement.title),1),l.currentAnnouncement.is_important?(e.openBlock(),e.createElementBlock("text",{key:0,class:"important-tag"},"é‡è¦")):e.createCommentVNode("",!0)]),e.createElementVNode("scroll-view",{class:"modal-body","scroll-y":""},[e.createElementVNode("text",{class:"modal-text"},e.toDisplayString(l.currentAnnouncement.content),1)]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("text",{class:"modal-time"},e.toDisplayString(n.formatDate(l.currentAnnouncement.created_at)),1),e.createElementVNode("view",{class:"modal-close",onClick:a[0]||(a[0]=e=>l.showModal=!1)},[e.createElementVNode("text",{class:"close-text"},"å…³é—­")])])])])):e.createCommentVNode("",!0)])}]]);const T=o({data:()=>({isLoggedIn:!1,cacheSize:"0KB",showPasswordModal:!1,showEmailModal:!1,passwordForm:{captcha:"",captcha_id:""},emailForm:{captcha:"",captcha_id:""},passwordCaptchaUrl:"",emailCaptchaUrl:""}),onShow(){this.isLoggedIn=h(),this.getCacheSize()},methods:{goToSecurity(){uni.navigateTo({url:"/pages/settings/security"})},getCacheSize(){try{const e=uni.getStorageInfoSync().currentSize||0;this.cacheSize=e<1024?e+"KB":(e/1024).toFixed(2)+"MB"}catch(e){this.cacheSize="0KB"}},async refreshPasswordCaptcha(){var e,a;try{const t=await v(this.passwordForm.captcha_id);this.passwordForm.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.passwordCaptchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(o){t("error","at pages/settings/settings.vue:160","è·å–éªŒè¯ç å¤±è´¥",o)}},async refreshEmailCaptcha(){var e,a;try{const t=await v(this.emailForm.captcha_id);this.emailForm.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.emailCaptchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(o){t("error","at pages/settings/settings.vue:169","è·å–éªŒè¯ç å¤±è´¥",o)}},changePassword(){this.showPasswordModal=!0,this.passwordForm.captcha="",this.refreshPasswordCaptcha()},async sendPasswordEmail(){var e;if(this.passwordForm.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={captcha_id:this.passwordForm.captcha_id,captcha_code:this.passwordForm.captcha},l({url:"/auth/change-password/send",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"éªŒè¯é‚®ä»¶å·²å‘é€",icon:"success"}),this.showPasswordModal=!1}catch(t){uni.hideLoading(),this.passwordForm.captcha="",this.refreshPasswordCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"})},changeEmail(){this.showEmailModal=!0,this.emailForm.captcha="",this.refreshEmailCaptcha()},async sendEmailCode(){var e;if(this.emailForm.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={captcha_id:this.emailForm.captcha_id,captcha_code:this.emailForm.captcha},l({url:"/auth/change-email/send",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"éªŒè¯é‚®ä»¶å·²å‘é€",icon:"success"}),this.showEmailModal=!1}catch(t){uni.hideLoading(),this.emailForm.captcha="",this.refreshEmailCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"})},clearCache(){uni.showModal({title:"æç¤º",content:"ç¡®å®šè¦æ¸…é™¤ç¼“å­˜å—ï¼Ÿ",success:e=>{if(e.confirm)try{uni.clearStorageSync(),this.cacheSize="0KB",uni.showToast({title:"æ¸…é™¤æˆåŠŸ",icon:"success"})}catch(t){uni.showToast({title:"æ¸…é™¤å¤±è´¥",icon:"none"})}}})},showAbout(){uni.showModal({title:"å…³äºæˆ‘ä»¬",content:"åŸŸåç®¡ç†ç³»ç»Ÿ v1.0.0\næä¾›ä¾¿æ·çš„äºŒçº§åŸŸåç®¡ç†æœåŠ¡",showCancel:!1})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"è®¾ç½®")]),l.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"è´¦æˆ·è®¾ç½®"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[0]||(a[0]=(...e)=>n.goToSecurity&&n.goToSecurity(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ›¡ï¸"),e.createElementVNode("text",{class:"menu-text"},"å®‰å…¨è®¾ç½®"),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:a[1]||(a[1]=(...e)=>n.changePassword&&n.changePassword(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ”"),e.createElementVNode("text",{class:"menu-text"},"ä¿®æ”¹å¯†ç "),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:a[2]||(a[2]=(...e)=>n.changeEmail&&n.changeEmail(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ“§"),e.createElementVNode("text",{class:"menu-text"},"ä¿®æ”¹é‚®ç®±"),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"é€šç”¨"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=(...e)=>n.clearCache&&n.clearCache(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ—‘ï¸"),e.createElementVNode("text",{class:"menu-text"},"æ¸…é™¤ç¼“å­˜"),e.createElementVNode("text",{class:"menu-value"},e.toDisplayString(l.cacheSize),1),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item"},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ“±"),e.createElementVNode("text",{class:"menu-text"},"å½“å‰ç‰ˆæœ¬"),e.createElementVNode("text",{class:"menu-value"},"v1.0.0")])])]),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"å…¶ä»–"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[4]||(a[4]=(...e)=>n.showAbout&&n.showAbout(...e))},[e.createElementVNode("view",{class:"menu-icon"},"â„¹ï¸"),e.createElementVNode("text",{class:"menu-text"},"å…³äºæˆ‘ä»¬"),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])])]),l.showPasswordModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[9]||(a[9]=e.withModifiers((e=>l.showPasswordModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä¿®æ”¹å¯†ç "),e.createElementVNode("text",{class:"modal-tip"},"è¯·è¾“å…¥éªŒè¯ç åå‘é€éªŒè¯é‚®ä»¶"),e.createElementVNode("view",{class:"modal-captcha"},[e.createElementVNode("view",{class:"captcha-row"},[e.withDirectives(e.createElementVNode("input",{class:"captcha-input",type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>l.passwordForm.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,l.passwordForm.captcha]]),e.createElementVNode("image",{class:"captcha-img",src:l.passwordCaptchaUrl,onClick:a[6]||(a[6]=(...e)=>n.refreshPasswordCaptcha&&n.refreshPasswordCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[7]||(a[7]=e=>l.showPasswordModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[8]||(a[8]=(...e)=>n.sendPasswordEmail&&n.sendPasswordEmail(...e))},[e.createElementVNode("text",null,"å‘é€éªŒè¯é‚®ä»¶")])])])])):e.createCommentVNode("",!0),l.showEmailModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[14]||(a[14]=e.withModifiers((e=>l.showEmailModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä¿®æ”¹é‚®ç®±"),e.createElementVNode("text",{class:"modal-tip"},"è¯·è¾“å…¥éªŒè¯ç åå‘é€éªŒè¯é‚®ä»¶"),e.createElementVNode("view",{class:"modal-captcha"},[e.createElementVNode("view",{class:"captcha-row"},[e.withDirectives(e.createElementVNode("input",{class:"captcha-input",type:"number","onUpdate:modelValue":a[10]||(a[10]=e=>l.emailForm.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,l.emailForm.captcha]]),e.createElementVNode("image",{class:"captcha-img",src:l.emailCaptchaUrl,onClick:a[11]||(a[11]=(...e)=>n.refreshEmailCaptcha&&n.refreshEmailCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[12]||(a[12]=e=>l.showEmailModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[13]||(a[13]=(...e)=>n.sendEmailCode&&n.sendEmailCode(...e))},[e.createElementVNode("text",null,"å‘é€éªŒè¯é‚®ä»¶")])])])])):e.createCommentVNode("",!0)])}]]);function B(e={}){return l({url:"/security/api-keys/generate",method:"POST",data:e})}const M=o({data:()=>({twoFAEnabled:!1,showSetup2FAModal:!1,showDisable2FAModal:!1,showBackupCodesModal:!1,qrCodeUrl:"",twoFASecret:"",verifyCode:"",disableForm:{password:"",code:""},backupCodes:[],backupCodeVerify:"",apiKey:"",apiSecretDisplay:"******",apiEnabled:!1,apiIpWhitelist:[],newIp:"",showViewSecretModal:!1,showResetApiModal:!1,showNewKeyModal:!1,viewSecretPassword:"",viewedSecret:"",resetApiPassword:"",newApiKey:"",newApiSecret:"",allowedIps:[],newAllowedIp:"",loginHistory:[]}),onLoad(){this.loadData()},methods:{async loadData(){uni.showLoading({title:"åŠ è½½ä¸­..."});try{await Promise.all([this.load2FAStatus(),this.loadApiKeys(),this.loadIpRestriction(),this.loadLoginHistory()])}catch(e){t("error","at pages/settings/security.vue:350","åŠ è½½æ•°æ®å¤±è´¥",e)}uni.hideLoading()},async load2FAStatus(){var e;try{const t=await l({url:"/security/2fa/status",method:"GET"});this.twoFAEnabled=(null==(e=t.data)?void 0:e.enabled)||!1}catch(a){t("error","at pages/settings/security.vue:360","è·å–2FAçŠ¶æ€å¤±è´¥",a)}},async loadApiKeys(){var e,a,o;try{const t=await l({url:"/security/api-keys",method:"GET"});this.apiKey=(null==(e=t.data)?void 0:e.api_key)||"",this.apiEnabled=(null==(a=t.data)?void 0:a.api_enabled)||!1,this.apiIpWhitelist=(null==(o=t.data)?void 0:o.api_ip_whitelist)||[]}catch(s){t("error","at pages/settings/security.vue:371","è·å–APIå¯†é’¥å¤±è´¥",s)}},async loadIpRestriction(){var e;try{const t=await l({url:"/security/ip-restriction",method:"GET"});this.allowedIps=(null==(e=t.data)?void 0:e.allowed_ips)||[]}catch(a){t("error","at pages/settings/security.vue:380","è·å–IPé™åˆ¶å¤±è´¥",a)}},async loadLoginHistory(){var e;try{const t=await l({url:"/security/sessions",method:"GET"});this.loginHistory=(null==(e=t.data)?void 0:e.sessions)||t.data||[]}catch(a){t("error","at pages/settings/security.vue:389","è·å–ç™»å½•å†å²å¤±è´¥",a)}},async setup2FA(){var e,t;try{uni.showLoading({title:"ç”Ÿæˆä¸­..."});const a=await l({url:"/security/2fa/setup",method:"POST"});uni.hideLoading(),this.qrCodeUrl=(null==(e=a.data)?void 0:e.qr_code)||"",this.twoFASecret=(null==(t=a.data)?void 0:t.secret)||"",this.verifyCode="",this.showSetup2FAModal=!0}catch(a){uni.hideLoading()}},async enable2FA(){var e,t;if(this.verifyCode&&6===this.verifyCode.length)try{uni.showLoading({title:"éªŒè¯ä¸­..."});const a=await(t={code:this.verifyCode},l({url:"/security/2fa/enable",method:"POST",data:t}));uni.hideLoading(),this.showSetup2FAModal=!1,this.twoFAEnabled=!0,(null==(e=a.data)?void 0:e.backup_codes)&&(this.backupCodes=a.data.backup_codes,this.showBackupCodesModal=!0),uni.showToast({title:"2FA å·²å¯ç”¨",icon:"success"})}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥6ä½éªŒè¯ç ",icon:"none"})},async disable2FA(){var e;if(this.disableForm.password&&this.disableForm.code)try{uni.showLoading({title:"å¤„ç†ä¸­..."}),await(e=this.disableForm,l({url:"/security/2fa/disable",method:"POST",data:e})),uni.hideLoading(),this.showDisable2FAModal=!1,this.twoFAEnabled=!1,this.disableForm={password:"",code:""},uni.showToast({title:"2FA å·²ç¦ç”¨",icon:"success"})}catch(t){uni.hideLoading()}else uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"})},async regenerateBackupCodes(){var e,t;if(this.backupCodeVerify&&6===this.backupCodeVerify.length)try{uni.showLoading({title:"ç”Ÿæˆä¸­..."});const a=await(t={code:this.backupCodeVerify},l({url:"/security/2fa/backup-codes",method:"POST",data:t}));uni.hideLoading(),this.backupCodes=(null==(e=a.data)?void 0:e.backup_codes)||[],this.backupCodeVerify=""}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥6ä½éªŒè¯ç ",icon:"none"})},async generateApiKey(){var e,t;try{uni.showLoading({title:"ç”Ÿæˆä¸­..."});const a=await B();uni.hideLoading(),this.newApiKey=(null==(e=a.data)?void 0:e.api_key)||"",this.newApiSecret=(null==(t=a.data)?void 0:t.api_secret)||"",this.showNewKeyModal=!0,this.loadApiKeys()}catch(a){uni.hideLoading()}},async toggleApi(){try{uni.showLoading({title:"å¤„ç†ä¸­..."}),await function(e={}){return l({url:"/security/api-keys/toggle",method:"POST",data:e})}({enabled:!this.apiEnabled}),uni.hideLoading(),this.apiEnabled=!this.apiEnabled,uni.showToast({title:this.apiEnabled?"API å·²å¯ç”¨":"API å·²ç¦ç”¨",icon:"success"})}catch(e){uni.hideLoading()}},async viewSecret(){var e,t;if(this.viewSecretPassword)try{uni.showLoading({title:"éªŒè¯ä¸­..."});const a=await(t={password:this.viewSecretPassword},l({url:"/security/api-keys/secret",method:"POST",data:t}));uni.hideLoading(),this.viewedSecret=(null==(e=a.data)?void 0:e.api_secret)||""}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥å¯†ç ",icon:"none"})},closeViewSecret(){this.showViewSecretModal=!1,this.viewSecretPassword="",this.viewedSecret=""},async resetApiKey(){var e,t;if(this.resetApiPassword)try{uni.showLoading({title:"é‡ç½®ä¸­..."});const a=await B({password:this.resetApiPassword});uni.hideLoading(),this.showResetApiModal=!1,this.resetApiPassword="",this.newApiKey=(null==(e=a.data)?void 0:e.api_key)||"",this.newApiSecret=(null==(t=a.data)?void 0:t.api_secret)||"",this.showNewKeyModal=!0,this.loadApiKeys()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥å¯†ç ",icon:"none"})},closeNewKeyModal(){this.showNewKeyModal=!1,this.newApiKey="",this.newApiSecret=""},addIp(){this.newIp?this.apiIpWhitelist.includes(this.newIp)?uni.showToast({title:"IP å·²å­˜åœ¨",icon:"none"}):(this.apiIpWhitelist.push(this.newIp),this.newIp="",this.saveApiWhitelist()):uni.showToast({title:"è¯·è¾“å…¥ IP åœ°å€",icon:"none"})},removeIp(e){this.apiIpWhitelist.splice(e,1),this.saveApiWhitelist()},async saveApiWhitelist(){try{await(e={ip_whitelist:this.apiIpWhitelist},l({url:"/security/api-keys/whitelist",method:"PUT",data:e})),uni.showToast({title:"å·²ä¿å­˜",icon:"success"})}catch(a){t("error","at pages/settings/security.vue:563","ä¿å­˜å¤±è´¥",a)}var e},addAllowedIp(){this.newAllowedIp?this.allowedIps.includes(this.newAllowedIp)?uni.showToast({title:"IP å·²å­˜åœ¨",icon:"none"}):(this.allowedIps.push(this.newAllowedIp),this.newAllowedIp="",this.saveIpRestriction()):uni.showToast({title:"è¯·è¾“å…¥ IP åœ°å€",icon:"none"})},removeAllowedIp(e){this.allowedIps.splice(e,1),this.saveIpRestriction()},async saveIpRestriction(){try{await(e={allowed_ips:this.allowedIps},l({url:"/security/ip-restriction",method:"PUT",data:e})),uni.showToast({title:"å·²ä¿å­˜",icon:"success"})}catch(a){t("error","at pages/settings/security.vue:592","ä¿å­˜å¤±è´¥",a)}var e}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å®‰å…¨è®¾ç½®"),e.createElementVNode("text",{class:"header-subtitle"},"ç®¡ç†æ‚¨çš„è´¦æˆ·å®‰å…¨é€‰é¡¹")]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ” åŒå› ç´ è®¤è¯ (2FA)"),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",l.twoFAEnabled?"enabled":"disabled"])},[e.createElementVNode("text",null,e.toDisplayString(l.twoFAEnabled?"å·²å¯ç”¨":"æœªå¯ç”¨"),1)],2)]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("text",{class:"section-desc"},"å¯ç”¨åŒå› ç´ è®¤è¯åï¼Œç™»å½•æ—¶éœ€è¦è¾“å…¥éªŒè¯å™¨åº”ç”¨ç”Ÿæˆçš„éªŒè¯ç ï¼Œå¤§å¹…æå‡è´¦æˆ·å®‰å…¨æ€§ã€‚"),e.createElementVNode("view",{class:"btn-group"},[l.twoFAEnabled?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-btn danger",onClick:a[1]||(a[1]=e=>l.showDisable2FAModal=!0)},[e.createElementVNode("text",null,"ç¦ç”¨ 2FA")])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-btn primary",onClick:a[0]||(a[0]=(...e)=>n.setup2FA&&n.setup2FA(...e))},[e.createElementVNode("text",null,"å¯ç”¨ 2FA")])),l.twoFAEnabled?(e.openBlock(),e.createElementBlock("view",{key:2,class:"action-btn secondary",onClick:a[2]||(a[2]=e=>l.showBackupCodesModal=!0)},[e.createElementVNode("text",null,"å¤‡ç”¨ç ")])):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ”‘ API å¯†é’¥"),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",l.apiEnabled?"enabled":"disabled"])},[e.createElementVNode("text",null,e.toDisplayString(l.apiEnabled?"å·²å¯ç”¨":"æœªå¯ç”¨"),1)],2)]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("text",{class:"section-desc"},"API å¯†é’¥ç”¨äºå¤–éƒ¨ç³»ç»Ÿè°ƒç”¨å¼€æ”¾ APIï¼Œè¯·å¦¥å–„ä¿ç®¡æ‚¨çš„å¯†é’¥ã€‚"),l.apiKey?(e.openBlock(),e.createElementBlock("view",{key:0,class:"api-info"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"API Key"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(l.apiKey),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"API Secret"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(l.apiSecretDisplay),1),e.createElementVNode("view",{class:"view-btn",onClick:a[3]||(a[3]=e=>l.showViewSecretModal=!0)},[e.createElementVNode("text",null,"æŸ¥çœ‹")])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"btn-group"},[l.apiKey?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("view",{class:e.normalizeClass(["action-btn",l.apiEnabled?"warning":"success"]),onClick:a[5]||(a[5]=(...e)=>n.toggleApi&&n.toggleApi(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.apiEnabled?"ç¦ç”¨ API":"å¯ç”¨ API"),1)],2),e.createElementVNode("view",{class:"action-btn danger",onClick:a[6]||(a[6]=e=>l.showResetApiModal=!0)},[e.createElementVNode("text",null,"é‡ç½®å¯†é’¥")])],64)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-btn primary",onClick:a[4]||(a[4]=(...e)=>n.generateApiKey&&n.generateApiKey(...e))},[e.createElementVNode("text",null,"ç”Ÿæˆå¯†é’¥")]))])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸŒ API IP ç™½åå•")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("text",{class:"section-desc"},"é™åˆ¶åªæœ‰æŒ‡å®š IP æ‰èƒ½è°ƒç”¨ APIï¼Œç•™ç©ºåˆ™ä¸é™åˆ¶ã€‚"),l.apiIpWhitelist.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"ip-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.apiIpWhitelist,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"ip-item",key:a},[e.createElementVNode("text",{class:"ip-text"},e.toDisplayString(t),1),e.createElementVNode("text",{class:"ip-remove",onClick:e=>n.removeIp(a)},"Ã—",8,["onClick"])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æœªè®¾ç½® IP ç™½åå•")])),e.createElementVNode("view",{class:"add-ip-row"},[e.withDirectives(e.createElementVNode("input",{class:"ip-input","onUpdate:modelValue":a[7]||(a[7]=e=>l.newIp=e),placeholder:"è¾“å…¥ IP åœ°å€"},null,512),[[e.vModelText,l.newIp]]),e.createElementVNode("view",{class:"add-btn",onClick:a[8]||(a[8]=(...e)=>n.addIp&&n.addIp(...e))},[e.createElementVNode("text",null,"æ·»åŠ ")])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ›¡ï¸ ç™»å½• IP é™åˆ¶")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("text",{class:"section-desc"},"é™åˆ¶åªæœ‰æŒ‡å®š IP æ‰èƒ½ç™»å½•è´¦æˆ·ï¼Œç•™ç©ºåˆ™ä¸é™åˆ¶ã€‚"),l.allowedIps.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"ip-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.allowedIps,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"ip-item",key:a},[e.createElementVNode("text",{class:"ip-text"},e.toDisplayString(t),1),e.createElementVNode("text",{class:"ip-remove",onClick:e=>n.removeAllowedIp(a)},"Ã—",8,["onClick"])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æœªè®¾ç½®ç™»å½• IP é™åˆ¶")])),e.createElementVNode("view",{class:"add-ip-row"},[e.withDirectives(e.createElementVNode("input",{class:"ip-input","onUpdate:modelValue":a[9]||(a[9]=e=>l.newAllowedIp=e),placeholder:"è¾“å…¥ IP åœ°å€"},null,512),[[e.vModelText,l.newAllowedIp]]),e.createElementVNode("view",{class:"add-btn",onClick:a[10]||(a[10]=(...e)=>n.addAllowedIp&&n.addAllowedIp(...e))},[e.createElementVNode("text",null,"æ·»åŠ ")])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“‹ ç™»å½•å†å²"),e.createElementVNode("view",{class:"refresh-btn",onClick:a[11]||(a[11]=(...e)=>n.loadLoginHistory&&n.loadLoginHistory(...e))},[e.createElementVNode("text",null,"åˆ·æ–°")])]),e.createElementVNode("view",{class:"section-content"},[l.loginHistory.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"history-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.loginHistory,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"history-item",key:a},[e.createElementVNode("view",{class:"history-main"},[e.createElementVNode("text",{class:"history-ip"},e.toDisplayString(t.ip),1),e.createElementVNode("text",{class:"history-time"},e.toDisplayString(t.login_time||t.created_at),1)]),e.createElementVNode("view",{class:"history-sub"},[e.createElementVNode("text",{class:"history-ua"},e.toDisplayString(t.user_agent||"æœªçŸ¥è®¾å¤‡"),1)])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æ— ç™»å½•è®°å½•")]))])])]),l.showSetup2FAModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[15]||(a[15]=e.withModifiers((e=>l.showSetup2FAModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content large"},[e.createElementVNode("text",{class:"modal-title"},"å¯ç”¨åŒå› ç´ è®¤è¯"),e.createElementVNode("view",{class:"qr-section"},[e.createElementVNode("text",{class:"qr-tip"},"è¯·ä½¿ç”¨ Google Authenticator æˆ–å…¶ä»–éªŒè¯å™¨åº”ç”¨æ‰«æäºŒç»´ç "),l.qrCodeUrl?(e.openBlock(),e.createElementBlock("image",{key:0,class:"qr-image",src:l.qrCodeUrl,mode:"aspectFit"},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"secret-row"},[e.createElementVNode("text",{class:"secret-label"},"å¯†é’¥ï¼š"),e.createElementVNode("text",{class:"secret-value"},e.toDisplayString(l.twoFASecret),1)])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"è¾“å…¥éªŒè¯ç ç¡®è®¤"),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"number","onUpdate:modelValue":a[12]||(a[12]=e=>l.verifyCode=e),placeholder:"6ä½éªŒè¯ç ",maxlength:"6"},null,512),[[e.vModelText,l.verifyCode]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[13]||(a[13]=e=>l.showSetup2FAModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[14]||(a[14]=(...e)=>n.enable2FA&&n.enable2FA(...e))},[e.createElementVNode("text",null,"ç¡®è®¤å¯ç”¨")])])])])):e.createCommentVNode("",!0),l.showDisable2FAModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[20]||(a[20]=e.withModifiers((e=>l.showDisable2FAModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç¦ç”¨åŒå› ç´ è®¤è¯"),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"è´¦æˆ·å¯†ç "),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"password","onUpdate:modelValue":a[16]||(a[16]=e=>l.disableForm.password=e),placeholder:"è¯·è¾“å…¥å¯†ç "},null,512),[[e.vModelText,l.disableForm.password]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"2FA éªŒè¯ç "),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"number","onUpdate:modelValue":a[17]||(a[17]=e=>l.disableForm.code=e),placeholder:"6ä½éªŒè¯ç ",maxlength:"6"},null,512),[[e.vModelText,l.disableForm.code]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[18]||(a[18]=e=>l.showDisable2FAModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm danger",onClick:a[19]||(a[19]=(...e)=>n.disable2FA&&n.disable2FA(...e))},[e.createElementVNode("text",null,"ç¡®è®¤ç¦ç”¨")])])])])):e.createCommentVNode("",!0),l.showBackupCodesModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[24]||(a[24]=e.withModifiers((e=>l.showBackupCodesModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"å¤‡ç”¨ç ç®¡ç†"),e.createElementVNode("text",{class:"modal-tip"},"å¤‡ç”¨ç å¯åœ¨æ— æ³•ä½¿ç”¨éªŒè¯å™¨æ—¶ç™»å½•è´¦æˆ·ï¼Œæ¯ä¸ªå¤‡ç”¨ç åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚"),l.backupCodes.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"backup-codes"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.backupCodes,((t,a)=>(e.openBlock(),e.createElementBlock("text",{class:"backup-code",key:a},e.toDisplayString(t),1)))),128))])):e.createCommentVNode("",!0),l.backupCodes.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"è¾“å…¥ 2FA éªŒè¯ç é‡æ–°ç”Ÿæˆ"),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"number","onUpdate:modelValue":a[21]||(a[21]=e=>l.backupCodeVerify=e),placeholder:"6ä½éªŒè¯ç ",maxlength:"6"},null,512),[[e.vModelText,l.backupCodeVerify]])])),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[22]||(a[22]=e=>{l.showBackupCodesModal=!1,l.backupCodes=[]})},[e.createElementVNode("text",null,"å…³é—­")]),l.backupCodes.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn confirm",onClick:a[23]||(a[23]=(...e)=>n.regenerateBackupCodes&&n.regenerateBackupCodes(...e))},[e.createElementVNode("text",null,"ç”Ÿæˆå¤‡ç”¨ç ")]))])])])):e.createCommentVNode("",!0),l.showViewSecretModal?(e.openBlock(),e.createElementBlock("view",{key:3,class:"modal",onClick:a[28]||(a[28]=e.withModifiers((e=>l.showViewSecretModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"æŸ¥çœ‹ API Secret"),l.viewedSecret?(e.openBlock(),e.createElementBlock("view",{key:1,class:"secret-display"},[e.createElementVNode("text",{class:"secret-text"},e.toDisplayString(l.viewedSecret),1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"è¯·è¾“å…¥è´¦æˆ·å¯†ç éªŒè¯èº«ä»½"),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"password","onUpdate:modelValue":a[25]||(a[25]=e=>l.viewSecretPassword=e),placeholder:"è¯·è¾“å…¥å¯†ç "},null,512),[[e.vModelText,l.viewSecretPassword]])])),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[26]||(a[26]=(...e)=>n.closeViewSecret&&n.closeViewSecret(...e))},[e.createElementVNode("text",null,"å…³é—­")]),l.viewedSecret?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn confirm",onClick:a[27]||(a[27]=(...e)=>n.viewSecret&&n.viewSecret(...e))},[e.createElementVNode("text",null,"æŸ¥çœ‹")]))])])])):e.createCommentVNode("",!0),l.showResetApiModal?(e.openBlock(),e.createElementBlock("view",{key:4,class:"modal",onClick:a[32]||(a[32]=e.withModifiers((e=>l.showResetApiModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"é‡ç½® API å¯†é’¥"),e.createElementVNode("text",{class:"modal-tip warning"},"âš ï¸ é‡ç½®ååŸå¯†é’¥å°†ç«‹å³å¤±æ•ˆï¼Œè¯·ç¡®ä¿å·²æ›´æ–°æ‰€æœ‰ä½¿ç”¨è¯¥å¯†é’¥çš„åº”ç”¨ã€‚"),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"è¯·è¾“å…¥è´¦æˆ·å¯†ç ç¡®è®¤"),e.withDirectives(e.createElementVNode("input",{class:"modal-input",type:"password","onUpdate:modelValue":a[29]||(a[29]=e=>l.resetApiPassword=e),placeholder:"è¯·è¾“å…¥å¯†ç "},null,512),[[e.vModelText,l.resetApiPassword]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[30]||(a[30]=e=>l.showResetApiModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm danger",onClick:a[31]||(a[31]=(...e)=>n.resetApiKey&&n.resetApiKey(...e))},[e.createElementVNode("text",null,"ç¡®è®¤é‡ç½®")])])])])):e.createCommentVNode("",!0),l.showNewKeyModal?(e.openBlock(),e.createElementBlock("view",{key:5,class:"modal",onClick:a[34]||(a[34]=e.withModifiers(((...e)=>n.closeNewKeyModal&&n.closeNewKeyModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ğŸ‰ API å¯†é’¥å·²ç”Ÿæˆ"),e.createElementVNode("text",{class:"modal-tip warning"},"âš ï¸ è¯·ç«‹å³ä¿å­˜ API Secretï¼Œæ­¤ä¿¡æ¯åªæ˜¾ç¤ºä¸€æ¬¡ï¼"),e.createElementVNode("view",{class:"key-display"},[e.createElementVNode("view",{class:"key-row"},[e.createElementVNode("text",{class:"key-label"},"API Key"),e.createElementVNode("text",{class:"key-value"},e.toDisplayString(l.newApiKey),1)]),e.createElementVNode("view",{class:"key-row"},[e.createElementVNode("text",{class:"key-label"},"API Secret"),e.createElementVNode("text",{class:"key-value secret"},e.toDisplayString(l.newApiSecret),1)])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[33]||(a[33]=(...e)=>n.closeNewKeyModal&&n.closeNewKeyModal(...e))},[e.createElementVNode("text",null,"æˆ‘å·²ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);function P(){return l({url:"/admin/domains",method:"GET"})}function I(e,t){return l({url:`/admin/domains/${e}`,method:"PUT",data:t})}function A(){return l({url:"/admin/channels",method:"GET"})}const L=o({data:()=>({stats:{},userInfo:null}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadStats()},methods:{async loadStats(){try{const e=await l({url:"/admin/stats",method:"GET"});this.stats=e.data||{}}catch(e){}},goTo(e){uni.navigateTo({url:e})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"header-title"},e.toDisplayString(n.isDemo?"æ¼”ç¤ºä¸­å¿ƒ":"ç®¡ç†ä¸­å¿ƒ"),1),e.createElementVNode("text",{class:"header-subtitle"},e.toDisplayString(n.isDemo?"åªè¯»æ¨¡å¼ï¼Œä»…ä¾›æŸ¥çœ‹":"ç³»ç»Ÿæ•°æ®æ¦‚è§ˆä¸ç®¡ç†"),1)]),n.isDemo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"demo-badge"},"æ¼”ç¤º")):e.createCommentVNode("",!0)]),n.isDemo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"demo-notice"},[e.createElementVNode("text",{class:"notice-icon"},"ğŸ‘ï¸"),e.createElementVNode("text",{class:"notice-text"},"æ¼”ç¤ºæ¨¡å¼ï¼šæ‚¨å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ•°æ®ï¼Œä½†æ— æ³•è¿›è¡Œä¿®æ”¹æ“ä½œ")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stats-grid"},[e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon users"},"ğŸ‘¥"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(l.stats.users_count||0),1),e.createElementVNode("text",{class:"stat-label"},"ç”¨æˆ·æ€»æ•°")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon domains"},"ğŸŒ"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(l.stats.domains_count||0),1),e.createElementVNode("text",{class:"stat-label"},"ä¸»åŸŸå")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon subdomains"},"ğŸ”—"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(l.stats.subdomains_count||0),1),e.createElementVNode("text",{class:"stat-label"},"äºŒçº§åŸŸå")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon records"},"ğŸ“"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(l.stats.records_count||0),1),e.createElementVNode("text",{class:"stat-label"},"DNSè®°å½•")])])])]),e.createElementVNode("view",{class:"today-card"},[e.createElementVNode("view",{class:"today-header"},[e.createElementVNode("text",{class:"today-title"},"ğŸ“Š ä»Šæ—¥æ•°æ®")]),e.createElementVNode("view",{class:"today-grid"},[e.createElementVNode("view",{class:"today-item"},[e.createElementVNode("text",{class:"today-value green"},"+"+e.toDisplayString(l.stats.today_new_users||0),1),e.createElementVNode("text",{class:"today-label"},"æ–°å¢ç”¨æˆ·")]),e.createElementVNode("view",{class:"today-divider"}),e.createElementVNode("view",{class:"today-item"},[e.createElementVNode("text",{class:"today-value blue"},"+"+e.toDisplayString(l.stats.today_new_subdomains||0),1),e.createElementVNode("text",{class:"today-label"},"æ–°å¢åŸŸå")])])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"section-title"},"å¿«æ·ç®¡ç†"),e.createElementVNode("view",{class:"menu-card"},[e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[0]||(a[0]=e=>n.goTo("/pages/admin/users"))},[e.createElementVNode("view",{class:"menu-icon-wrap blue"},"ğŸ‘¥"),e.createElementVNode("text",{class:"menu-text"},"ç”¨æˆ·")]),e.createElementVNode("view",{class:"menu-item",onClick:a[1]||(a[1]=e=>n.goTo("/pages/admin/domains"))},[e.createElementVNode("view",{class:"menu-icon-wrap green"},"ğŸŒ"),e.createElementVNode("text",{class:"menu-text"},"åŸŸå")]),e.createElementVNode("view",{class:"menu-item",onClick:a[2]||(a[2]=e=>n.goTo("/pages/admin/cf-accounts"))},[e.createElementVNode("view",{class:"menu-icon-wrap yellow"},"â˜ï¸"),e.createElementVNode("text",{class:"menu-text"},"æ¸ é“")]),e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=e=>n.goTo("/pages/admin/plans"))},[e.createElementVNode("view",{class:"menu-icon-wrap purple"},"ğŸ“¦"),e.createElementVNode("text",{class:"menu-text"},"å¥—é¤")])]),e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[4]||(a[4]=e=>n.goTo("/pages/admin/redeem"))},[e.createElementVNode("view",{class:"menu-icon-wrap orange"},"ğŸ«"),e.createElementVNode("text",{class:"menu-text"},"å¡å¯†")]),e.createElementVNode("view",{class:"menu-item",onClick:a[5]||(a[5]=e=>n.goTo("/pages/admin/coupons"))},[e.createElementVNode("view",{class:"menu-icon-wrap pink"},"ğŸ"),e.createElementVNode("text",{class:"menu-text"},"ä¼˜æƒ åˆ¸")]),e.createElementVNode("view",{class:"menu-item",onClick:a[6]||(a[6]=e=>n.goTo("/pages/admin/orders"))},[e.createElementVNode("view",{class:"menu-icon-wrap cyan"},"ğŸ“‹"),e.createElementVNode("text",{class:"menu-text"},"è®¢å•")]),e.createElementVNode("view",{class:"menu-item",onClick:a[7]||(a[7]=e=>n.goTo("/pages/admin/subdomains"))},[e.createElementVNode("view",{class:"menu-icon-wrap teal"},"ğŸ”—"),e.createElementVNode("text",{class:"menu-text"},"å­åŸŸå")])]),e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[8]||(a[8]=e=>n.goTo("/pages/admin/dns-records"))},[e.createElementVNode("view",{class:"menu-icon-wrap red"},"ğŸ“"),e.createElementVNode("text",{class:"menu-text"},"DNS")]),e.createElementVNode("view",{class:"menu-item",onClick:a[9]||(a[9]=e=>n.goTo("/pages/admin/app-versions"))},[e.createElementVNode("view",{class:"menu-icon-wrap indigo"},"ğŸ“±"),e.createElementVNode("text",{class:"menu-text"},"APPç‰ˆæœ¬")]),e.createElementVNode("view",{class:"menu-item",onClick:a[10]||(a[10]=e=>n.goTo("/pages/admin/email-templates"))},[e.createElementVNode("view",{class:"menu-icon-wrap pink"},"ğŸ“§"),e.createElementVNode("text",{class:"menu-text"},"é‚®ä»¶æ¨¡æ¿")]),e.createElementVNode("view",{class:"menu-item",onClick:a[11]||(a[11]=e=>n.goTo("/pages/admin/ip-blacklist"))},[e.createElementVNode("view",{class:"menu-icon-wrap gray"},"ğŸš«"),e.createElementVNode("text",{class:"menu-text"},"IPé»‘åå•")])]),e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[12]||(a[12]=e=>n.goTo("/pages/admin/data-manage"))},[e.createElementVNode("view",{class:"menu-icon-wrap brown"},"ğŸ“¦"),e.createElementVNode("text",{class:"menu-text"},"æ•°æ®ç®¡ç†")]),e.createElementVNode("view",{class:"menu-item"}),e.createElementVNode("view",{class:"menu-item"}),e.createElementVNode("view",{class:"menu-item"})])])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"section-title"},"ç³»ç»ŸåŠŸèƒ½"),e.createElementVNode("view",{class:"func-list"},[e.createElementVNode("view",{class:"func-item",onClick:a[13]||(a[13]=e=>n.goTo("/pages/admin/announcements"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon pink"},"ğŸ“¢"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"å…¬å‘Šç®¡ç†"),e.createElementVNode("text",{class:"func-desc"},"å‘å¸ƒå’Œç®¡ç†ç³»ç»Ÿå…¬å‘Š")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")]),e.createElementVNode("view",{class:"func-item",onClick:a[14]||(a[14]=e=>n.goTo("/pages/admin/logs"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon brown"},"ğŸ“œ"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"æ“ä½œæ—¥å¿—"),e.createElementVNode("text",{class:"func-desc"},"æŸ¥çœ‹ç³»ç»Ÿæ“ä½œè®°å½•")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")]),e.createElementVNode("view",{class:"func-item",onClick:a[15]||(a[15]=e=>n.goTo("/pages/admin/settings"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon gray"},"âš™ï¸"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"ç³»ç»Ÿè®¾ç½®"),e.createElementVNode("text",{class:"func-desc"},"é…ç½®ç³»ç»Ÿå‚æ•°")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"bottom-space"})])}]]);const U=o({data:()=>({users:[],searchKey:"",page:1,hasMore:!0,loading:!1,showModal:!1,currentUser:{},editBalance:"",editMaxDomains:"",userInfo:null,roles:[{value:"user",label:"ç”¨æˆ·"},{value:"admin",label:"ç®¡ç†å‘˜"},{value:"demo",label:"æ¼”ç¤º"}],oauthProviders:["github","google","nodeloc"]}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadUsers()},methods:{async loadUsers(){var e,t;if(!this.loading){this.loading=!0;try{const a=await function(e={}){return l({url:"/admin/users",method:"GET",data:e})}({page:this.page,per_page:20,search:this.searchKey}),o=(null==(e=a.data)?void 0:e.users)||[];1===this.page?this.users=o:this.users=[...this.users,...o];const s=(null==(t=a.data)?void 0:t.pagination)||{};this.hasMore=this.page<s.pages}catch(a){}this.loading=!1}},handleSearch(){this.page=1,this.loadUsers()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadUsers())},showUserDetail(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentUser={...e},this.editBalance=String(e.balance||0),this.editMaxDomains=String(e.max_domains||0),this.showModal=!0,this.loadUserDetail(e.id))},async loadUserDetail(e){try{const t=await function(e){return l({url:`/admin/users/${e}`,method:"GET"})}(e);t.data&&(this.currentUser={...this.currentUser,...t.data})}catch(t){}},getOAuthLabel:e=>({github:"GitHub",google:"Google",nodeloc:"NodeLoc"}[e]||e),async handleUnbindOAuth(e){uni.showModal({title:"ç¡®è®¤è§£ç»‘",content:`ç¡®å®šè¦è§£ç»‘è¯¥ç”¨æˆ·çš„ ${this.getOAuthLabel(e)} è´¦å·å—ï¼Ÿ`,confirmColor:"#ff4d4f",success:async t=>{if(t.confirm)try{uni.showLoading({title:"è§£ç»‘ä¸­..."}),await function(e,t){return l({url:`/admin/users/${e}/oauth/${t}`,method:"DELETE"})}(this.currentUser.id,e),uni.hideLoading(),uni.showToast({title:"è§£ç»‘æˆåŠŸ",icon:"success"}),this.loadUserDetail(this.currentUser.id)}catch(a){uni.hideLoading()}}})},onRoleChange(e){this.currentUser.role=this.roles[e.detail.value].value},onStatusChange(e){this.currentUser.status=e.detail.value?1:0},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentUser.id,t={role:this.currentUser.role,status:this.currentUser.status,balance:parseFloat(this.editBalance),max_domains:parseInt(this.editMaxDomains)},l({url:`/admin/users/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadUsers()}catch(a){uni.hideLoading()}var e,t},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· ${this.currentUser.username} å—ï¼Ÿæ­¤æ“ä½œå°†åŒæ—¶åˆ é™¤è¯¥ç”¨æˆ·çš„æ‰€æœ‰åŸŸåå’Œè®°å½•ï¼`,confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentUser.id,l({url:`/admin/users/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadUsers()}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ç”¨æˆ·ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.users.length)+" ä½ç”¨æˆ·",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.searchKey=e),placeholder:"æœç´¢ç”¨æˆ·å/é‚®ç®±",onConfirm:a[1]||(a[1]=(...e)=>n.handleSearch&&n.handleSearch(...e))},null,544),[[e.vModelText,l.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>n.handleSearch&&n.handleSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"user-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.users,(t=>{var a,o;return e.openBlock(),e.createElementBlock("view",{class:"user-card",key:t.id,onClick:e=>n.showUserDetail(t)},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["user-avatar",{admin:"admin"===t.role}])},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString((null==(o=null==(a=t.username)?void 0:a.charAt(0))?void 0:o.toUpperCase())||"U"),1)],2)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("view",{class:"user-row"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:e.normalizeClass(["role-tag",t.role])},e.toDisplayString("admin"===t.role?"ç®¡ç†å‘˜":"ç”¨æˆ·"),3)]),e.createElementVNode("text",{class:"email"},e.toDisplayString(t.email),1),e.createElementVNode("view",{class:"user-stats"},[e.createElementVNode("view",{class:"stat-chip"},[e.createElementVNode("text",{class:"chip-label"},"ä½™é¢"),e.createElementVNode("text",{class:"chip-value"},e.toDisplayString(t.balance_text),1)]),e.createElementVNode("view",{class:"stat-chip"},[e.createElementVNode("text",{class:"chip-label"},"åŸŸå"),e.createElementVNode("text",{class:"chip-value"},e.toDisplayString(t.used_domains)+"/"+e.toDisplayString(t.max_domains),1)])])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"æ­£å¸¸":"ç¦ç”¨"),3),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])})),128)),0!==l.users.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ‘¥"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ç”¨æˆ·")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[11]||(a[11]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”¨æˆ·è¯¦æƒ…"),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"ç”¨æˆ·å"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.currentUser.username),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"é‚®ç®±"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.currentUser.email),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"è§’è‰²"),e.createElementVNode("picker",{range:l.roles,"range-key":"label",onChange:a[4]||(a[4]=(...e)=>n.onRoleChange&&n.onRoleChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString("admin"===l.currentUser.role?"ç®¡ç†å‘˜":"demo"===l.currentUser.role?"æ¼”ç¤º":"ç”¨æˆ·"),1)],40,["range"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.currentUser.status,onChange:a[5]||(a[5]=(...e)=>n.onStatusChange&&n.onStatusChange(...e))},null,40,["checked"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"ä½™é¢"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"digit","onUpdate:modelValue":a[6]||(a[6]=e=>l.editBalance=e),placeholder:"è¾“å…¥ä½™é¢"},null,512),[[e.vModelText,l.editBalance]])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åŸŸåä¸Šé™"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>l.editMaxDomains=e),placeholder:"è¾“å…¥ä¸Šé™"},null,512),[[e.vModelText,l.editMaxDomains]])]),l.currentUser.oauth_bindings?(e.openBlock(),e.createElementBlock("view",{key:0,class:"oauth-section"},[e.createElementVNode("text",{class:"section-label"},"OAuth ç»‘å®š"),e.createElementVNode("view",{class:"oauth-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.oauthProviders,(t=>(e.openBlock(),e.createElementBlock("view",{class:"oauth-item",key:t},[e.createElementVNode("view",{class:"oauth-info"},[e.createElementVNode("text",{class:"oauth-icon"},e.toDisplayString("github"===t?"ğŸ™":"google"===t?"ğŸ”":"ğŸŒ"),1),e.createElementVNode("text",{class:"oauth-name"},e.toDisplayString(n.getOAuthLabel(t)),1)]),l.currentUser.oauth_bindings&&l.currentUser.oauth_bindings[t]?(e.openBlock(),e.createElementBlock("view",{key:0,class:"oauth-status"},[e.createElementVNode("text",{class:"bound-text"},"å·²ç»‘å®š"),e.createElementVNode("view",{class:"unbind-btn",onClick:e=>n.handleUnbindOAuth(t)},"è§£ç»‘",8,["onClick"])])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"unbound-text"},"æœªç»‘å®š"))])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[9]||(a[9]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const F=o({data:()=>({domains:[],channels:[],zones:[],selectedChannel:null,selectedZone:null,showModal:!1,isEdit:!1,currentId:null,zonesLoading:!1,userInfo:null,form:{name:"",description:"",allow_register:!0,zone_id:"",dns_channel_id:null}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadDomains(),this.loadChannels()},methods:{async loadDomains(){var e;try{const t=await P();this.domains=(null==(e=t.data)?void 0:e.domains)||[]}catch(a){t("error","at pages/admin/domains.vue:142","åŠ è½½åŸŸåå¤±è´¥:",a)}},async loadChannels(){var e;try{const t=await A();this.channels=(null==(e=t.data)?void 0:e.channels)||[]}catch(a){t("error","at pages/admin/domains.vue:150","åŠ è½½æ¸ é“å¤±è´¥:",a)}},async onChannelChange(e){var a;if(this.selectedChannel=this.channels[e.detail.value],this.selectedZone=null,this.zones=[],this.selectedChannel){this.zonesLoading=!0;try{const e=await function(e,t={}){return l({url:`/admin/channels/${e}/zones`,method:"GET",data:t})}(this.selectedChannel.id);this.zones=(null==(a=e.data)?void 0:a.zones)||[]}catch(o){t("error","at pages/admin/domains.vue:163","åŠ è½½Zoneå¤±è´¥:",o)}finally{this.zonesLoading=!1}}},onZoneChange(e){this.selectedZone=this.zones[e.detail.value]},showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.selectedChannel=null,this.selectedZone=null,this.zones=[],this.form={name:"",description:"",allow_register:!0,zone_id:"",dns_channel_id:null},this.showModal=!0)},editDomain(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.selectedChannel=e.channel,this.selectedZone=null,this.form={name:e.name,description:e.description||"",allow_register:e.allow_register,zone_id:e.zone_id,dns_channel_id:e.dns_channel_id},this.showModal=!0)},async toggleStatus(e){if(this.isDemo)uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ä¿®æ”¹",icon:"none"});else try{await I(e.id,{status:1===e.status?0:1}),this.loadDomains()}catch(a){t("error","at pages/admin/domains.vue:220","æ›´æ–°çŠ¶æ€å¤±è´¥:",a)}},async handleSave(){var e;if(this.isEdit||this.selectedChannel&&this.selectedZone)try{uni.showLoading({title:this.isEdit?"ä¿å­˜ä¸­...":"æ·»åŠ ä¸­..."}),this.isEdit?await I(this.currentId,{description:this.form.description,allow_register:this.form.allow_register}):await(e={dns_channel_id:this.selectedChannel.id,name:this.selectedZone.name,zone_id:this.selectedZone.id,description:this.form.description,allow_register:this.form.allow_register},l({url:"/admin/domains",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:this.isEdit?"ä¿å­˜æˆåŠŸ":"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadDomains()}catch(t){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©æ¸ é“å’ŒZone",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåŸŸåå—ï¼Ÿéœ€å…ˆåˆ é™¤è¯¥åŸŸåä¸‹çš„æ‰€æœ‰äºŒçº§åŸŸåå’Œå¥—é¤ã€‚",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,l({url:`/admin/domains/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadDomains()}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){var i,c;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.domains.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"domain-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id},[e.createElementVNode("view",{class:"card-main",onClick:e=>n.editDomain(t)},[e.createElementVNode("view",{class:"domain-row"},[e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{open:t.allow_register}])},e.toDisplayString(t.allow_register?"å¼€æ”¾":"å…³é—­"),3)]),e.createElementVNode("view",{class:"domain-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-label"},"äºŒçº§åŸŸå"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(t.subdomains_count),1)]),t.channel?(e.openBlock(),e.createElementBlock("view",{key:0,class:"stat-item"},[e.createElementVNode("text",{class:"stat-label"},"æ¸ é“"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(t.channel.name),1)])):e.createCommentVNode("",!0)]),t.description?(e.openBlock(),e.createElementBlock("text",{key:0,class:"domain-desc"},e.toDisplayString(t.description),1)):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"card-action"},[e.createElementVNode("switch",{checked:1===t.status,onChange:e=>n.toggleStatus(t)},null,40,["checked","onChange"])])])))),128)),0===l.domains.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— åŸŸå")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>n.showAdd&&n.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("scroll-view",{class:"modal-content","scroll-y":""},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.isEdit?"ç¼–è¾‘åŸŸå":"æ·»åŠ åŸŸå"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"DNSæ¸ é“"),e.createElementVNode("picker",{range:l.channels,"range-key":"name",onChange:a[1]||(a[1]=(...e)=>n.onChannelChange&&n.onChannelChange(...e)),disabled:l.isEdit},[e.createElementVNode("view",{class:"picker"},e.toDisplayString((null==(i=l.selectedChannel)?void 0:i.name)||"è¯·é€‰æ‹©"),1)],40,["range","disabled"])]),l.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"Zone"),e.createElementVNode("picker",{range:l.zones,"range-key":"name",onChange:a[2]||(a[2]=(...e)=>n.onZoneChange&&n.onZoneChange(...e)),disabled:!l.selectedChannel||l.zonesLoading},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(l.zonesLoading?"åŠ è½½ä¸­...":(null==(c=l.selectedZone)?void 0:c.name)||"è¯·é€‰æ‹©"),1)],40,["range","disabled"])])),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"åŸŸå"),e.createElementVNode("text",{class:"value"},e.toDisplayString(l.form.name),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æè¿°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>l.form.description=e),placeholder:"å¯é€‰"},null,512),[[e.vModelText,l.form.description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¼€æ”¾æ³¨å†Œ"),e.createElementVNode("switch",{checked:l.form.allow_register,onChange:a[4]||(a[4]=e=>l.form.allow_register=e.detail.value)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[6]||(a[6]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.isEdit?"ä¿å­˜":"æ·»åŠ "),1)])])])])):e.createCommentVNode("",!0)])}]]);const R=o({data:()=>({plans:[],rawPlans:[],domains:[],domainOptions:[{id:0,name:"å…¨éƒ¨åŸŸå"}],filterDomain:null,showAddModal:!1,showEditModal:!1,currentPlanIds:[],userInfo:null,newPlan:{name:"",price:"",duration_days:"30",min_length:"1",max_length:"63",max_records:"10",domain_ids:[]},editData:{name:"",price:"",duration_days:"",min_length:"",max_length:"",max_records:"",status:1,domain_ids:[]}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadDomains(),this.loadPlans()},methods:{getDomainList:e=>e.domain_names&&Array.isArray(e.domain_names)?e.domain_names:e.domain_name?[e.domain_name]:[],mergePlansByName(e){const t=new Map;return e.forEach((e=>{const a=e.name;if(t.has(a)){const o=t.get(a);e.domain_name&&!o.domain_names.includes(e.domain_name)&&o.domain_names.push(e.domain_name),e.domain_id&&!o.domain_ids.includes(e.domain_id)&&o.domain_ids.push(e.domain_id),o.plan_ids.push(e.id)}else t.set(a,{...e,domain_names:e.domain_name?[e.domain_name]:[],domain_ids:e.domain_id?[e.domain_id]:[],plan_ids:[e.id]})})),Array.from(t.values())},async loadDomains(){var e;try{const t=await P();this.domains=(null==(e=t.data)?void 0:e.domains)||[],this.domainOptions=[{id:0,name:"å…¨éƒ¨åŸŸå"},...this.domains]}catch(t){}},async loadPlans(){var e,t;try{const a={};(null==(e=this.filterDomain)?void 0:e.id)&&(a.domain_id=this.filterDomain.id);const o=await function(e={}){return l({url:"/admin/plans",method:"GET",data:e})}(a);this.rawPlans=(null==(t=o.data)?void 0:t.plans)||[],this.plans=this.mergePlansByName(this.rawPlans)}catch(a){}},onDomainFilter(e){this.filterDomain=this.domainOptions[e.detail.value],0===this.filterDomain.id&&(this.filterDomain=null),this.loadPlans()},async openAddModal(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(0===this.domains.length&&await this.loadDomains(),this.newPlan={name:"",price:"",duration_days:"30",min_length:"1",max_length:"63",max_records:"10",domain_ids:[]},this.showAddModal=!0)},toggleNewDomain(e){const t=this.newPlan.domain_ids.findIndex((t=>t==e));t>-1?this.newPlan.domain_ids.splice(t,1):this.newPlan.domain_ids.push(e)},toggleEditDomain(e){const t=this.editData.domain_ids.findIndex((t=>t==e));t>-1?this.editData.domain_ids.splice(t,1):this.editData.domain_ids.push(e)},isDomainChecked:(e,t)=>t.some((t=>t==e)),async handleAdd(){var e;if(this.isDemo)uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"});else if(this.newPlan.name)if(0!==this.newPlan.domain_ids.length)try{uni.showLoading({title:"æ·»åŠ ä¸­..."}),await(e={domain_ids:this.newPlan.domain_ids,name:this.newPlan.name,price:parseFloat(this.newPlan.price)||0,duration_days:parseInt(this.newPlan.duration_days)||30,min_length:parseInt(this.newPlan.min_length)||1,max_length:parseInt(this.newPlan.max_length)||63,max_records:parseInt(this.newPlan.max_records)||10},l({url:"/admin/plans",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showAddModal=!1,this.loadPlans()}catch(t){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©å…³è”åŸŸå",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¥—é¤åç§°",icon:"none"})},async editPlan(e){if(this.isDemo)return void uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"});0===this.domains.length&&await this.loadDomains(),this.currentPlanIds=e.plan_ids||[e.id];const t=e.domain_ids?[...e.domain_ids]:[];this.editData={name:e.name,price:String(e.price||0),duration_days:String(e.duration_days||30),min_length:String(e.min_length||1),max_length:String(e.max_length||63),max_records:String(e.max_records||10),status:e.status,domain_ids:t},this.showEditModal=!0},async handleUpdate(){var e,t;if(this.editData.name)if(0!==this.editData.domain_ids.length)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentPlanIds[0],t={domain_ids:this.editData.domain_ids,name:this.editData.name,price:parseFloat(this.editData.price)||0,duration_days:parseInt(this.editData.duration_days)||30,min_length:parseInt(this.editData.min_length)||1,max_length:parseInt(this.editData.max_length)||63,max_records:parseInt(this.editData.max_records)||10,status:this.editData.status},l({url:`/admin/plans/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showEditModal=!1,this.loadPlans()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©å…³è”åŸŸå",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¥—é¤åç§°",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¥—é¤å—ï¼Ÿå°†åˆ é™¤æ‰€æœ‰å…³è”åŸŸåçš„å¥—é¤è®°å½•",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{uni.showLoading({title:"åˆ é™¤ä¸­..."});for(const e of this.currentPlanIds)await(t=e,l({url:`/admin/plans/${t}`,method:"DELETE"}));uni.hideLoading(),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showEditModal=!1,this.loadPlans()}catch(a){uni.hideLoading()}var t}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å¥—é¤ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.plans.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:l.domainOptions,"range-key":"name",onChange:a[0]||(a[0]=(...e)=>n.onDomainFilter&&n.onDomainFilter(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString((null==(i=l.filterDomain)?void 0:i.name)||"å…¨éƒ¨åŸŸå"),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"plan-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.plans,(t=>(e.openBlock(),e.createElementBlock("view",{class:"plan-card",key:t.id,onClick:e=>n.editPlan(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"plan-title"},[e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:e.normalizeClass(["plan-badge",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å¯ç”¨":"ç¦ç”¨"),3)]),e.createElementVNode("text",{class:"plan-price"},"Â¥"+e.toDisplayString(t.price),1)]),e.createElementVNode("view",{class:"domain-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.getDomainList(t),((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"domain-tag",key:a},e.toDisplayString(t),1)))),128))]),e.createElementVNode("view",{class:"plan-specs"},[e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"æ—¶é•¿"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.duration_text),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"é•¿åº¦"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.min_length)+"-"+e.toDisplayString(t.max_length),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"è®°å½•"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.max_records_text),1)])])],8,["onClick"])))),128)),0===l.plans.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¦"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¥—é¤")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[1]||(a[1]=(...e)=>n.openAddModal&&n.openAddModal(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showAddModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[10]||(a[10]=e.withModifiers((e=>l.showAddModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-scroll"},[e.createElementVNode("text",{class:"modal-title"},"æ·»åŠ å¥—é¤"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¥—é¤åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[2]||(a[2]=e=>l.newPlan.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,l.newPlan.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä»·æ ¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[3]||(a[3]=e=>l.newPlan.price=e),placeholder:"0"},null,512),[[e.vModelText,l.newPlan.price]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ‰æ•ˆå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>l.newPlan.duration_days=e),placeholder:"-1ä¸ºæ°¸ä¹…"},null,512),[[e.vModelText,l.newPlan.duration_days]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å°é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>l.newPlan.min_length=e),placeholder:"1"},null,512),[[e.vModelText,l.newPlan.min_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>l.newPlan.max_length=e),placeholder:"63"},null,512),[[e.vModelText,l.newPlan.max_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§è®°å½•æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>l.newPlan.max_records=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,l.newPlan.max_records]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å…³è”åŸŸåï¼ˆå¯å¤šé€‰ï¼‰"),l.domains.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkbox-group"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"checkbox-item",key:t.id,onClick:e=>n.toggleNewDomain(t.id)},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:n.isDomainChecked(t.id,l.newPlan.domain_ids)}])},"âœ“",2),e.createElementVNode("text",null,e.toDisplayString(t.name),1)],8,["onClick"])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æ— å¯é€‰åŸŸå")]))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>l.showAddModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[9]||(a[9]=(...e)=>n.handleAdd&&n.handleAdd(...e))},[e.createElementVNode("text",null,"æ·»åŠ ")])])])])])):e.createCommentVNode("",!0),l.showEditModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[21]||(a[21]=e.withModifiers((e=>l.showEditModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-scroll"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘å¥—é¤"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¥—é¤åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[11]||(a[11]=e=>l.editData.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,l.editData.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä»·æ ¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[12]||(a[12]=e=>l.editData.price=e),placeholder:"0"},null,512),[[e.vModelText,l.editData.price]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ‰æ•ˆå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[13]||(a[13]=e=>l.editData.duration_days=e),placeholder:"-1ä¸ºæ°¸ä¹…"},null,512),[[e.vModelText,l.editData.duration_days]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å°é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[14]||(a[14]=e=>l.editData.min_length=e),placeholder:"1"},null,512),[[e.vModelText,l.editData.min_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[15]||(a[15]=e=>l.editData.max_length=e),placeholder:"63"},null,512),[[e.vModelText,l.editData.max_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§è®°å½•æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[16]||(a[16]=e=>l.editData.max_records=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,l.editData.max_records]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å…³è”åŸŸåï¼ˆå¯å¤šé€‰ï¼‰"),l.domains.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkbox-group"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"checkbox-item",key:t.id,onClick:e=>n.toggleEditDomain(t.id)},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:n.isDomainChecked(t.id,l.editData.domain_ids)}])},"âœ“",2),e.createElementVNode("text",null,e.toDisplayString(t.name),1)],8,["onClick"])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æ— å¯é€‰åŸŸå")]))]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.editData.status,onChange:a[17]||(a[17]=e=>l.editData.status=e.detail.value?1:0)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[18]||(a[18]=e=>l.showEditModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[19]||(a[19]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[20]||(a[20]=(...e)=>n.handleUpdate&&n.handleUpdate(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])])):e.createCommentVNode("",!0)])}]]);const $=o({data:()=>({codes:[],statusFilter:"all",page:1,hasMore:!0,loading:!1,showGenModal:!1,showResultModal:!1,generatedCodes:[],userInfo:null,genForm:{amount:"",count:"10",expires_days:""}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadCodes()},methods:{async loadCodes(){var e,t;if(!this.loading){this.loading=!0;try{const a={page:this.page,per_page:20};"unused"===this.statusFilter?a.status=0:"used"===this.statusFilter&&(a.status=1);const o=await function(e={}){return l({url:"/admin/redeem-codes",method:"GET",data:e})}(a),s=(null==(e=o.data)?void 0:e.codes)||[];1===this.page?this.codes=s:this.codes=[...this.codes,...s];const n=(null==(t=o.data)?void 0:t.pagination)||{};this.hasMore=this.page<n.pages}catch(a){}this.loading=!1}},setFilter(e){this.statusFilter=e,this.page=1,this.loadCodes()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadCodes())},formatTime:e=>e?e.split("T")[0]:"",formatUser:e=>e?"string"==typeof e?e:e.username||e.email||"æœªçŸ¥ç”¨æˆ·":"",showGenerate(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç”Ÿæˆ",icon:"none"}):this.showGenModal=!0},async handleGenerate(){var e,t;if(this.genForm.amount&&this.genForm.count)try{uni.showLoading({title:"ç”Ÿæˆä¸­..."});const a={amount:parseFloat(this.genForm.amount),count:parseInt(this.genForm.count)};this.genForm.expires_days&&(a.expires_days=parseInt(this.genForm.expires_days));const o=await(t=a,l({url:"/admin/redeem-codes/generate",method:"POST",data:t}));uni.hideLoading(),this.generatedCodes=((null==(e=o.data)?void 0:e.codes)||[]).map((e=>e.code||e)),this.showGenModal=!1,this.showResultModal=!0,this.page=1,this.loadCodes()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"})},copyAll(){const e=this.generatedCodes.join("\n");uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"å·²å¤åˆ¶",icon:"success"}),this.showResultModal=!1}})},copyCode(e){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"å¡å¯†å·²å¤åˆ¶",icon:"success"})}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å¡å¯†ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.codes.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"all"===l.statusFilter}]),onClick:a[0]||(a[0]=e=>n.setFilter("all"))},[e.createElementVNode("text",{class:"filter-text"},"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"unused"===l.statusFilter}]),onClick:a[1]||(a[1]=e=>n.setFilter("unused"))},[e.createElementVNode("text",{class:"filter-text"},"æœªä½¿ç”¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"used"===l.statusFilter}]),onClick:a[2]||(a[2]=e=>n.setFilter("used"))},[e.createElementVNode("text",{class:"filter-text"},"å·²ä½¿ç”¨")],2)])]),e.createElementVNode("view",{class:"code-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.codes,(t=>(e.openBlock(),e.createElementBlock("view",{class:"code-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["code-badge",{used:1===t.status}])},e.toDisplayString(0===t.status?"æœªä½¿ç”¨":"å·²ä½¿ç”¨"),3),e.createElementVNode("text",{class:"code-amount"},e.toDisplayString(t.amount_text||"Â¥"+t.amount),1)]),e.createElementVNode("view",{class:"code-body",onClick:e=>n.copyCode(t.code)},[e.createElementVNode("text",{class:"code-text"},e.toDisplayString(t.code),1),e.createElementVNode("text",{class:"copy-btn"},"ğŸ“‹")],8,["onClick"]),e.createElementVNode("view",{class:"code-footer"},[t.used_by?(e.openBlock(),e.createElementBlock("text",{key:0,class:"code-user"},"ä½¿ç”¨è€…: "+e.toDisplayString(n.formatUser(t.used_by)),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"code-time"},e.toDisplayString(n.formatTime(t.created_at)),1)])])))),128)),0!==l.codes.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ«"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¡å¯†")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fab",onClick:a[4]||(a[4]=(...e)=>n.showGenerate&&n.showGenerate(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showGenModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[10]||(a[10]=e.withModifiers((e=>l.showGenModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”Ÿæˆå¡å¯†"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å……å€¼é‡‘é¢"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[5]||(a[5]=e=>l.genForm.amount=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,l.genForm.amount]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>l.genForm.count=e),placeholder:"1-100"},null,512),[[e.vModelText,l.genForm.count]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è¿‡æœŸå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>l.genForm.expires_days=e),placeholder:"ç•™ç©ºä¸è¿‡æœŸ"},null,512),[[e.vModelText,l.genForm.expires_days]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>l.showGenModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[9]||(a[9]=(...e)=>n.handleGenerate&&n.handleGenerate(...e))},[e.createElementVNode("text",null,"ç”Ÿæˆ")])])])])):e.createCommentVNode("",!0),l.showResultModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[12]||(a[12]=e.withModifiers((e=>l.showResultModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”ŸæˆæˆåŠŸ"),e.createElementVNode("view",{class:"result-codes"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.generatedCodes,((t,a)=>(e.openBlock(),e.createElementBlock("text",{class:"result-code",key:a},e.toDisplayString(t),1)))),128))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[11]||(a[11]=(...e)=>n.copyAll&&n.copyAll(...e))},[e.createElementVNode("text",null,"å¤åˆ¶å…¨éƒ¨")])])])])):e.createCommentVNode("",!0)])}]]);const z=o({data:()=>({orders:[],searchKey:"",page:1,hasMore:!0,loading:!1}),onLoad(){this.loadOrders()},methods:{async loadOrders(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.searchKey&&(t.search=this.searchKey);const o=await function(e={}){return l({url:"/admin/purchase-records",method:"GET",data:e})}(t),s=(null==(e=o.data)?void 0:e.records)||[];1===this.page?this.orders=s:this.orders=[...this.orders,...s];const n=(null==(a=o.data)?void 0:a.pagination)||{};this.hasMore=this.page<n.pages}catch(o){t("error","at pages/admin/orders.vue:89","è®¢å•åŠ è½½å¤±è´¥:",o)}this.loading=!1}},doSearch(){this.page=1,this.loadOrders()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadOrders())},formatTime:e=>e?e.replace("T"," ").substring(0,16):""}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"è®¢å•ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.orders.length)+" æ¡",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.searchKey=e),placeholder:"æœç´¢åŸŸå/å¥—é¤å",onConfirm:a[1]||(a[1]=(...e)=>n.doSearch&&n.doSearch(...e))},null,544),[[e.vModelText,l.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>n.doSearch&&n.doSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"order-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.orders,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"order-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"order-domain"},e.toDisplayString(t.subdomain_name),1),e.createElementVNode("text",{class:"order-price"},e.toDisplayString(t.price_text||"Â¥"+t.price),1)]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"ç”¨æˆ·"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(null==(a=t.user)?void 0:a.username),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"å¥—é¤"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.plan_name),1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"order-duration"},e.toDisplayString(t.duration_text),1),e.createElementVNode("text",{class:"order-time"},e.toDisplayString(n.formatTime(t.created_at)),1)])])})),128)),0!==l.orders.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— è®¢å•")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0)])}]]);const O=o({data:()=>({announcements:[],showModal:!1,isEdit:!1,currentId:null,userInfo:null,form:{title:"",content:"",is_important:!1,status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadAnnouncements()},methods:{async loadAnnouncements(){var e;try{const t=await function(e={}){return l({url:"/admin/announcements",method:"GET",data:e})}();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[]}catch(t){}},formatTime:e=>e?e.split("T")[0]:"",showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.form={title:"",content:"",is_important:!1,status:1},this.showModal=!0)},editAnnouncement(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.form={title:e.title,content:e.content,is_important:e.is_important,status:e.status},this.showModal=!0)},async handleSave(){var e,t;if(this.form.title&&this.form.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),this.isEdit?await(e=this.currentId,t=this.form,l({url:`/admin/announcements/${e}`,method:"PUT",data:t})):await function(e){return l({url:"/admin/announcements",method:"POST",data:e})}(this.form),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadAnnouncements()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡å…¬å‘Šå—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,l({url:`/admin/announcements/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadAnnouncements()}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å…¬å‘Šç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.announcements.length)+" æ¡",1)]),e.createElementVNode("view",{class:"announcement-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.announcements,(t=>(e.openBlock(),e.createElementBlock("view",{class:"announcement-card",key:t.id,onClick:e=>n.editAnnouncement(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"tag-row"},[t.is_important?(e.openBlock(),e.createElementBlock("view",{key:0,class:"important-tag"},"ğŸ”¥ é‡è¦")):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å·²å‘å¸ƒ":"å·²ä¸‹æ¶"),3)])]),e.createElementVNode("text",{class:"card-content"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(n.formatTime(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0===l.announcements.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¢"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å…¬å‘Š")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>n.showAdd&&n.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.isEdit?"ç¼–è¾‘å…¬å‘Š":"æ·»åŠ å…¬å‘Š"),1),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ ‡é¢˜"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[1]||(a[1]=e=>l.form.title=e),placeholder:"è¾“å…¥æ ‡é¢˜"},null,512),[[e.vModelText,l.form.title]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å†…å®¹"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[2]||(a[2]=e=>l.form.content=e),placeholder:"è¾“å…¥å†…å®¹"},null,512),[[e.vModelText,l.form.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é‡è¦å…¬å‘Š"),e.createElementVNode("switch",{checked:l.form.is_important,onChange:a[3]||(a[3]=e=>l.form.is_important=e.detail.value)},null,40,["checked"])]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"å‘å¸ƒçŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.form.status,onChange:a[4]||(a[4]=e=>l.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[6]||(a[6]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const K=o({data:()=>({userInfo:null,settings:{site_name:"",site_description:"",site_url:"",admin_email:"",allow_register:"1",default_max_domains:"10",email_suffix_enabled:"0",email_suffix_mode:"whitelist",email_suffix_list:"",turnstile_enabled:"false",turnstile_site_key:"",turnstile_secret_key:"",captcha_login:"1",captcha_register:"1",captcha_forgot_password:"1",github_client_id:"",github_client_secret:"",google_client_id:"",google_client_secret:"",nodeloc_client_id:"",nodeloc_client_secret:"",smtp_host:"",smtp_port:"",smtp_user:"",smtp_password:"",smtp_ssl:"1",redeem_channel_text:"",redeem_channel_url:"",analytics_code:""}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){if(this.userInfo=p(),this.isDemo)return uni.showToast({title:"æ¼”ç¤ºç”¨æˆ·æ— æƒè®¿é—®è®¾ç½®",icon:"none"}),void setTimeout((()=>uni.navigateBack()),1500);this.loadSettings()},methods:{async loadSettings(){var e;uni.showLoading({title:"åŠ è½½ä¸­..."});try{const t=await l({url:"/admin/settings",method:"GET"}),a=(null==(e=t.data)?void 0:e.settings)||t.data||{};Object.keys(this.settings).forEach((e=>{void 0!==a[e]&&null!==a[e]&&(this.settings[e]=String(a[e]))}))}catch(a){t("error","at pages/admin/settings.vue:300","åŠ è½½è®¾ç½®å¤±è´¥",a)}uni.hideLoading()},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.settings,l({url:"/admin/settings",method:"PUT",data:e})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"})}catch(t){uni.hideLoading()}var e},testSmtpConfig(){uni.showModal({title:"æµ‹è¯• SMTP",editable:!0,placeholderText:"è¾“å…¥æµ‹è¯•é‚®ç®±",success:async e=>{if(e.confirm&&e.content)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(t=e.content,l({url:"/admin/settings/test-smtp",method:"POST",data:{email:t}})),uni.hideLoading(),uni.showToast({title:"å‘é€æˆåŠŸ",icon:"success"})}catch(a){uni.hideLoading()}var t}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ç³»ç»Ÿè®¾ç½®"),e.createElementVNode("text",{class:"header-subtitle"},"é…ç½®ç³»ç»Ÿå‚æ•°")]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸŒ ç«™ç‚¹è®¾ç½®")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç«™ç‚¹åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[0]||(a[0]=e=>l.settings.site_name=e),placeholder:"è¾“å…¥ç«™ç‚¹åç§°"},null,512),[[e.vModelText,l.settings.site_name]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"ç«™ç‚¹æè¿°"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[1]||(a[1]=e=>l.settings.site_description=e),placeholder:"è¾“å…¥æè¿°"},null,512),[[e.vModelText,l.settings.site_description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç«™ç‚¹ URL"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[2]||(a[2]=e=>l.settings.site_url=e),placeholder:"https://example.com"},null,512),[[e.vModelText,l.settings.site_url]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç®¡ç†å‘˜é‚®ç®±"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>l.settings.admin_email=e),placeholder:"admin@example.com"},null,512),[[e.vModelText,l.settings.admin_email]])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“ æ³¨å†Œè®¾ç½®")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¼€æ”¾æ³¨å†Œ"),e.createElementVNode("switch",{checked:"1"===l.settings.allow_register,onChange:a[4]||(a[4]=e=>l.settings.allow_register=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ–°ç”¨æˆ·é»˜è®¤åŸŸåé…é¢"),e.withDirectives(e.createElementVNode("input",{class:"input short",type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>l.settings.default_max_domains=e),placeholder:"10"},null,512),[[e.vModelText,l.settings.default_max_domains]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é‚®ç®±åç¼€é™åˆ¶"),e.createElementVNode("switch",{checked:"1"===l.settings.email_suffix_enabled,onChange:a[6]||(a[6]=e=>l.settings.email_suffix_enabled=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])]),"1"===l.settings.email_suffix_enabled?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"é™åˆ¶æ¨¡å¼"),e.createElementVNode("view",{class:"radio-group"},[e.createElementVNode("view",{class:e.normalizeClass(["radio-item",{active:"whitelist"===l.settings.email_suffix_mode}]),onClick:a[7]||(a[7]=e=>l.settings.email_suffix_mode="whitelist")},[e.createElementVNode("text",null,"ç™½åå•")],2),e.createElementVNode("view",{class:e.normalizeClass(["radio-item",{active:"blacklist"===l.settings.email_suffix_mode}]),onClick:a[8]||(a[8]=e=>l.settings.email_suffix_mode="blacklist")},[e.createElementVNode("text",null,"é»‘åå•")],2)])])):e.createCommentVNode("",!0),"1"===l.settings.email_suffix_enabled?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item column"},[e.createElementVNode("text",{class:"label"},"é‚®ç®±åç¼€åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[9]||(a[9]=e=>l.settings.email_suffix_list=e),placeholder:"@gmail.com\n@qq.com"},null,512),[[e.vModelText,l.settings.email_suffix_list]])])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ”’ éªŒè¯ç è®¾ç½®")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¯ç”¨ Turnstile"),e.createElementVNode("switch",{checked:"true"===l.settings.turnstile_enabled,onChange:a[10]||(a[10]=e=>l.settings.turnstile_enabled=e.detail.value?"true":"false"),color:"#4C84FF"},null,40,["checked"])]),"true"===l.settings.turnstile_enabled?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Site Key"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[11]||(a[11]=e=>l.settings.turnstile_site_key=e),placeholder:"Turnstile Site Key"},null,512),[[e.vModelText,l.settings.turnstile_site_key]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Secret Key"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[12]||(a[12]=e=>l.settings.turnstile_secret_key=e),placeholder:"Turnstile Secret Key"},null,512),[[e.vModelText,l.settings.turnstile_secret_key]])])],64)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç™»å½•éœ€è¦éªŒè¯ç "),e.createElementVNode("switch",{checked:"1"===l.settings.captcha_login,onChange:a[13]||(a[13]=e=>l.settings.captcha_login=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ³¨å†Œéœ€è¦éªŒè¯ç "),e.createElementVNode("switch",{checked:"1"===l.settings.captcha_register,onChange:a[14]||(a[14]=e=>l.settings.captcha_register=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ‰¾å›å¯†ç éœ€è¦éªŒè¯ç "),e.createElementVNode("switch",{checked:"1"===l.settings.captcha_forgot_password,onChange:a[15]||(a[15]=e=>l.settings.captcha_forgot_password=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ”— OAuth ç™»å½•"),e.createElementVNode("text",{class:"section-tip"},"å›è°ƒ URL: "+e.toDisplayString(l.settings.site_url)+"/api/auth/{provider}/callback",1)]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"oauth-group"},[e.createElementVNode("text",{class:"oauth-title"},"GitHub"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client ID"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[16]||(a[16]=e=>l.settings.github_client_id=e),placeholder:"GitHub Client ID"},null,512),[[e.vModelText,l.settings.github_client_id]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client Secret"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[17]||(a[17]=e=>l.settings.github_client_secret=e),placeholder:"GitHub Client Secret"},null,512),[[e.vModelText,l.settings.github_client_secret]])])]),e.createElementVNode("view",{class:"oauth-group"},[e.createElementVNode("text",{class:"oauth-title"},"Google"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client ID"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[18]||(a[18]=e=>l.settings.google_client_id=e),placeholder:"Google Client ID"},null,512),[[e.vModelText,l.settings.google_client_id]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client Secret"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[19]||(a[19]=e=>l.settings.google_client_secret=e),placeholder:"Google Client Secret"},null,512),[[e.vModelText,l.settings.google_client_secret]])])]),e.createElementVNode("view",{class:"oauth-group"},[e.createElementVNode("text",{class:"oauth-title"},"NodeLoc"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client ID"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[20]||(a[20]=e=>l.settings.nodeloc_client_id=e),placeholder:"NodeLoc Client ID"},null,512),[[e.vModelText,l.settings.nodeloc_client_id]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Client Secret"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[21]||(a[21]=e=>l.settings.nodeloc_client_secret=e),placeholder:"NodeLoc Client Secret"},null,512),[[e.vModelText,l.settings.nodeloc_client_secret]])])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“§ SMTP è®¾ç½®")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTP æœåŠ¡å™¨"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[22]||(a[22]=e=>l.settings.smtp_host=e),placeholder:"smtp.example.com"},null,512),[[e.vModelText,l.settings.smtp_host]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTP ç«¯å£"),e.withDirectives(e.createElementVNode("input",{class:"input short",type:"number","onUpdate:modelValue":a[23]||(a[23]=e=>l.settings.smtp_port=e),placeholder:"465"},null,512),[[e.vModelText,l.settings.smtp_port]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTP ç”¨æˆ·å"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[24]||(a[24]=e=>l.settings.smtp_user=e),placeholder:"è¾“å…¥ç”¨æˆ·å"},null,512),[[e.vModelText,l.settings.smtp_user]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTP å¯†ç "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[25]||(a[25]=e=>l.settings.smtp_password=e),placeholder:"è¾“å…¥å¯†ç "},null,512),[[e.vModelText,l.settings.smtp_password]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¯ç”¨ SSL"),e.createElementVNode("switch",{checked:"1"===l.settings.smtp_ssl,onChange:a[26]||(a[26]=e=>l.settings.smtp_ssl=e.detail.value?"1":"0"),color:"#4C84FF"},null,40,["checked"])]),e.createElementVNode("view",{class:"action-btn",onClick:a[27]||(a[27]=(...e)=>n.testSmtpConfig&&n.testSmtpConfig(...e))},[e.createElementVNode("text",null,"ğŸ“¤ æµ‹è¯• SMTP é…ç½®")])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ« å¡å¯†æ¸ é“")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æŒ‰é’®æ–‡å­—"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[28]||(a[28]=e=>l.settings.redeem_channel_text=e),placeholder:"è´­ä¹°å¡å¯†"},null,512),[[e.vModelText,l.settings.redeem_channel_text]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é“¾æ¥åœ°å€"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[29]||(a[29]=e=>l.settings.redeem_channel_url=e),placeholder:"https://..."},null,512),[[e.vModelText,l.settings.redeem_channel_url]])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“Š ç½‘ç«™ç»Ÿè®¡")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"ç»Ÿè®¡ä»£ç ï¼ˆæ”¯æŒ HTMLï¼‰"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea code","onUpdate:modelValue":a[30]||(a[30]=e=>l.settings.analytics_code=e),placeholder:"<script>...<\/script>"},null,512),[[e.vModelText,l.settings.analytics_code]])])])])]),e.createElementVNode("view",{class:"save-bar"},[e.createElementVNode("view",{class:"save-btn",onClick:a[31]||(a[31]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜è®¾ç½®")])])])}]]);const G=o({data:()=>({channels:[],providers:[],showModal:!1,isEdit:!1,currentId:null,selectedProvider:null,userInfo:null,form:{name:"",provider_type:"",credentials:{},remark:"",status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)},credentialFields(){var e;return{cloudflare:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ Global API Key",secret:!0},{key:"email",label:"é‚®ç®±",placeholder:"è¾“å…¥ Cloudflare é‚®ç®±"}],aliyun:[{key:"access_key_id",label:"AccessKey ID",placeholder:"è¾“å…¥ AccessKey ID"},{key:"access_key_secret",label:"AccessKey Secret",placeholder:"è¾“å…¥ AccessKey Secret",secret:!0}],dnspod:[{key:"secret_id",label:"SecretId",placeholder:"è¾“å…¥ SecretId"},{key:"secret_key",label:"SecretKey",placeholder:"è¾“å…¥ SecretKey",secret:!0}],huawei:[{key:"ak",label:"AK",placeholder:"è¾“å…¥ Access Key"},{key:"sk",label:"SK",placeholder:"è¾“å…¥ Secret Key",secret:!0}],westcn:[{key:"username",label:"ç”¨æˆ·å",placeholder:"è¾“å…¥ç”¨æˆ·å"},{key:"api_password",label:"APIå¯†ç ",placeholder:"è¾“å…¥ API å¯†ç ",secret:!0}],route53:[{key:"access_key_id",label:"Access Key ID",placeholder:"è¾“å…¥ Access Key ID"},{key:"secret_access_key",label:"Secret Access Key",placeholder:"è¾“å…¥ Secret Access Key",secret:!0}],godaddy:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key"},{key:"api_secret",label:"API Secret",placeholder:"è¾“å…¥ API Secret",secret:!0}],namecheap:[{key:"api_user",label:"API User",placeholder:"è¾“å…¥ API User"},{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key",secret:!0},{key:"client_ip",label:"Client IP",placeholder:"è¾“å…¥ç™½åå• IP"}],namecom:[{key:"username",label:"ç”¨æˆ·å",placeholder:"è¾“å…¥ç”¨æˆ·å"},{key:"api_token",label:"API Token",placeholder:"è¾“å…¥ API Token",secret:!0}],baiducloud:[{key:"access_key",label:"Access Key",placeholder:"è¾“å…¥ Access Key"},{key:"secret_key",label:"Secret Key",placeholder:"è¾“å…¥ Secret Key",secret:!0}],namesilo:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key",secret:!0}]}[this.isEdit?this.form.provider_type:null==(e=this.selectedProvider)?void 0:e.type]||[]}},onLoad(){this.userInfo=p(),this.loadChannels(),this.loadProviders()},methods:{async loadChannels(){var e;try{const t=await A();this.channels=(null==(e=t.data)?void 0:e.channels)||[]}catch(a){t("error","at pages/admin/cf-accounts.vue:188","åŠ è½½æ¸ é“å¤±è´¥:",a)}},async loadProviders(){var e;try{const t=await l({url:"/admin/channels/providers",method:"GET"});this.providers=(null==(e=t.data)?void 0:e.providers)||[]}catch(t){this.providers=[{type:"cloudflare",name:"Cloudflare"},{type:"aliyun",name:"é˜¿é‡Œäº‘DNS"},{type:"dnspod",name:"è…¾è®¯äº‘DNSPod"},{type:"huawei",name:"åä¸ºäº‘DNS"},{type:"westcn",name:"è¥¿éƒ¨æ•°ç "},{type:"route53",name:"AWS Route53"},{type:"godaddy",name:"GoDaddy"},{type:"namecheap",name:"Namecheap"},{type:"namecom",name:"Name.com"},{type:"baiducloud",name:"ç™¾åº¦æ™ºèƒ½äº‘"},{type:"namesilo",name:"NameSilo"}]}},getProviderIcon:e=>({cloudflare:"â˜ï¸",aliyun:"ğŸŒ",dnspod:"ğŸ”·",huawei:"ğŸ”´",westcn:"ğŸŒ",route53:"ğŸŸ ",godaddy:"ğŸŸ¢",namecheap:"ğŸ”¶",namecom:"ğŸ“›",baiducloud:"ğŸ”µ",namesilo:"ğŸŸ£"}[e]||"â˜ï¸"),getProviderName(e){const t=this.providers.find((t=>t.type===e));return(null==t?void 0:t.name)||e},showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.selectedProvider=null,this.form={name:"",provider_type:"",credentials:{},remark:"",status:1},this.showModal=!0)},editChannel(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.selectedProvider=null,this.form={name:e.name,provider_type:e.provider_type,credentials:{},remark:e.remark||"",status:e.status},this.showModal=!0)},onProviderChange(e){this.selectedProvider=this.providers[e.detail.value],this.form.provider_type=this.selectedProvider.type,this.form.credentials={}},async handleVerify(){try{uni.showLoading({title:"éªŒè¯ä¸­..."}),await(e=this.currentId,l({url:`/admin/channels/${e}/verify`,method:"POST"})),uni.hideLoading(),uni.showToast({title:"éªŒè¯æˆåŠŸ",icon:"success"})}catch(t){uni.hideLoading(),uni.showToast({title:"éªŒè¯å¤±è´¥",icon:"none"})}var e},async handleSave(){if(this.form.name)if(this.isEdit||this.form.provider_type){if(!this.isEdit)for(const e of this.credentialFields)if(!this.form.credentials[e.key])return void uni.showToast({title:`è¯·è¾“å…¥${e.label}`,icon:"none"});try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={name:this.form.name,remark:this.form.remark};if(this.isEdit){e.status=this.form.status;const t={};for(const e in this.form.credentials)this.form.credentials[e]&&(t[e]=this.form.credentials[e]);Object.keys(t).length>0&&(e.credentials=t),await function(e,t){return l({url:`/admin/channels/${e}`,method:"PUT",data:t})}(this.currentId,e)}else e.provider_type=this.form.provider_type,e.credentials=this.form.credentials,await function(e){return l({url:"/admin/channels",method:"POST",data:e})}(e);uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadChannels()}catch(e){uni.hideLoading()}}else uni.showToast({title:"è¯·é€‰æ‹©æœåŠ¡å•†",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥æ¸ é“åç§°",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¸ é“å—ï¼Ÿéœ€å…ˆåˆ é™¤è¯¥æ¸ é“ä¸‹çš„æ‰€æœ‰åŸŸåã€‚",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,l({url:`/admin/channels/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadChannels()}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"æ¸ é“ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.channels.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"account-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.channels,(t=>(e.openBlock(),e.createElementBlock("view",{class:"account-card",key:t.id,onClick:e=>n.editChannel(t)},[e.createElementVNode("view",{class:"card-icon"},e.toDisplayString(n.getProviderIcon(t.provider_type)),1),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"account-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"account-email"},e.toDisplayString(n.getProviderName(t.provider_type)),1),e.createElementVNode("view",{class:"account-stats"},[e.createElementVNode("view",{class:e.normalizeClass(["auth-badge",{active:1===t.status}])},e.toDisplayString(1===t.status?"æ­£å¸¸":"ç¦ç”¨"),3),e.createElementVNode("text",{class:"stat-text"},e.toDisplayString(t.domains_count||0)+" åŸŸå",1),t.remark?(e.openBlock(),e.createElementBlock("text",{key:0,class:"stat-text"},"Â· "+e.toDisplayString(t.remark),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("text",{class:"card-arrow"},"â€º")],8,["onClick"])))),128)),0===l.channels.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"â˜ï¸"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ¸ é“")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>n.showAdd&&n.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[9]||(a[9]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("scroll-view",{class:"modal-content","scroll-y":""},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.isEdit?"ç¼–è¾‘æ¸ é“":"æ·»åŠ æ¸ é“"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ¸ é“åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[1]||(a[1]=e=>l.form.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,l.form.name]])]),l.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœåŠ¡å•†"),e.createElementVNode("picker",{range:l.providers,"range-key":"name",onChange:a[2]||(a[2]=(...e)=>n.onProviderChange&&n.onProviderChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString((null==(i=l.selectedProvider)?void 0:i.name)||"è¯·é€‰æ‹©"),1)],40,["range"])])),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœåŠ¡å•†"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.getProviderName(l.form.provider_type)),1)])):e.createCommentVNode("",!0),l.selectedProvider||l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.credentialFields,(t=>(e.openBlock(),e.createElementBlock("view",{class:"form-item",key:t.key},[e.createElementVNode("text",{class:"label"},e.toDisplayString(t.label),1),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":e=>l.form.credentials[t.key]=e,placeholder:l.isEdit?"ç•™ç©ºä¸ä¿®æ”¹":t.placeholder,type:t.secret?"password":"text"},null,8,["onUpdate:modelValue","placeholder","type"]),[[e.vModelDynamic,l.form.credentials[t.key]]])])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¤‡æ³¨"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>l.form.remark=e),placeholder:"å¯é€‰"},null,512),[[e.vModelText,l.form.remark]])]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-item"},[e.createElementVNode("text",{class:"label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.form.status,onChange:a[4]||(a[4]=e=>l.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn verify",onClick:a[6]||(a[6]=(...e)=>n.handleVerify&&n.handleVerify(...e))},[e.createElementVNode("text",null,"éªŒè¯")])):e.createCommentVNode("",!0),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-btn danger",onClick:a[7]||(a[7]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[8]||(a[8]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const q=o({data:()=>({records:[],domains:[],domainOptions:[{id:0,name:"å…¨éƒ¨åŸŸå"}],filterDomain:null,loading:!1,showModal:!1,currentRecord:{},userInfo:null,editForm:{content:"",ttl:1,proxied:!1},ttlOptions:[{value:1,label:"è‡ªåŠ¨"},{value:300,label:"5åˆ†é’Ÿ"},{value:1800,label:"30åˆ†é’Ÿ"},{value:3600,label:"1å°æ—¶"},{value:86400,label:"1å¤©"}]}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadDomains(),this.loadRecords()},methods:{async loadDomains(){var e;try{const t=await P();this.domains=(null==(e=t.data)?void 0:e.domains)||[],this.domainOptions=[{id:0,name:"å…¨éƒ¨åŸŸå"},...this.domains]}catch(t){}},async loadRecords(){var e,a;this.loading=!0;try{const t={};(null==(e=this.filterDomain)?void 0:e.id)&&(t.domain_id=this.filterDomain.id);const o=await function(e={}){return l({url:"/admin/dns-records",method:"GET",data:e})}(t);this.records=(null==(a=o.data)?void 0:a.records)||[]}catch(o){t("error","at pages/admin/dns-records.vue:151","åŠ è½½DNSè®°å½•å¤±è´¥:",o)}this.loading=!1},onDomainFilter(e){this.filterDomain=this.domainOptions[e.detail.value],0===this.filterDomain.id&&(this.filterDomain=null),this.loadRecords()},editRecord(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentRecord=e,this.editForm={content:e.content,ttl:e.ttl||1,proxied:e.proxied||!1},this.showModal=!0)},onTtlChange(e){this.editForm.ttl=this.ttlOptions[e.detail.value].value},getTtlLabel(e){const t=this.ttlOptions.find((t=>t.value===e));return t?t.label:"è‡ªåŠ¨"},async handleSave(){var e,t;if(this.editForm.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentRecord.id,t={domain_id:this.currentRecord.domain_id,content:this.editForm.content,ttl:this.editForm.ttl,proxied:this.editForm.proxied},l({url:`/admin/dns-records/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadRecords()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡DNSè®°å½•å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await function(e,t={}){return l({url:`/admin/dns-records/${e}`,method:"DELETE",data:t})}(this.currentRecord.id,{domain_id:this.currentRecord.domain_id}),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadRecords()}catch(t){}}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"DNSè®°å½•ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.records.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:l.domainOptions,"range-key":"name",onChange:a[0]||(a[0]=(...e)=>n.onDomainFilter&&n.onDomainFilter(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString((null==(i=l.filterDomain)?void 0:i.name)||"å…¨éƒ¨åŸŸå"),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"record-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id,onClick:e=>n.editRecord(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["type-badge",t.type.toLowerCase()])},e.toDisplayString(t.type),3),e.createElementVNode("text",{class:"record-name"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"record-body"},[e.createElementVNode("text",{class:"record-content"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"meta-tags"},[e.createElementVNode("text",{class:"meta-tag"},"TTL: "+e.toDisplayString(1===t.ttl?"è‡ªåŠ¨":t.ttl),1),t.proxied?(e.openBlock(),e.createElementBlock("text",{key:0,class:"meta-tag proxy"},"ğŸ›¡ï¸ ä»£ç†")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0!==l.records.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¡"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— DNSè®°å½•")]))]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[7]||(a[7]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘DNSè®°å½•"),e.createElementVNode("view",{class:"detail-row"},[e.createElementVNode("text",{class:"detail-label"},"ç±»å‹"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.currentRecord.type),1)]),e.createElementVNode("view",{class:"detail-row"},[e.createElementVNode("text",{class:"detail-label"},"åç§°"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.currentRecord.name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[1]||(a[1]=e=>l.editForm.content=e),placeholder:"è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,l.editForm.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"TTL"),e.createElementVNode("picker",{range:l.ttlOptions,"range-key":"label",onChange:a[2]||(a[2]=(...e)=>n.onTtlChange&&n.onTtlChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(n.getTtlLabel(l.editForm.ttl)),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"CDNä»£ç†"),e.createElementVNode("switch",{checked:l.editForm.proxied,onChange:a[3]||(a[3]=e=>l.editForm.proxied=e.detail.value)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[4]||(a[4]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[5]||(a[5]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[6]||(a[6]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const H=o({data:()=>({subdomains:[],searchKey:"",page:1,hasMore:!0,loading:!1,showModal:!1,currentItem:{},extendDays:"",editStatus:1,userInfo:null,statusList:[{value:"",label:"å…¨éƒ¨çŠ¶æ€"},{value:0,label:"ç¦ç”¨"},{value:1,label:"æ­£å¸¸"},{value:2,label:"å¾…å®¡æ ¸"}],expiredList:[{value:"",label:"å…¨éƒ¨"},{value:"1",label:"å·²è¿‡æœŸ"},{value:"0",label:"æœªè¿‡æœŸ"}],statusOptions:[{value:0,label:"ç¦ç”¨"},{value:1,label:"æ­£å¸¸"},{value:2,label:"å¾…å®¡æ ¸"}],filterStatus:"",filterExpired:""}),computed:{currentStatusLabel(){const e=this.statusList.find((e=>e.value===this.filterStatus));return e?e.label:"å…¨éƒ¨çŠ¶æ€"},currentExpiredLabel(){const e=this.expiredList.find((e=>e.value===this.filterExpired));return e?e.label:"å…¨éƒ¨"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadData()},methods:{async loadData(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.searchKey&&(t.search=this.searchKey),""!==this.filterStatus&&(t.status=this.filterStatus),""!==this.filterExpired&&(t.expired=this.filterExpired);const o=await function(e={}){return l({url:"/admin/subdomains",method:"GET",data:e})}(t),s=(null==(e=o.data)?void 0:e.subdomains)||[];1===this.page?this.subdomains=s:this.subdomains=[...this.subdomains,...s];const n=(null==(a=o.data)?void 0:a.pagination)||{};this.hasMore=this.page<n.pages}catch(o){t("error","at pages/admin/subdomains.vue:181",o)}this.loading=!1}},doSearch(){this.page=1,this.loadData()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},onStatusChange(e){this.filterStatus=this.statusList[e.detail.value].value,this.page=1,this.loadData()},onExpiredChange(e){this.filterExpired=this.expiredList[e.detail.value].value,this.page=1,this.loadData()},getStatusClass:e=>e.is_expired?"expired":0===e.status?"disabled":2===e.status?"pending":"normal",getStatusText:e=>e.is_expired?"å·²è¿‡æœŸ":0===e.status?"ç¦ç”¨":2===e.status?"å¾…å®¡æ ¸":"æ­£å¸¸",formatDate:e=>e?e.replace("T"," ").substring(0,10):"-",showDetail(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentItem={...e},this.editStatus=e.status,this.extendDays="",this.showModal=!0)},onEditStatusChange(e){this.editStatus=this.statusOptions[e.detail.value].value},getEditStatusLabel(){const e=this.statusOptions.find((e=>e.value===this.editStatus));return e?e.label:"æ­£å¸¸"},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={status:this.editStatus};this.extendDays&&(e.extend_days=parseInt(this.extendDays)),await function(e,t){return l({url:`/admin/subdomains/${e}`,method:"PUT",data:t})}(this.currentItem.id,e),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadData()}catch(e){uni.hideLoading()}},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ ${this.currentItem.full_name} å—ï¼Ÿå°†åŒæ—¶åˆ é™¤DNSè®°å½•ï¼`,confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentItem.id,l({url:`/admin/subdomains/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadData()}catch(a){}var t}})},async handleSendEmail(){try{await(e=this.currentItem.id,l({url:`/admin/subdomains/${e}/send-expiry-email`,method:"POST"})),uni.showToast({title:"é‚®ä»¶å·²å‘é€",icon:"success"})}catch(t){}var e},handleClearDns(){uni.showModal({title:"ç¡®è®¤æ¸…ç†",content:"ç¡®å®šè¦æ¸…ç†è¯¥åŸŸåçš„æ‰€æœ‰DNSè®°å½•å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentItem.id,l({url:`/admin/subdomains/${t}/clear-dns`,method:"POST"})),uni.showToast({title:"æ¸…ç†æˆåŠŸ",icon:"success"})}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"äºŒçº§åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.subdomains.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.searchKey=e),placeholder:"æœç´¢åŸŸå",onConfirm:a[1]||(a[1]=(...e)=>n.doSearch&&n.doSearch(...e))},null,544),[[e.vModelText,l.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>n.doSearch&&n.doSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("picker",{range:l.statusList,"range-key":"label",onChange:a[3]||(a[3]=(...e)=>n.onStatusChange&&n.onStatusChange(...e))},[e.createElementVNode("view",{class:"filter-chip"},[e.createElementVNode("text",{class:"chip-text"},e.toDisplayString(n.currentStatusLabel),1),e.createElementVNode("text",{class:"chip-arrow"},"â–¼")])],40,["range"]),e.createElementVNode("picker",{range:l.expiredList,"range-key":"label",onChange:a[4]||(a[4]=(...e)=>n.onExpiredChange&&n.onExpiredChange(...e))},[e.createElementVNode("view",{class:"filter-chip"},[e.createElementVNode("text",{class:"chip-text"},e.toDisplayString(n.currentExpiredLabel),1),e.createElementVNode("text",{class:"chip-arrow"},"â–¼")])],40,["range"])]),e.createElementVNode("view",{class:"subdomain-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.subdomains,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"subdomain-card",key:t.id,onClick:e=>n.showDetail(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"subdomain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",n.getStatusClass(t)])},e.toDisplayString(n.getStatusText(t)),3)]),e.createElementVNode("view",{class:"card-info"},[e.createElementVNode("text",{class:"info-item"},"ğŸ‘¤ "+e.toDisplayString(null==(a=t.user)?void 0:a.username),1),e.createElementVNode("text",{class:"info-item"},"ğŸ“ "+e.toDisplayString(t.records_count)+" æ¡è®°å½•",1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:e.normalizeClass(["expire-tag",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":"åˆ°æœŸ: "+n.formatDate(t.expires_at)),3),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])})),128)),0!==l.subdomains.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ”—"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ•°æ®")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[5]||(a[5]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[13]||(a[13]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"åŸŸåè¯¦æƒ…"),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åŸŸå"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.currentItem.full_name),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"æ‰€å±ç”¨æˆ·"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(null==(i=l.currentItem.user)?void 0:i.username),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"çŠ¶æ€"),e.createElementVNode("picker",{range:l.statusOptions,"range-key":"label",onChange:a[6]||(a[6]=(...e)=>n.onEditStatusChange&&n.onEditStatusChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(n.getEditStatusLabel()),1)],40,["range"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"å»¶æœŸå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>l.extendDays=e),placeholder:"è¾“å…¥å¤©æ•°"},null,512),[[e.vModelText,l.extendDays]])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åˆ°æœŸæ—¶é—´"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.formatDate(l.currentItem.expires_at)),1)]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>l.showModal=!1)},"å–æ¶ˆ"),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[9]||(a[9]=(...e)=>n.handleDelete&&n.handleDelete(...e))},"åˆ é™¤"),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>n.handleSave&&n.handleSave(...e))},"ä¿å­˜")]),e.createElementVNode("view",{class:"extra-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[11]||(a[11]=(...e)=>n.handleSendEmail&&n.handleSendEmail(...e))},"å‘é€åˆ°æœŸæé†’"),e.createElementVNode("view",{class:"action-btn warning",onClick:a[12]||(a[12]=(...e)=>n.handleClearDns&&n.handleClearDns(...e))},"æ¸…ç†DNSè®°å½•")])])])):e.createCommentVNode("",!0)])}]]);const j=o({data:()=>({logs:[],page:1,hasMore:!0,loading:!1,filterAction:"",userInfo:null,actionList:[{value:"",label:"å…¨éƒ¨æ“ä½œ"},{value:"create",label:"åˆ›å»º"},{value:"update",label:"æ›´æ–°"},{value:"delete",label:"åˆ é™¤"},{value:"login",label:"ç™»å½•"}]}),computed:{currentActionLabel(){const e=this.actionList.find((e=>e.value===this.filterAction));return e?e.label:"å…¨éƒ¨æ“ä½œ"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadData()},methods:{async loadData(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.filterAction&&(t.action=this.filterAction);const o=await function(e={}){return l({url:"/admin/logs",method:"GET",data:e})}(t),s=(null==(e=o.data)?void 0:e.logs)||[];1===this.page?this.logs=s:this.logs=[...this.logs,...s];const n=(null==(a=o.data)?void 0:a.pagination)||{};this.hasMore=this.page<n.pages}catch(o){t("error","at pages/admin/logs.vue:109",o)}this.loading=!1}},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},onActionChange(e){this.filterAction=this.actionList[e.detail.value].value,this.page=1,this.loadData()},getActionText:e=>({create:"åˆ›å»º",update:"æ›´æ–°",delete:"åˆ é™¤",login:"ç™»å½•"}[e]||e),formatTime:e=>e?e.replace("T"," ").substring(0,16):"",showDeleteConfirm(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•åˆ é™¤",icon:"none"}):uni.showActionSheet({itemList:["åˆ é™¤æ­¤æ¡æ—¥å¿—"],success:async t=>{if(0===t.tapIndex)try{await(a=e.id,l({url:`/admin/logs/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.page=1,this.loadData()}catch(o){}var a}})},handleClearAll(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ¸…ç©º",icon:"none"}):uni.showModal({title:"ç¡®è®¤æ¸…ç©º",content:"ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥å¿—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t={clear_all:!0},l({url:"/admin/logs/batch-delete",method:"POST",data:t})),uni.showToast({title:"æ¸…ç©ºæˆåŠŸ",icon:"success"}),this.page=1,this.loadData()}catch(a){}var t}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"æ“ä½œæ—¥å¿—"),e.createElementVNode("view",{class:"header-action",onClick:a[0]||(a[0]=(...e)=>n.handleClearAll&&n.handleClearAll(...e))},[e.createElementVNode("text",{class:"action-text"},"æ¸…ç©º")])]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:l.actionList,"range-key":"label",onChange:a[1]||(a[1]=(...e)=>n.onActionChange&&n.onActionChange(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.currentActionLabel),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"log-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.logs,(t=>{var a,o;return e.openBlock(),e.createElementBlock("view",{class:"log-card",key:t.id,onLongpress:e=>n.showDeleteConfirm(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-avatar"},e.toDisplayString((null==(o=null==(a=t.username)?void 0:a.charAt(0))?void 0:o.toUpperCase())||"U"),1),e.createElementVNode("text",{class:"user-name"},e.toDisplayString(t.username),1)]),e.createElementVNode("view",{class:e.normalizeClass(["action-badge",t.action])},e.toDisplayString(n.getActionText(t.action)),3)]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("text",{class:"log-detail"},e.toDisplayString(t.detail),1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"log-target"},e.toDisplayString(t.target_type)+" #"+e.toDisplayString(t.target_id),1),e.createElementVNode("text",{class:"log-ip"},e.toDisplayString(t.ip_address),1),e.createElementVNode("text",{class:"log-time"},e.toDisplayString(n.formatTime(t.created_at)),1)])],40,["onLongpress"])})),128)),0!==l.logs.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“œ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ—¥å¿—")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[2]||(a[2]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0)])}]]);const Z=o({data:()=>({coupons:[],loading:!1,page:1,hasMore:!0,statusFilter:"all",typeOptions:[{label:"æŠ˜æ‰£ç™¾åˆ†æ¯”",value:"percent"},{label:"å›ºå®šé‡‘é¢",value:"fixed"}],showModal:!1,isEdit:!1,formData:{name:"",code:"",type:"percent",value:"",min_amount:"",max_discount:"",total_count:"-1",per_user_limit:"1",expires_at:""},editingId:null,showUsagesModal:!1,currentCoupon:null,usages:[],userInfo:null}),computed:{currentTypeLabel(){const e=this.typeOptions.find((e=>e.value===this.formData.type));return e?e.label:"æŠ˜æ‰£ç™¾åˆ†æ¯”"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadCoupons()},methods:{async loadCoupons(){var e,a,o;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};"active"===this.statusFilter?t.status=1:"disabled"===this.statusFilter&&(t.status=0);const s=await function(e={}){return l({url:"/admin/coupons",method:"GET",data:e})}(t),n=(null==(e=s.data)?void 0:e.coupons)||(null==(a=s.data)?void 0:a.list)||[];1===this.page?this.coupons=n:this.coupons=[...this.coupons,...n];const i=(null==(o=s.data)?void 0:o.pagination)||{};this.hasMore=this.page<(i.pages||1)}catch(s){t("error","at pages/admin/coupons.vue:245","åŠ è½½ä¼˜æƒ åˆ¸å¤±è´¥",s)}this.loading=!1}},setFilter(e){this.statusFilter=e,this.page=1,this.loadCoupons()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadCoupons())},formatTime:e=>e?e.split("T")[0]:"",onTypeChange(e){this.formData.type=this.typeOptions[e.detail.value].value},onExpiresDateChange(e){this.formData.expires_at=e.detail.value},showAddModal(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.editingId=null,this.formData={name:"",code:"",type:"percent",value:"",min_amount:"",max_discount:"",total_count:"-1",per_user_limit:"1",expires_at:""},this.showModal=!0)},editCoupon(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.editingId=e.id,this.formData={name:e.name||"",code:e.code||"",type:e.type||"percent",value:String(e.value||""),min_amount:String(e.min_amount||""),max_discount:String(e.max_discount||""),total_count:String(e.total_count??"-1"),per_user_limit:String(e.per_user_limit||"1"),expires_at:e.expires_at?e.expires_at.split("T")[0]:""},this.showModal=!0)},closeModal(){this.showModal=!1},async submitForm(){if(!this.formData.name)return void uni.showToast({title:"è¯·è¾“å…¥åç§°",icon:"none"});if(!this.formData.value)return void uni.showToast({title:"è¯·è¾“å…¥ä¼˜æƒ å€¼",icon:"none"});const e={name:this.formData.name,type:this.formData.type,value:parseFloat(this.formData.value)};!this.isEdit&&this.formData.code&&(e.code=this.formData.code),this.formData.min_amount&&(e.min_amount=parseFloat(this.formData.min_amount)),this.formData.max_discount&&(e.max_discount=parseFloat(this.formData.max_discount)),this.formData.total_count&&(e.total_count=parseInt(this.formData.total_count)),this.formData.per_user_limit&&(e.per_user_limit=parseInt(this.formData.per_user_limit)),this.formData.expires_at&&(e.expires_at=this.formData.expires_at+"T23:59:59Z");try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),this.isEdit?await function(e,t){return l({url:`/admin/coupons/${e}`,method:"PUT",data:t})}(this.editingId,e):await function(e){return l({url:"/admin/coupons",method:"POST",data:e})}(e),uni.hideLoading(),uni.showToast({title:this.isEdit?"æ›´æ–°æˆåŠŸ":"åˆ›å»ºæˆåŠŸ",icon:"success"}),this.closeModal(),this.page=1,this.loadCoupons()}catch(a){uni.hideLoading(),t("error","at pages/admin/coupons.vue:362","ä¿å­˜å¤±è´¥",a)}},deleteCouponConfirm(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•åˆ é™¤",icon:"none"}):uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ä¼˜æƒ åˆ¸ "${e.code}" å—ï¼Ÿ`,success:async a=>{if(a.confirm)try{await(o=e.id,l({url:`/admin/coupons/${o}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.page=1,this.loadCoupons()}catch(s){t("error","at pages/admin/coupons.vue:381","åˆ é™¤å¤±è´¥",s)}var o}})},async viewUsages(e){var a,o,s;this.currentCoupon=e,this.usages=[],this.showUsagesModal=!0;try{const t=await(s=e.id,l({url:`/admin/coupons/${s}/usages`,method:"GET"}));this.usages=(null==(a=t.data)?void 0:a.usages)||(null==(o=t.data)?void 0:o.list)||[]}catch(n){t("error","at pages/admin/coupons.vue:396","åŠ è½½ä½¿ç”¨è®°å½•å¤±è´¥",n)}},closeUsagesModal(){this.showUsagesModal=!1,this.currentCoupon=null,this.usages=[]},copyCode(e){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"ä¼˜æƒ ç å·²å¤åˆ¶",icon:"success"})}})}}},[["render",function(t,a,o,s,l,n){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ä¼˜æƒ åˆ¸ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.coupons.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"all"===l.statusFilter}]),onClick:a[0]||(a[0]=e=>n.setFilter("all"))},[e.createElementVNode("text",{class:"filter-text"},"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"active"===l.statusFilter}]),onClick:a[1]||(a[1]=e=>n.setFilter("active"))},[e.createElementVNode("text",{class:"filter-text"},"æœ‰æ•ˆ")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"disabled"===l.statusFilter}]),onClick:a[2]||(a[2]=e=>n.setFilter("disabled"))},[e.createElementVNode("text",{class:"filter-text"},"å·²ç¦ç”¨")],2)])]),e.createElementVNode("view",{class:"coupon-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.coupons,(t=>(e.openBlock(),e.createElementBlock("view",{class:"coupon-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["coupon-badge",{disabled:1!==t.status}])},e.toDisplayString(1===t.status?"æœ‰æ•ˆ":"å·²ç¦ç”¨"),3),e.createElementVNode("text",{class:"coupon-value"},e.toDisplayString("percent"===t.type?t.value+"%æŠ˜æ‰£":"Â¥"+t.value),1)]),e.createElementVNode("view",{class:"coupon-body",onClick:e=>n.copyCode(t.code)},[e.createElementVNode("text",{class:"coupon-code"},e.toDisplayString(t.code),1),e.createElementVNode("text",{class:"copy-btn"},"ğŸ“‹")],8,["onClick"]),e.createElementVNode("view",{class:"coupon-info"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"åç§°"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"æœ€ä½æ¶ˆè´¹"),e.createElementVNode("text",{class:"info-value"},"Â¥"+e.toDisplayString(t.min_amount||0),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"ä½¿ç”¨æ¬¡æ•°"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.used_count||0)+" / "+e.toDisplayString(-1===t.total_count?"æ— é™":t.total_count),1)]),t.expires_at?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"è¿‡æœŸæ—¶é—´"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.formatTime(t.expires_at)),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"action-btn",onClick:e=>n.viewUsages(t)},[e.createElementVNode("text",null,"ä½¿ç”¨è®°å½•")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn",onClick:e=>n.editCoupon(t)},[e.createElementVNode("text",null,"ç¼–è¾‘")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn danger",onClick:e=>n.deleteCouponConfirm(t)},[e.createElementVNode("text",null,"åˆ é™¤")],8,["onClick"])])])))),128)),0!==l.coupons.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ä¼˜æƒ åˆ¸")]))]),l.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>n.loadMore&&n.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fab",onClick:a[4]||(a[4]=(...e)=>n.showAddModal&&n.showAddModal(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[16]||(a[16]=e.withModifiers(((...e)=>n.closeModal&&n.closeModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.isEdit?"ç¼–è¾‘ä¼˜æƒ åˆ¸":"åˆ›å»ºä¼˜æƒ åˆ¸"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>l.formData.name=e),placeholder:"ä¼˜æƒ åˆ¸åç§°"},null,512),[[e.vModelText,l.formData.name]])]),l.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä¼˜æƒ ç "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[6]||(a[6]=e=>l.formData.code=e),placeholder:"ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ"},null,512),[[e.vModelText,l.formData.code]])])),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("picker",{range:l.typeOptions,"range-key":"label",onChange:a[7]||(a[7]=(...e)=>n.onTypeChange&&n.onTypeChange(...e))},[e.createElementVNode("view",{class:"picker-input"},e.toDisplayString(n.currentTypeLabel),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä¼˜æƒ å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[8]||(a[8]=e=>l.formData.value=e),placeholder:"percent"===l.formData.type?"å¦‚10è¡¨ç¤º9æŠ˜":"å›ºå®šé‡‘é¢"},null,8,["placeholder"]),[[e.vModelText,l.formData.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€ä½æ¶ˆè´¹"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[9]||(a[9]=e=>l.formData.min_amount=e),placeholder:"0æ— é™åˆ¶"},null,512),[[e.vModelText,l.formData.min_amount]])]),"percent"===l.formData.type?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§ä¼˜æƒ "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[10]||(a[10]=e=>l.formData.max_discount=e),placeholder:"ç•™ç©ºæ— é™åˆ¶"},null,512),[[e.vModelText,l.formData.max_discount]])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ€»æ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[11]||(a[11]=e=>l.formData.total_count=e),placeholder:"-1æ— é™"},null,512),[[e.vModelText,l.formData.total_count]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ¯äººé™ç”¨"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[12]||(a[12]=e=>l.formData.per_user_limit=e),placeholder:"é»˜è®¤1"},null,512),[[e.vModelText,l.formData.per_user_limit]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è¿‡æœŸæ—¶é—´"),e.createElementVNode("picker",{mode:"date",onChange:a[13]||(a[13]=(...e)=>n.onExpiresDateChange&&n.onExpiresDateChange(...e))},[e.createElementVNode("view",{class:"picker-input"},e.toDisplayString(l.formData.expires_at||"æ°¸ä¸è¿‡æœŸ"),1)],32)]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=(...e)=>n.closeModal&&n.closeModal(...e))},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[15]||(a[15]=(...e)=>n.submitForm&&n.submitForm(...e))},[e.createElementVNode("text",null,e.toDisplayString(l.isEdit?"ä¿å­˜":"åˆ›å»º"),1)])])])])):e.createCommentVNode("",!0),l.showUsagesModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[18]||(a[18]=e.withModifiers(((...e)=>n.closeUsagesModal&&n.closeUsagesModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä½¿ç”¨è®°å½• - "+e.toDisplayString(null==(i=l.currentCoupon)?void 0:i.code),1),l.usages.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"usage-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.usages,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"usage-item",key:t.id},[e.createElementVNode("text",{class:"usage-user"},e.toDisplayString((null==(a=t.user)?void 0:a.email)||"æœªçŸ¥ç”¨æˆ·"),1),e.createElementVNode("text",{class:"usage-amount"},"-Â¥"+e.toDisplayString(t.discount_amount),1),e.createElementVNode("text",{class:"usage-time"},e.toDisplayString(n.formatTime(t.created_at)),1)])})),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state small"},[e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ä½¿ç”¨è®°å½•")])),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[17]||(a[17]=(...e)=>n.closeUsagesModal&&n.closeUsagesModal(...e))},[e.createElementVNode("text",null,"å…³é—­")])])])])):e.createCommentVNode("",!0)])}]]);const W=o({data:()=>({versions:[],currentPlatform:"",showModal:!1,isEdit:!1,currentId:null,userInfo:null,form:{platform:"android",version:"",build:"",download_url:"",file_size:"",update_log:"",force_update:!1,min_version:"",status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p(),this.loadVersions()},methods:{async loadVersions(){var e;try{const t={};this.currentPlatform&&(t.platform=this.currentPlatform);const a=await function(e={}){return l({url:"/admin/app-versions",method:"GET",data:e})}(t);this.versions=(null==(e=a.data)?void 0:e.versions)||[]}catch(a){t("error","at pages/admin/app-versions.vue:191","åŠ è½½ç‰ˆæœ¬åˆ—è¡¨å¤±è´¥",a)}},filterPlatform(e){this.currentPlatform=e,this.loadVersions()},formatTime:e=>e?e.split("T")[0]:"",showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.form={platform:"android",version:"",build:"",download_url:"",file_size:"",update_log:"",force_update:!1,min_version:"",status:1},this.showModal=!0)},editVersion(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.form={platform:e.platform,version:e.version,build:String(e.build),download_url:e.download_url,file_size:e.file_size||"",update_log:e.update_log||"",force_update:e.force_update||!1,min_version:e.min_version||"",status:e.status},this.showModal=!0)},async handleSave(){if(this.form.platform&&this.form.version&&this.form.build&&this.form.download_url)if(/^\d+(\.\d+)*$/.test(this.form.version))try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={...this.form,build:parseInt(this.form.build)};this.isEdit?await function(e,t){return l({url:`/admin/app-versions/${e}`,method:"PUT",data:t})}(this.currentId,e):await function(e){return l({url:"/admin/app-versions",method:"POST",data:e})}(e),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadVersions()}catch(e){uni.hideLoading(),t("error","at pages/admin/app-versions.vue:272","ä¿å­˜å¤±è´¥",e)}else uni.showToast({title:"ç‰ˆæœ¬å·æ ¼å¼é”™è¯¯",icon:"none"});else uni.showToast({title:"è¯·å¡«å†™å¿…å¡«é¡¹",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç‰ˆæœ¬å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(a=this.currentId,l({url:`/admin/app-versions/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadVersions()}catch(o){t("error","at pages/admin/app-versions.vue:288","åˆ é™¤å¤±è´¥",o)}var a}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"APPç‰ˆæœ¬ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(l.versions.length)+" ä¸ªç‰ˆæœ¬",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:""===l.currentPlatform}]),onClick:a[0]||(a[0]=e=>n.filterPlatform(""))},[e.createElementVNode("text",null,"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"android"===l.currentPlatform}]),onClick:a[1]||(a[1]=e=>n.filterPlatform("android"))},[e.createElementVNode("text",null,"ğŸ¤– Android")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"ios"===l.currentPlatform}]),onClick:a[2]||(a[2]=e=>n.filterPlatform("ios"))},[e.createElementVNode("text",null,"ğŸ iOS")],2)])]),e.createElementVNode("view",{class:"version-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.versions,(t=>(e.openBlock(),e.createElementBlock("view",{class:"version-card",key:t.id,onClick:e=>n.editVersion(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["platform-badge",t.platform])},[e.createElementVNode("text",null,e.toDisplayString("android"===t.platform?"ğŸ¤–":"ğŸ"),1),e.createElementVNode("text",null,e.toDisplayString("android"===t.platform?"Android":"iOS"),1)],2),e.createElementVNode("view",{class:"tag-row"},[t.force_update?(e.openBlock(),e.createElementBlock("view",{key:0,class:"force-tag"},"å¼ºåˆ¶æ›´æ–°")):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å·²å‘å¸ƒ":"å·²ç¦ç”¨"),3)])]),e.createElementVNode("view",{class:"version-info"},[e.createElementVNode("view",{class:"version-main"},[e.createElementVNode("text",{class:"version-number"},"v"+e.toDisplayString(t.version),1),e.createElementVNode("text",{class:"build-number"},"Build "+e.toDisplayString(t.build),1)]),e.createElementVNode("view",{class:"version-meta"},[t.file_size?(e.openBlock(),e.createElementBlock("text",{key:0,class:"meta-item"},"ğŸ“¦ "+e.toDisplayString(t.file_size),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"meta-item"},"ğŸ“¥ "+e.toDisplayString(t.download_count||0)+" æ¬¡ä¸‹è½½",1)])]),t.update_log?(e.openBlock(),e.createElementBlock("view",{key:0,class:"update-log"},[e.createElementVNode("text",{class:"log-text"},e.toDisplayString(t.update_log),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(n.formatTime(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0===l.versions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“±"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ç‰ˆæœ¬")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[3]||(a[3]=(...e)=>n.showAdd&&n.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),l.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[17]||(a[17]=e.withModifiers((e=>l.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(l.isEdit?"ç¼–è¾‘ç‰ˆæœ¬":"æ·»åŠ ç‰ˆæœ¬"),1),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("å¹³å° "),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"platform-select"},[e.createElementVNode("view",{class:e.normalizeClass(["platform-option",{active:"android"===l.form.platform}]),onClick:a[4]||(a[4]=e=>l.form.platform="android")},[e.createElementVNode("text",null,"ğŸ¤– Android")],2),e.createElementVNode("view",{class:e.normalizeClass(["platform-option",{active:"ios"===l.form.platform}]),onClick:a[5]||(a[5]=e=>l.form.platform="ios")},[e.createElementVNode("text",null,"ğŸ iOS")],2)])]),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-item column half"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("ç‰ˆæœ¬å· "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[6]||(a[6]=e=>l.form.version=e),placeholder:"å¦‚ 1.0.0"},null,512),[[e.vModelText,l.form.version]])]),e.createElementVNode("view",{class:"form-item column half"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("æ„å»ºå· "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>l.form.build=e),placeholder:"å¦‚ 1"},null,512),[[e.vModelText,l.form.build]])])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("ä¸‹è½½åœ°å€ "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[8]||(a[8]=e=>l.form.download_url=e),placeholder:"è¾“å…¥ä¸‹è½½é“¾æ¥"},null,512),[[e.vModelText,l.form.download_url]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ–‡ä»¶å¤§å°"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[9]||(a[9]=e=>l.form.file_size=e),placeholder:"å¦‚ 15.2 MB"},null,512),[[e.vModelText,l.form.file_size]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æœ€ä½æ”¯æŒç‰ˆæœ¬"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[10]||(a[10]=e=>l.form.min_version=e),placeholder:"ä½äºæ­¤ç‰ˆæœ¬å°†å¼ºåˆ¶æ›´æ–°"},null,512),[[e.vModelText,l.form.min_version]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ›´æ–°æ—¥å¿—"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[11]||(a[11]=e=>l.form.update_log=e),placeholder:"è¾“å…¥æ›´æ–°å†…å®¹"},null,512),[[e.vModelText,l.form.update_log]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¼ºåˆ¶æ›´æ–°"),e.createElementVNode("switch",{checked:l.form.force_update,onChange:a[12]||(a[12]=e=>l.form.force_update=e.detail.value)},null,40,["checked"])]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"å‘å¸ƒçŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.form.status,onChange:a[13]||(a[13]=e=>l.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=e=>l.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),l.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[15]||(a[15]=(...e)=>n.handleDelete&&n.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[16]||(a[16]=(...e)=>n.handleSave&&n.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const J=o({data:()=>({loading:!1,templates:[],showEditModal:!1,showPreviewModal:!1,editForm:{code:"",name:"",subject:"",content:"",status:1,variables:{}},previewData:{subject:"",html:""}}),onLoad(){this.loadTemplates()},methods:{formatVariable:e=>"{{"+e+"}}",async loadTemplates(){var e;this.loading=!0,uni.showLoading({title:"åŠ è½½ä¸­..."});try{const t=await l({url:"/admin/email-templates",method:"GET"});this.templates=(null==(e=t.data)?void 0:e.list)||[]}catch(a){t("error","at pages/admin/email-templates.vue:172","åŠ è½½æ¨¡æ¿å¤±è´¥",a)}uni.hideLoading(),this.loading=!1},editTemplate(e){this.editForm={code:e.code,name:e.name,subject:e.subject,content:e.content,status:e.status,variables:e.variables||{}},this.showEditModal=!0},async saveTemplate(){var e,t;if(this.editForm.subject)if(this.editForm.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.editForm.code,t={subject:this.editForm.subject,content:this.editForm.content,status:this.editForm.status},l({url:`/admin/email-templates/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showEditModal=!1,this.loadTemplates()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥é‚®ä»¶å†…å®¹",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ä»¶ä¸»é¢˜",icon:"none"})},async previewTemplate(){var e,t,a,o;if(this.editForm.subject&&this.editForm.content)try{uni.showLoading({title:"ç”Ÿæˆé¢„è§ˆ..."});const s=await(a=this.editForm.code,o={subject:this.editForm.subject,content:this.editForm.content},l({url:`/admin/email-templates/${a}/preview`,method:"POST",data:o}));uni.hideLoading(),this.previewData={subject:(null==(e=s.data)?void 0:e.subject)||"",html:(null==(t=s.data)?void 0:t.html)||""},this.showPreviewModal=!0}catch(s){uni.hideLoading()}else uni.showToast({title:"è¯·å…ˆå¡«å†™ä¸»é¢˜å’Œå†…å®¹",icon:"none"})},async sendTest(e){uni.showModal({title:"å‘é€æµ‹è¯•é‚®ä»¶",content:"å°†å‘é€æµ‹è¯•é‚®ä»¶åˆ°ç®¡ç†å‘˜é‚®ç®±ï¼Œç¡®å®šç»§ç»­ï¼Ÿ",success:async t=>{if(t.confirm)try{uni.showLoading({title:"å‘é€ä¸­..."}),await function(e){return l({url:`/admin/email-templates/${e}/test`,method:"POST"})}(e),uni.hideLoading(),uni.showToast({title:"æµ‹è¯•é‚®ä»¶å·²å‘é€",icon:"success"})}catch(a){uni.hideLoading()}}})},resetTemplate(e){uni.showModal({title:"é‡ç½®æ¨¡æ¿",content:"ç¡®å®šè¦é‡ç½®ä¸ºé»˜è®¤æ¨¡æ¿å—ï¼Ÿè‡ªå®šä¹‰å†…å®¹å°†ä¸¢å¤±ã€‚",success:async t=>{if(t.confirm)try{uni.showLoading({title:"é‡ç½®ä¸­..."}),await function(e){return l({url:`/admin/email-templates/${e}/reset`,method:"POST"})}(e),uni.hideLoading(),uni.showToast({title:"å·²é‡ç½®",icon:"success"}),this.loadTemplates()}catch(a){uni.hideLoading()}}})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"é‚®ä»¶æ¨¡æ¿ç®¡ç†"),e.createElementVNode("text",{class:"header-subtitle"},"è‡ªå®šä¹‰ç³»ç»Ÿé‚®ä»¶å†…å®¹")]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"template-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.templates,(t=>(e.openBlock(),e.createElementBlock("view",{class:"template-card",key:t.code,onClick:e=>n.editTemplate(t)},[e.createElementVNode("view",{class:"template-header"},[e.createElementVNode("text",{class:"template-name"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:e.normalizeClass(["template-status",1===t.status?"enabled":"disabled"])},[e.createElementVNode("text",null,e.toDisplayString(1===t.status?"å¯ç”¨":"ç¦ç”¨"),1)],2)]),e.createElementVNode("view",{class:"template-info"},[e.createElementVNode("text",{class:"template-code"},e.toDisplayString(t.code),1),t.is_default?(e.openBlock(),e.createElementBlock("text",{key:0,class:"template-default"},"é»˜è®¤æ¨¡æ¿")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"template-subject"},[e.createElementVNode("text",{class:"subject-label"},"ä¸»é¢˜ï¼š"),e.createElementVNode("text",{class:"subject-text"},e.toDisplayString(t.subject),1)]),e.createElementVNode("view",{class:"template-actions"},[e.createElementVNode("view",{class:"action-btn edit",onClick:e.withModifiers((e=>n.editTemplate(t)),["stop"])},[e.createElementVNode("text",null,"ç¼–è¾‘")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn test",onClick:e.withModifiers((e=>n.sendTest(t.code)),["stop"])},[e.createElementVNode("text",null,"æµ‹è¯•")],8,["onClick"]),t.is_default?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-btn reset",onClick:e.withModifiers((e=>n.resetTemplate(t.code)),["stop"])},[e.createElementVNode("text",null,"é‡ç½®")],8,["onClick"]))])],8,["onClick"])))),128))]),0!==l.templates.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“§"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— é‚®ä»¶æ¨¡æ¿")]))]),l.showEditModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[7]||(a[7]=e.withModifiers((e=>l.showEditModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content large"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘é‚®ä»¶æ¨¡æ¿"),e.createElementVNode("text",{class:"modal-close",onClick:a[0]||(a[0]=e=>l.showEditModal=!1)},"Ã—")]),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"æ¨¡æ¿åç§°"),e.createElementVNode("text",{class:"form-value"},e.toDisplayString(l.editForm.name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"æ¨¡æ¿ä»£ç "),e.createElementVNode("text",{class:"form-value code"},e.toDisplayString(l.editForm.code),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===l.editForm.status,onChange:a[1]||(a[1]=e=>l.editForm.status=e.detail.value?1:0),color:"#4C84FF"},null,40,["checked"])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"form-label"},"é‚®ä»¶ä¸»é¢˜"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>l.editForm.subject=e),placeholder:"è¯·è¾“å…¥é‚®ä»¶ä¸»é¢˜"},null,512),[[e.vModelText,l.editForm.subject]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"form-label"},"é‚®ä»¶å†…å®¹ (æ”¯æŒ HTML)"),e.withDirectives(e.createElementVNode("textarea",{class:"form-textarea","onUpdate:modelValue":a[3]||(a[3]=e=>l.editForm.content=e),placeholder:"è¯·è¾“å…¥é‚®ä»¶å†…å®¹"},null,512),[[e.vModelText,l.editForm.content]])]),l.editForm.variables?(e.openBlock(),e.createElementBlock("view",{key:0,class:"variables-section"},[e.createElementVNode("text",{class:"variables-title"},"å¯ç”¨å˜é‡"),e.createElementVNode("view",{class:"variables-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.editForm.variables,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"variable-item",key:a},[e.createElementVNode("text",{class:"variable-key"},e.toDisplayString(n.formatVariable(a)),1),e.createElementVNode("text",{class:"variable-desc"},e.toDisplayString(t),1)])))),128))])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("view",{class:"footer-btn preview",onClick:a[4]||(a[4]=(...e)=>n.previewTemplate&&n.previewTemplate(...e))},[e.createElementVNode("text",null,"é¢„è§ˆ")]),e.createElementVNode("view",{class:"footer-btn cancel",onClick:a[5]||(a[5]=e=>l.showEditModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"footer-btn confirm",onClick:a[6]||(a[6]=(...e)=>n.saveTemplate&&n.saveTemplate(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0),l.showPreviewModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[10]||(a[10]=e.withModifiers((e=>l.showPreviewModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content large"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"é‚®ä»¶é¢„è§ˆ"),e.createElementVNode("text",{class:"modal-close",onClick:a[8]||(a[8]=e=>l.showPreviewModal=!1)},"Ã—")]),e.createElementVNode("view",{class:"preview-section"},[e.createElementVNode("view",{class:"preview-subject"},[e.createElementVNode("text",{class:"preview-label"},"ä¸»é¢˜ï¼š"),e.createElementVNode("text",{class:"preview-text"},e.toDisplayString(l.previewData.subject),1)]),e.createElementVNode("view",{class:"preview-content"},[e.createElementVNode("rich-text",{nodes:l.previewData.html},null,8,["nodes"])])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("view",{class:"footer-btn confirm",onClick:a[9]||(a[9]=e=>l.showPreviewModal=!1)},[e.createElementVNode("text",null,"å…³é—­")])])])])):e.createCommentVNode("",!0)])}]]);const X=o({data:()=>({loading:!1,searchKey:"",list:[],pagination:{page:1,per_page:20,total:0,pages:0},showAddModal:!1,showCheckModal:!1,addForm:{ip_address:"",reason:"",duration_days:""},checkIp:"",checkResult:null}),onLoad(){this.loadList()},methods:{async loadList(){var e,a,o;this.loading=!0,uni.showLoading({title:"åŠ è½½ä¸­..."});try{const t=await function(e={}){return l({url:"/admin/ip-blacklist",method:"GET",data:e})}({page:this.pagination.page,per_page:this.pagination.per_page,search:this.searchKey});this.list=(null==(e=t.data)?void 0:e.list)||(null==(a=t.data)?void 0:a.blacklist)||[],(null==(o=t.data)?void 0:o.pagination)&&(this.pagination={...this.pagination,...t.data.pagination})}catch(s){t("error","at pages/admin/ip-blacklist.vue:168","åŠ è½½å¤±è´¥",s)}uni.hideLoading(),this.loading=!1},isExpired:e=>!!e.expires_at&&new Date(e.expires_at)<new Date,changePage(e){e<1||e>this.pagination.pages||(this.pagination.page=e,this.loadList())},async addIp(){if(this.addForm.ip_address)try{uni.showLoading({title:"æ·»åŠ ä¸­..."});const e={ip_address:this.addForm.ip_address,reason:this.addForm.reason||void 0,duration_days:this.addForm.duration_days?parseInt(this.addForm.duration_days):void 0};await function(e){return l({url:"/admin/ip-blacklist",method:"POST",data:e})}(e),uni.hideLoading(),uni.showToast({title:"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showAddModal=!1,this.addForm={ip_address:"",reason:"",duration_days:""},this.loadList()}catch(e){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥ IP åœ°å€",icon:"none"})},removeIp(e){uni.showModal({title:"è§£é™¤å°ç¦",content:`ç¡®å®šè¦è§£é™¤ ${e.ip_address} çš„å°ç¦å—ï¼Ÿ`,success:async t=>{if(t.confirm)try{uni.showLoading({title:"å¤„ç†ä¸­..."}),await(a=e.id,l({url:`/admin/ip-blacklist/${a}`,method:"DELETE"})),uni.hideLoading(),uni.showToast({title:"å·²è§£é™¤",icon:"success"}),this.loadList()}catch(o){uni.hideLoading()}var a}})},async checkIpStatus(){var e,t;if(this.checkIp)try{uni.showLoading({title:"æ£€æŸ¥ä¸­..."});const a=await(t=this.checkIp,l({url:"/admin/ip-blacklist/check",method:"GET",data:{ip:t}}));uni.hideLoading(),this.checkResult=(null==(e=a.data)?void 0:e.blocked)||!1}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥ IP åœ°å€",icon:"none"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"IP é»‘åå•"),e.createElementVNode("text",{class:"header-subtitle"},"ç®¡ç†è¢«å°ç¦çš„ IP åœ°å€")]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"toolbar"},[e.createElementVNode("view",{class:"search-box"},[e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.searchKey=e),placeholder:"æœç´¢ IP åœ°å€",onConfirm:a[1]||(a[1]=(...e)=>n.loadList&&n.loadList(...e))},null,544),[[e.vModelText,l.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>n.loadList&&n.loadList(...e))},[e.createElementVNode("text",null,"ğŸ”")])]),e.createElementVNode("view",{class:"add-btn",onClick:a[3]||(a[3]=e=>l.showAddModal=!0)},[e.createElementVNode("text",null,"+ æ·»åŠ ")])]),e.createElementVNode("view",{class:"ip-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.list,(t=>(e.openBlock(),e.createElementBlock("view",{class:"ip-card",key:t.id},[e.createElementVNode("view",{class:"ip-main"},[e.createElementVNode("text",{class:"ip-address"},e.toDisplayString(t.ip_address),1),e.createElementVNode("view",{class:e.normalizeClass(["ip-status",n.isExpired(t)?"expired":"active"])},[e.createElementVNode("text",null,e.toDisplayString(n.isExpired(t)?"å·²è¿‡æœŸ":"ç”Ÿæ•ˆä¸­"),1)],2)]),e.createElementVNode("view",{class:"ip-info"},[t.reason?(e.openBlock(),e.createElementBlock("text",{key:0,class:"ip-reason"},"åŸå› ï¼š"+e.toDisplayString(t.reason),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"ip-time"},"å°ç¦æ—¶é—´ï¼š"+e.toDisplayString(t.created_at),1),t.expires_at?(e.openBlock(),e.createElementBlock("text",{key:1,class:"ip-expire"},"åˆ°æœŸæ—¶é—´ï¼š"+e.toDisplayString(t.expires_at),1)):(e.openBlock(),e.createElementBlock("text",{key:2,class:"ip-expire"},"æ°¸ä¹…å°ç¦"))]),e.createElementVNode("view",{class:"ip-actions"},[e.createElementVNode("view",{class:"action-btn danger",onClick:e=>n.removeIp(t)},[e.createElementVNode("text",null,"è§£é™¤å°ç¦")],8,["onClick"])])])))),128))]),0!==l.list.length||l.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ›¡ï¸"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— é»‘åå•è®°å½•")])),l.pagination.pages>1?(e.openBlock(),e.createElementBlock("view",{key:1,class:"pagination"},[e.createElementVNode("view",{class:e.normalizeClass(["page-btn",{disabled:l.pagination.page<=1}]),onClick:a[4]||(a[4]=e=>n.changePage(l.pagination.page-1))},[e.createElementVNode("text",null,"ä¸Šä¸€é¡µ")],2),e.createElementVNode("text",{class:"page-info"},e.toDisplayString(l.pagination.page)+" / "+e.toDisplayString(l.pagination.pages),1),e.createElementVNode("view",{class:e.normalizeClass(["page-btn",{disabled:l.pagination.page>=l.pagination.pages}]),onClick:a[5]||(a[5]=e=>n.changePage(l.pagination.page+1))},[e.createElementVNode("text",null,"ä¸‹ä¸€é¡µ")],2)])):e.createCommentVNode("",!0)]),l.showAddModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[11]||(a[11]=e.withModifiers((e=>l.showAddModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"æ·»åŠ  IP åˆ°é»‘åå•"),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"form-label"},"IP åœ°å€ *"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[6]||(a[6]=e=>l.addForm.ip_address=e),placeholder:"å¦‚ï¼š192.168.1.1"},null,512),[[e.vModelText,l.addForm.ip_address]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"form-label"},"å°ç¦åŸå› "),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[7]||(a[7]=e=>l.addForm.reason=e),placeholder:"å¯é€‰ï¼Œå¡«å†™å°ç¦åŸå› "},null,512),[[e.vModelText,l.addForm.reason]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"form-label"},"å°ç¦å¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":a[8]||(a[8]=e=>l.addForm.duration_days=e),placeholder:"ç•™ç©ºä¸ºæ°¸ä¹…å°ç¦"},null,512),[[e.vModelText,l.addForm.duration_days]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[9]||(a[9]=e=>l.showAddModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>n.addIp&&n.addIp(...e))},[e.createElementVNode("text",null,"ç¡®è®¤æ·»åŠ ")])])])])):e.createCommentVNode("",!0),l.showCheckModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[15]||(a[15]=e.withModifiers((e=>l.showCheckModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"æ£€æŸ¥ IP çŠ¶æ€"),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"form-label"},"IP åœ°å€"),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":a[12]||(a[12]=e=>l.checkIp=e),placeholder:"è¾“å…¥è¦æ£€æŸ¥çš„ IP"},null,512),[[e.vModelText,l.checkIp]])]),null!==l.checkResult?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check-result"},[e.createElementVNode("text",{class:e.normalizeClass(["result-text",l.checkResult?"blocked":"normal"])},e.toDisplayString(l.checkResult?"â›” è¯¥ IP å·²è¢«å°ç¦":"âœ… è¯¥ IP æœªè¢«å°ç¦"),3)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[13]||(a[13]=e=>l.showCheckModal=!1)},[e.createElementVNode("text",null,"å…³é—­")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[14]||(a[14]=(...e)=>n.checkIpStatus&&n.checkIpStatus(...e))},[e.createElementVNode("text",null,"æ£€æŸ¥")])])])])):e.createCommentVNode("",!0)])}]]);const Y=o({data:()=>({userInfo:null,showUserModal:!1,showRedeemModal:!1,importUserData:"",importRedeemData:"",defaultPassword:""}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=p()},methods:{async handleExportUsers(){var e;try{uni.showLoading({title:"å¯¼å‡ºä¸­..."});const t=await l({url:"/admin/export/users",method:"GET"});uni.hideLoading(),this.downloadCsv((null==(e=t.data)?void 0:e.csv)||t.data,"users.csv")}catch(t){uni.hideLoading()}},async handleExportSubdomains(){var e;try{uni.showLoading({title:"å¯¼å‡ºä¸­..."});const t=await l({url:"/admin/export/subdomains",method:"GET"});uni.hideLoading(),this.downloadCsv((null==(e=t.data)?void 0:e.csv)||t.data,"subdomains.csv")}catch(t){uni.hideLoading()}},async handleExportRedeemCodes(){var e;try{uni.showLoading({title:"å¯¼å‡ºä¸­..."});const t=await function(e={}){return l({url:"/admin/redeem-codes/export",method:"GET",data:e})}();uni.hideLoading(),this.downloadCsv((null==(e=t.data)?void 0:e.csv)||t.data,"redeem-codes.csv")}catch(t){uni.hideLoading()}},downloadCsv(e,t){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",icon:"success"})}})},showImportUsers(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•å¯¼å…¥",icon:"none"}):(this.importUserData="",this.defaultPassword="",this.showUserModal=!0)},showImportRedeemCodes(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•å¯¼å…¥",icon:"none"}):(this.importRedeemData="",this.showRedeemModal=!0)},async handleImportUsers(){var e,t;if(this.importUserData.trim())try{uni.showLoading({title:"å¯¼å…¥ä¸­..."});const a=await(t={csv_content:this.importUserData,default_password:this.defaultPassword||"123456"},l({url:"/admin/import/users",method:"POST",data:t}));uni.hideLoading();const o=(null==(e=a.data)?void 0:e.imported_count)||0;uni.showToast({title:`æˆåŠŸå¯¼å…¥ ${o} æ¡`,icon:"success"}),this.showUserModal=!1}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥ CSV æ•°æ®",icon:"none"})},async handleImportRedeemCodes(){var e,t;if(this.importRedeemData.trim())try{uni.showLoading({title:"å¯¼å…¥ä¸­..."});const a=await(t={csv_content:this.importRedeemData},l({url:"/admin/import/redeem-codes",method:"POST",data:t}));uni.hideLoading();const o=(null==(e=a.data)?void 0:e.imported_count)||0;uni.showToast({title:`æˆåŠŸå¯¼å…¥ ${o} æ¡`,icon:"success"}),this.showRedeemModal=!1}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥ CSV æ•°æ®",icon:"none"})}}},[["render",function(t,a,o,s,l,n){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"æ•°æ®ç®¡ç†"),e.createElementVNode("text",{class:"header-subtitle"},"å¯¼å…¥å¯¼å‡ºç³»ç»Ÿæ•°æ®")]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“¤ æ•°æ®å¯¼å‡º")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"export-item",onClick:a[0]||(a[0]=(...e)=>n.handleExportUsers&&n.handleExportUsers(...e))},[e.createElementVNode("view",{class:"export-icon"},"ğŸ‘¥"),e.createElementVNode("view",{class:"export-info"},[e.createElementVNode("text",{class:"export-name"},"å¯¼å‡ºç”¨æˆ·æ•°æ®"),e.createElementVNode("text",{class:"export-desc"},"å¯¼å‡ºæ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ä¸º CSV æ ¼å¼")]),e.createElementVNode("text",{class:"export-arrow"},"â€º")]),e.createElementVNode("view",{class:"export-item",onClick:a[1]||(a[1]=(...e)=>n.handleExportSubdomains&&n.handleExportSubdomains(...e))},[e.createElementVNode("view",{class:"export-icon"},"ğŸ”—"),e.createElementVNode("view",{class:"export-info"},[e.createElementVNode("text",{class:"export-name"},"å¯¼å‡ºäºŒçº§åŸŸå"),e.createElementVNode("text",{class:"export-desc"},"å¯¼å‡ºæ‰€æœ‰äºŒçº§åŸŸåæ•°æ®ä¸º CSV æ ¼å¼")]),e.createElementVNode("text",{class:"export-arrow"},"â€º")]),e.createElementVNode("view",{class:"export-item",onClick:a[2]||(a[2]=(...e)=>n.handleExportRedeemCodes&&n.handleExportRedeemCodes(...e))},[e.createElementVNode("view",{class:"export-icon"},"ğŸ«"),e.createElementVNode("view",{class:"export-info"},[e.createElementVNode("text",{class:"export-name"},"å¯¼å‡ºå¡å¯†"),e.createElementVNode("text",{class:"export-desc"},"å¯¼å‡ºå¡å¯†æ•°æ®ä¸º CSV æ ¼å¼")]),e.createElementVNode("text",{class:"export-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“¥ æ•°æ®å¯¼å…¥")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"export-item",onClick:a[3]||(a[3]=(...e)=>n.showImportUsers&&n.showImportUsers(...e))},[e.createElementVNode("view",{class:"export-icon"},"ğŸ‘¥"),e.createElementVNode("view",{class:"export-info"},[e.createElementVNode("text",{class:"export-name"},"å¯¼å…¥ç”¨æˆ·æ•°æ®"),e.createElementVNode("text",{class:"export-desc"},"ä» CSV æ‰¹é‡å¯¼å…¥ç”¨æˆ·")]),e.createElementVNode("text",{class:"export-arrow"},"â€º")]),e.createElementVNode("view",{class:"export-item",onClick:a[4]||(a[4]=(...e)=>n.showImportRedeemCodes&&n.showImportRedeemCodes(...e))},[e.createElementVNode("view",{class:"export-icon"},"ğŸ«"),e.createElementVNode("view",{class:"export-info"},[e.createElementVNode("text",{class:"export-name"},"å¯¼å…¥å¡å¯†"),e.createElementVNode("text",{class:"export-desc"},"ä» CSV æ‰¹é‡å¯¼å…¥å¡å¯†")]),e.createElementVNode("text",{class:"export-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“‹ CSV æ ¼å¼è¯´æ˜")]),e.createElementVNode("view",{class:"section-body"},[e.createElementVNode("view",{class:"format-item"},[e.createElementVNode("text",{class:"format-title"},"ç”¨æˆ·å¯¼å…¥æ ¼å¼"),e.createElementVNode("text",{class:"format-code"},"username,email,password,max_domains"),e.createElementVNode("text",{class:"format-example"},"ç¤ºä¾‹: user1,user1@example.com,123456,10")]),e.createElementVNode("view",{class:"format-item"},[e.createElementVNode("text",{class:"format-title"},"å¡å¯†å¯¼å…¥æ ¼å¼"),e.createElementVNode("text",{class:"format-code"},"code,amount,expires_days"),e.createElementVNode("text",{class:"format-example"},"ç¤ºä¾‹: ABC123,100,30")])])])]),l.showUserModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[9]||(a[9]=e.withModifiers((e=>l.showUserModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"å¯¼å…¥ç”¨æˆ·"),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"CSV æ•°æ®"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[5]||(a[5]=e=>l.importUserData=e),placeholder:"username,email,password,max_domains\nuser1,user1@example.com,123456,10"},null,512),[[e.vModelText,l.importUserData]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é»˜è®¤å¯†ç ï¼ˆå¯é€‰ï¼‰"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[6]||(a[6]=e=>l.defaultPassword=e),placeholder:"æœªè®¾ç½®å¯†ç æ—¶ä½¿ç”¨"},null,512),[[e.vModelText,l.defaultPassword]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[7]||(a[7]=e=>l.showUserModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[8]||(a[8]=(...e)=>n.handleImportUsers&&n.handleImportUsers(...e))},[e.createElementVNode("text",null,"å¯¼å…¥")])])])])):e.createCommentVNode("",!0),l.showRedeemModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[13]||(a[13]=e.withModifiers((e=>l.showRedeemModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"å¯¼å…¥å¡å¯†"),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"CSV æ•°æ®"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[10]||(a[10]=e=>l.importRedeemData=e),placeholder:"code,amount,expires_days\nABC123,100,30"},null,512),[[e.vModelText,l.importRedeemData]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[11]||(a[11]=e=>l.showRedeemModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[12]||(a[12]=(...e)=>n.handleImportRedeemCodes&&n.handleImportRedeemCodes(...e))},[e.createElementVNode("text",null,"å¯¼å…¥")])])])])):e.createCommentVNode("",!0)])}]]);__definePage("pages/index/index",w),__definePage("pages/mine/mine",g),__definePage("pages/login/login",N),__definePage("pages/register/register",f),__definePage("pages/forgot-password/forgot-password",y),__definePage("pages/domain/list",x),__definePage("pages/domain/purchase",k),__definePage("pages/domain/detail",b),__definePage("pages/recharge/recharge",C),__definePage("pages/record/record",D),__definePage("pages/announcement/list",S),__definePage("pages/settings/settings",T),__definePage("pages/settings/security",M),__definePage("pages/admin/index",L),__definePage("pages/admin/users",U),__definePage("pages/admin/domains",F),__definePage("pages/admin/plans",R),__definePage("pages/admin/redeem",$),__definePage("pages/admin/orders",z),__definePage("pages/admin/announcements",O),__definePage("pages/admin/settings",K),__definePage("pages/admin/cf-accounts",G),__definePage("pages/admin/dns-records",q),__definePage("pages/admin/subdomains",H),__definePage("pages/admin/logs",j),__definePage("pages/admin/coupons",Z),__definePage("pages/admin/app-versions",W),__definePage("pages/admin/email-templates",J),__definePage("pages/admin/ip-blacklist",X),__definePage("pages/admin/data-manage",Y);const Q={onLaunch:function(){t("log","at App.vue:6","App Launch"),this.checkUpdate()},onShow:function(){t("log","at App.vue:11","App Show")},onHide:function(){t("log","at App.vue:14","App Hide")},methods:{async checkUpdate(){try{const e=uni.getSystemInfoSync().platform;plus.runtime.getProperty(plus.runtime.appid,(a=>{const o=a.version;var s;t("log","at App.vue:27","å½“å‰ç‰ˆæœ¬ï¼š",o),(s={platform:e,version:o},l({url:"/app/check-update",method:"GET",data:s})).then((e=>{var a;t("log","at App.vue:33","æ£€æµ‹æ›´æ–°ç»“æœï¼š",e),(null==(a=e.data)?void 0:a.has_update)&&this.showUpdateDialog(e.data)})).catch((e=>{t("log","at App.vue:38","æ£€æµ‹æ›´æ–°å¤±è´¥",e)}))}))}catch(e){t("log","at App.vue:42","æ£€æµ‹æ›´æ–°å¼‚å¸¸",e)}},showUpdateDialog(e){const t=`å‘ç°æ–°ç‰ˆæœ¬ v${e.latest_version}\n\n${e.update_log||"ä¿®å¤å·²çŸ¥é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒ"}`;e.force_update?uni.showModal({title:"å‘ç°æ–°ç‰ˆæœ¬",content:t,showCancel:!1,confirmText:"ç«‹å³æ›´æ–°",success:t=>{t.confirm&&this.downloadUpdate(e)}}):uni.showModal({title:"å‘ç°æ–°ç‰ˆæœ¬",content:t,cancelText:"ç¨åå†è¯´",confirmText:"ç«‹å³æ›´æ–°",success:t=>{t.confirm&&this.downloadUpdate(e)}})},downloadUpdate(e){const a=e.download_url;t("log","at App.vue:80","å¼€å§‹ä¸‹è½½æ›´æ–°ï¼š",a),plus.runtime.openURL(a)}}};const ee=uni.getSystemInfoSync(),te="4.75",ae="https://tongji.dcloud.io/uni/stat",oe="__UNI__56C7881",se=(e,t)=>{let a=uni.getStorageSync("$$STAT__DBDATA:"+oe)||{};a||(a={}),a[e]=t,uni.setStorageSync("$$STAT__DBDATA:"+oe,a)},le=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+oe)||{};if(!t[e]){let a=uni.getStorageSync("$$STAT__DBDATA:"+oe);if(a||(a={}),!a[e])return;t[e]=a[e]}return t[e]},ne=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+oe)||{};t[e]?(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+oe,t)):(t=uni.getStorageSync("$$STAT__DBDATA:"+oe),t[e]&&(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+oe,t)))},ie={enable:!0,version:"1"};let ce={};ce={"pages/index/index":"é¦–é¡µ","pages/mine/mine":"æˆ‘çš„","pages/login/login":"ç™»å½•","pages/register/register":"æ³¨å†Œ","pages/forgot-password/forgot-password":"å¿˜è®°å¯†ç ","pages/domain/list":"æˆ‘çš„åŸŸå","pages/domain/purchase":"è´­ä¹°åŸŸå","pages/domain/detail":"åŸŸåè¯¦æƒ…","pages/recharge/recharge":"å……å€¼","pages/record/record":"è´­ä¹°è®°å½•","pages/announcement/list":"å…¬å‘Š","pages/settings/settings":"è®¾ç½®","pages/settings/security":"å®‰å…¨è®¾ç½®","pages/admin/index":"ç®¡ç†ä¸­å¿ƒ","pages/admin/users":"ç”¨æˆ·ç®¡ç†","pages/admin/domains":"åŸŸåç®¡ç†","pages/admin/plans":"å¥—é¤ç®¡ç†","pages/admin/redeem":"å¡å¯†ç®¡ç†","pages/admin/orders":"è®¢å•ç®¡ç†","pages/admin/announcements":"å…¬å‘Šç®¡ç†","pages/admin/settings":"ç³»ç»Ÿè®¾ç½®","pages/admin/cf-accounts":"æ¸ é“ç®¡ç†","pages/admin/dns-records":"DNSè®°å½•ç®¡ç†","pages/admin/subdomains":"äºŒçº§åŸŸåç®¡ç†","pages/admin/logs":"æ“ä½œæ—¥å¿—","pages/admin/coupons":"ä¼˜æƒ åˆ¸ç®¡ç†","pages/admin/app-versions":"APPç‰ˆæœ¬ç®¡ç†","pages/admin/email-templates":"é‚®ä»¶æ¨¡æ¿ç®¡ç†","pages/admin/ip-blacklist":"IPé»‘åå•","pages/admin/data-manage":"æ•°æ®ç®¡ç†"};const re="__DC_STAT_UUID",de="__DC_UUID_VALUE";function me(){let e="";if("n"===pe()){try{e=plus.runtime.getDCloudId()}catch(t){e=""}return e}try{e=uni.getStorageSync(re)}catch(t){e=de}if(!e){e=Date.now()+""+Math.floor(1e7*Math.random());try{uni.setStorageSync(re,e)}catch(t){uni.setStorageSync(re,de)}}return e}const ue={appid:"__UNI__56C7881"},pe=()=>{const e={app:"n","app-plus":"n","app-harmony":"n","mp-harmony":"mhm",h5:"h5","mp-weixin":"wx",[["y","a","p","mp-ali"].reverse().join("")]:"ali","mp-baidu":"bd","mp-toutiao":"tt","mp-qq":"qq","quickapp-native":"qn","mp-kuaishou":"ks","mp-lark":"lark","quickapp-webview":"qw","mp-xhs":"xhs"};if("ali"===e.app&&my&&my.env){const e=my.env.clientName;if("ap"===e)return"ali";if("dingtalk"===e)return"dt"}return e.app||"app"},he=e=>{const t=pe();let a="";return e||("wx"===t&&(a=uni.getLaunchOptionsSync().scene),a)},Ee=e=>{let t="";for(var a in e)t+=a+"="+e[a]+"&";return t.substr(0,t.length-1)},we=e=>{let t=e||Ve();if("bd"===pe()){let e=t.$mp&&t.$mp.page&&t.$mp.page.is,a=t.$scope&&t.$scope.is;return e||a||""}return t.route||t.$scope&&t.$scope.route||t.$mp&&t.$mp.page.route},ve=e=>{let t=e&&(e.$page||e.$scope&&e.$scope.$page),a=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return t?"/"===t.fullPath?t.route:t.fullPath||t.route:a||""},Ve=()=>{let e=getCurrentPages(),t=e[e.length-1];return t?t.$vm:null},ge=e=>"page"===e.mpType||"page"===e.$mpType||e.$mp&&"page"===e.$mp.mpType||"page"===e.$options.mpType?"page":"app"===e.mpType||"app"===e.$mpType||e.$mp&&"app"===e.$mp.mpType||"app"===e.$options.mpType?"app":null,Ne=e=>{let t=[],a=[],o=[];for(let s in e){e[s].forEach((e=>{let l="";l=Ee(e),0===s?t.push(l):3===s?o.push(l):a.push(l)}))}return t.push(...a,...o),JSON.stringify(t)},fe=e=>ce&&ce[e]||"",ye="Report_Data_Time",xe="Report_Status",ke=e=>{let t={usv:te,conf:JSON.stringify({ak:"__UNI__56C7881"})};uni.request({url:ae,method:"GET",data:t,success:t=>{const{data:a}=t;0===a.ret&&"function"==typeof e&&e({enable:a.enable})},fail:t=>{let a=1;try{a=uni.getStorageSync(xe)}catch(o){a=1}""===a&&(a=1),"function"==typeof e&&e({enable:a})}})},be=()=>{if(ie.collectItems){const e=ie.collectItems.uniStatPageLog;return void 0===e||("boolean"!=typeof e||e)}return!0},_e="__first__visit__time",Ce="__last__visit__time",De=()=>parseInt((new Date).getTime()/1e3),Se=()=>{const e=le(_e);let t=0;return e?t=e:(t=De(),se(_e,t),ne(Ce)),t},Te="__page__residence__time";let Be=0,Me=0;const Pe=()=>(Be=De(),se(Te,Be),Be),Ie="__total__visit__count",Ae=()=>{const e=le(Ie);let t=1;return e&&(t=e,t++),se(Ie,t),t},Le="__first_time",Ue=()=>{let e=De();return se(Le,e)},Fe=e=>{let t=0;const a=le(Le),o=De();if(0!==a&&(t=o-a),t=t<1?1:t,"app"===e){return{residenceTime:t,overtime:t>300}}if("page"===e){return{residenceTime:t,overtime:t>1800}}return{residenceTime:t}},Re=(e=>{let t=ie.reportInterval;if(0===Number(t))return 0;t=t||e;return/(^[1-9]\d*$)/.test(t)?Number(t):e})(10);let $e={uuid:ee.deviceId||me(),ak:ue.appid,p:"",ut:pe(),mpn:(()=>{let e="";return"wx"!==pe()&&"qq"!==pe()||uni.canIUse("getAccountInfoSync")&&(e=uni.getAccountInfoSync().miniProgram.appId||""),pe(),e})(),usv:te,v:"n"===pe()?plus.runtime.version:"",ch:(()=>{let e="";return"n"===pe()&&(e=plus.runtime.channel),e})(),cn:"",pn:"",ct:"",t:De(),tt:"",brand:ee.brand||"",md:ee.model,sv:"",mpsdk:ee.SDKVersion||"",mpv:ee.version||"",lang:ee.language,pr:ee.pixelRatio,ww:ee.windowWidth,wh:ee.windowHeight,sw:ee.screenWidth,sh:ee.screenHeight};if(ee.platform)switch(ee.platform){case"android":$e.p="a";break;case"ios":$e.p="i";break;case"harmonyos":$e.p="h"}ee.system&&($e.sv=ee.system.replace(/(Android|iOS)\s/,""));class ze extends class{constructor(){this.self="",this.__licationShow=!1,this.__licationHide=!1,this.statData=$e,this._navigationBarTitle={config:"",page:"",report:"",lt:""},this._query={},"function"==typeof uni.addInterceptor&&(this.addInterceptorInit(),this.interceptLogin(),this.interceptShare(!0),this.interceptRequestPayment())}addInterceptorInit(){let e=this;uni.addInterceptor("setNavigationBarTitle",{invoke(t){e._navigationBarTitle.page=t.title}})}interceptLogin(){let e=this;uni.addInterceptor("login",{complete(){e._login()}})}interceptShare(e){let t=this;e?uni.addInterceptor("share",{success(){t._share()},fail(){t._share()}}):t._share()}interceptRequestPayment(){let e=this;uni.addInterceptor("requestPayment",{success(){e._payment("pay_success")},fail(){e._payment("pay_fail")}})}_login(){this.sendEventRequest({key:"login"},0)}_share(){this.sendEventRequest({key:"share"},0)}_payment(e){this.sendEventRequest({key:e},0)}applicationShow(){if(this.__licationHide){if(Fe("app").overtime){let e={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:this.statData.sc,cst:2};this.sendReportRequest(e)}else{const e=he();if(e!==this.statData.sc){let t={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:e,cst:2};this.sendReportRequest(t)}}this.__licationHide=!1}}applicationHide(e,t){e||(e=Ve()),this.__licationHide=!0;const a=Fe(),o=ve(e);uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",o),this.sendHideRequest({urlref:o,urlref_ts:a.residenceTime},t),Ue()}pageShow(e){this._navigationBarTitle={config:"",page:"",report:"",lt:""};const t=ve(e),a=we(e);if(this._navigationBarTitle.config=fe(a),this.__licationShow)return Ue(),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",t),void(this.__licationShow=!1);if(Fe("page").overtime){let e={path:t,scene:this.statData.sc,cst:3};this.sendReportRequest(e)}Ue()}pageHide(e){if(!this.__licationHide){const t=Fe("page");let a=ve(e),o=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return o||(o=a),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",a),void this.sendPageRequest({url:a,urlref:o,urlref_ts:t.residenceTime})}}sendReportRequest(e,t){this._navigationBarTitle.lt="1",this._navigationBarTitle.config=fe(e.path);let a=e.query&&"{}"!==JSON.stringify(e.query)?"?"+JSON.stringify(e.query):"";const o=(()=>{const e=le(Ce);let t=0;return e&&(t=e),se(Ce,De()),t})();if(0!==o||!o){const e=(e=>{let t="";if("n"===pe()){try{t=plus.device.uuid}catch(a){t=""}return t}return ee.deviceId||me()})();this.statData.odid=e}Object.assign(this.statData,{lt:"1",url:e.path+a||"",t:De(),sc:he(e.scene),fvts:Se(),lvts:o,tvc:Ae(),cst:e.cst||1}),"n"===pe()?this.getProperty(t):this.getNetworkInfo(t)}sendPageRequest(e){let{url:t,urlref:a,urlref_ts:o}=e;this._navigationBarTitle.lt="11";let s={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"11",ut:this.statData.ut,url:t,tt:this.statData.tt,urlref:a,urlref_ts:o,ch:this.statData.ch,usv:this.statData.usv,t:De()};this.request(s)}sendHideRequest(e,t){let{urlref:a,urlref_ts:o}=e,s={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"3",ut:this.statData.ut,urlref:a,urlref_ts:o,ch:this.statData.ch,usv:this.statData.usv,t:De()};this.request(s,t)}sendEventRequest({key:e="",value:t=""}={}){let a="";try{a=we()}catch(s){a=le("__launch_options").path}this._navigationBarTitle.config=fe(a),this._navigationBarTitle.lt="21";let o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"21",ut:this.statData.ut,url:a,ch:this.statData.ch,e_n:e,e_v:"object"==typeof t?JSON.stringify(t):t.toString(),usv:this.statData.usv,t:De()};this.request(o)}sendPushRequest(e,t){let a=De();const o={lt:"101",cid:t,t:a,ut:this.statData.ut},s=Ne({101:[o]});let l={usv:te,t:a,requests:s};"h5"!==o.ut?"n"!==pe()||"a"!==this.statData.p?this.sendRequest(l):setTimeout((()=>{this.sendRequest(l)}),200):this.imageRequest(l)}getProperty(e){plus.runtime.getProperty(plus.runtime.appid,(t=>{this.statData.v=t.version||"",this.getNetworkInfo(e)}))}getNetworkInfo(e){uni.getNetworkType({success:t=>{this.statData.net=t.networkType,this.getLocation(e)}})}getLocation(e){ue.getLocation?uni.getLocation({type:"wgs84",geocode:!0,success:t=>{t.address&&(this.statData.cn=t.address.country,this.statData.pn=t.address.province,this.statData.ct=t.address.city),this.statData.lat=t.latitude,this.statData.lng=t.longitude,this.request(this.statData,e)}}):(this.statData.lat=0,this.statData.lng=0,this.request(this.statData,e))}request(e,t){let a=De();const o=this._navigationBarTitle;Object.assign(e,{ttn:o.page,ttpj:o.config,ttc:o.report});let s=le("__UNI__STAT__DATA")||{};if(s[e.lt]||(s[e.lt]=[]),s[e.lt].push(e),se("__UNI__STAT__DATA",s),(Me=De(),Be=le(Te),Me-Be)<Re&&!t)return;Pe();const l=Ne(s);let n={usv:te,t:a,requests:l};ne("__UNI__STAT__DATA"),"h5"!==e.ut?"n"!==pe()||"a"!==this.statData.p?this.sendRequest(n):setTimeout((()=>{this.sendRequest(n)}),200):this.imageRequest(n)}getIsReportData(){return new Promise(((e,t)=>{let a="",o=(new Date).getTime(),s=1;try{a=uni.getStorageSync(ye),s=uni.getStorageSync(xe)}catch(l){a="",s=1}""!==s?(1===s&&e(),a||(uni.setStorageSync(ye,o),a=o),o-a>864e5&&ke((({enable:e})=>{uni.setStorageSync(ye,o),uni.setStorageSync(xe,e)}))):ke((({enable:t})=>{uni.setStorageSync(ye,o),uni.setStorageSync(xe,t),1===t&&e()}))}))}sendRequest(e){this.getIsReportData().then((()=>{uni.request({url:ae,method:"POST",data:e,success:()=>{},fail:t=>{++this._retry<3&&setTimeout((()=>{this.sendRequest(e)}),1e3)}})}))}imageRequest(e){this.getIsReportData().then((()=>{let t=new Image,a=(e=>{let t=Object.keys(e).sort(),a={},o="";for(var s in t)a[t[s]]=e[t[s]],o+=t[s]+"="+e[t[s]]+"&";return{sign:"",options:o.substr(0,o.length-1)}})((e=>{let t={};for(let a in e)t[a]=encodeURIComponent(e[a]);return t})(e)).options;t.src="https://tongji.dcloud.io/uni/stat.gif?"+a}))}sendEvent(e,t){var a,o;(o=t,(a=e)?"string"!=typeof a?(console.error("uni.report [eventName] Parameter type error, it can only be of type String"),1):a.length>255?(console.error("uni.report [eventName] Parameter length cannot be greater than 255"),1):"string"!=typeof o&&"object"!=typeof o?(console.error("uni.report [options] Parameter type error, Only supports String or Object type"),1):"string"==typeof o&&o.length>255?(console.error("uni.report [options] Parameter length cannot be greater than 255"),1):"title"===a&&"string"!=typeof o?(console.error("uni.report [eventName] When the parameter is title, the [options] parameter can only be of type String"),1):void 0:(console.error("uni.report Missing [eventName] parameter"),1))||("title"!==e?this.sendEventRequest({key:e,value:"object"==typeof t?JSON.stringify(t):t},1):this._navigationBarTitle.report=t)}}{static getInstance(){return uni.__stat_instance||(uni.__stat_instance=new ze),uni.__stat_instance}constructor(){super()}pushEvent(e){const t=(()=>{if(ie.collectItems){const e=ie.collectItems.uniPushClientID;return"boolean"==typeof e&&e}return!1})();uni.getPushClientId&&t&&uni.getPushClientId({success:t=>{const a=t.cid||!1;a&&this.sendPushRequest(e,a)}})}launch(e,t){Pe(),this.__licationShow=!0,se("__launch_options",e),e.cst=1,this.sendReportRequest(e,!0)}load(e,t){this.self=t,this._query=e}appHide(e){this.applicationHide(e,!0)}appShow(e){this.applicationShow(e)}show(e){if(this.self=e,"page"===ge(e)){be()&&this.pageShow(e)}"h5"!==pe()&&"n"!==pe()||"app"===ge(e)&&this.appShow()}hide(e){if(this.self=e,"page"===ge(e)){be()&&this.pageHide(e)}"h5"!==pe()&&"n"!==pe()||"app"===ge(e)&&this.appHide()}error(e){let t="";t=e.message?e.stack:JSON.stringify(e);let a="";try{a=we()}catch(s){a=""}let o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"31",url:a,ut:this.statData.ut,ch:this.statData.ch,mpsdk:this.statData.mpsdk,mpv:this.statData.mpv,v:this.statData.v,em:t,usv:this.statData.usv,t:parseInt((new Date).getTime()/1e3)};this.request(o)}}const Oe=ze.getInstance();let Ke=!1;const Ge={onLaunch(e){Oe.launch(e,this),Oe.pushEvent(e)},onLoad(e){if(Oe.load(e,this),this.$scope&&this.$scope.onShareAppMessage){let e=this.$scope.onShareAppMessage;this.$scope.onShareAppMessage=function(t){return Oe.interceptShare(!1),e.call(this,t)}}},onShow(){Ke=!1,Oe.show(this)},onHide(){Ke=!0,Oe.hide(this)},onUnload(){Ke?Ke=!1:Oe.hide(this)},onError(e){try{Oe.error(e)}catch(t){console.error("uni-stat error:",t)}}};uni.onCreateVueApp((e=>{e.mixin(Ge),uni.report=function(e,t){Oe.sendEvent(e,t)}})),"h5"!==pe()&&"n"!==pe()&&(uni.onAppHide((()=>{Oe.appHide(Ve())})),uni.onAppShow((()=>{Oe.appShow(Ve())})));const{app:qe,Vuex:He,Pinia:je}={app:e.createVueApp(Q)};uni.Vuex=He,uni.Pinia=je,qe.provide("__globalStyles",__uniConfig.styles),qe._component.mpType="app",qe._component.render=()=>{},qe.mount("#app")}(Vue);
