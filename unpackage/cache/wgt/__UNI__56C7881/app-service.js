if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const s=(e,t)=>{const a=e.__vccOpts||e;for(const[s,o]of t)a[s]=o;return a};const o=s({name:"CustomTabbar",props:{current:{type:String,default:""}},data:()=>({safeAreaBottom:0,tabs:[{name:"home",path:"/pages/index/index",text:"é¦–é¡µ"},{name:"mine",path:"/pages/mine/mine",text:"æˆ‘çš„"}]}),created(){var e;const t=uni.getSystemInfoSync();this.safeAreaBottom=(null==(e=t.safeAreaInsets)?void 0:e.bottom)||0},methods:{switchTab(e){this.current!==e.path&&uni.reLaunch({url:e.path})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"tabbar",style:e.normalizeStyle({paddingBottom:n.safeAreaBottom+"px"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.tabs,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"tabbar-item",key:a,onClick:e=>l.switchTab(t)},[e.createElementVNode("view",{class:"icon-wrap"},["home"===t.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-box"},[e.createElementVNode("view",{class:e.normalizeClass(["home-icon",{active:s.current===t.path}])},[e.createElementVNode("view",{class:"home-roof"}),e.createElementVNode("view",{class:"home-body"})],2)])):e.createCommentVNode("",!0),"mine"===t.name?(e.openBlock(),e.createElementBlock("view",{key:1,class:"icon-box"},[e.createElementVNode("view",{class:e.normalizeClass(["user-icon",{active:s.current===t.path}])},[e.createElementVNode("view",{class:"user-head"}),e.createElementVNode("view",{class:"user-body"})],2)])):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:e.normalizeClass(["tabbar-text",{active:s.current===t.path}])},e.toDisplayString(t.text),3)],8,["onClick"])))),128))],4)}],["__scopeId","data-v-c88f34f5"]]),n=e=>new Promise(((t,a)=>{const s=uni.getStorageSync("token"),o={"Content-Type":"application/json",...e.header};s&&(o.Authorization=`Bearer ${s}`),uni.request({url:"http://192.168.20.190:5000/api"+e.url,method:e.method||"GET",data:e.data,header:o,success:e=>{if(401===e.statusCode)return uni.removeStorageSync("token"),uni.removeStorageSync("userInfo"),uni.showToast({title:"è¯·é‡æ–°ç™»å½•",icon:"none"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500),void a(e.data);e.data.code>=200&&e.data.code<300?t(e.data):(uni.showToast({title:e.data.message||"è¯·æ±‚å¤±è´¥",icon:"none"}),a(e.data))},fail:e=>{uni.showToast({title:"ç½‘ç»œé”™è¯¯",icon:"none"}),a(e)}})}));function l(){return n({url:"/announcements",method:"GET"})}const i=function(e){return n({url:`/announcements/${e}/read`,method:"POST"})};const c=function(){return n({url:"/domains",method:"GET"})},r=function(e={}){return n({url:"/subdomains",method:"GET",data:e})},d=function(e,t){return n({url:`/subdomains/${e}/renew`,method:"POST",data:t})},m=e=>{uni.setStorageSync("token",e)},u=e=>{uni.setStorageSync("userInfo",JSON.stringify(e))},h=()=>{const e=uni.getStorageSync("userInfo");return e?JSON.parse(e):null},p=()=>!!uni.getStorageSync("token"),E=()=>{uni.removeStorageSync("token"),uni.removeStorageSync("userInfo")};const g=s({components:{CustomTabbar:o},data:()=>({statusBarHeight:20,navBarHeight:88,announcements:[],domains:[],myDomains:[],isLoggedIn:!1,loading:!0}),onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight,this.navBarHeight=e.statusBarHeight+44},onShow(){this.isLoggedIn=p(),this.loadData()},onPullDownRefresh(){this.loadData().then((()=>uni.stopPullDownRefresh()))},methods:{async loadData(){var e,a,s;this.loading=!0;try{const t=await l();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[];const o=await c();if(this.domains=(null==(a=o.data)?void 0:a.domains)||[],this.isLoggedIn){const e=await r();this.myDomains=(null==(s=e.data)?void 0:s.subdomains)||[]}}catch(o){t("error","at pages/index/index.vue:243","åŠ è½½æ•°æ®å¤±è´¥",o)}finally{this.loading=!1}},goToAnnouncements(){uni.navigateTo({url:"/pages/announcement/list"})},goToPurchase(){uni.navigateTo({url:"/pages/domain/purchase"})},goToMyDomains(){this.isLoggedIn?uni.navigateTo({url:"/pages/domain/list"}):uni.navigateTo({url:"/pages/login/login"})},goToRecharge(){this.isLoggedIn?uni.navigateTo({url:"/pages/recharge/recharge"}):uni.navigateTo({url:"/pages/login/login"})},goToRecords(){this.isLoggedIn?uni.navigateTo({url:"/pages/record/record"}):uni.navigateTo({url:"/pages/login/login"})},selectDomain(e){uni.navigateTo({url:`/pages/domain/purchase?domainId=${e.id}`})},goToDomainDetail(e){uni.navigateTo({url:`/pages/domain/detail?id=${e.id}`})}}},[["render",function(t,s,n,l,i,c){const r=a(e.resolveDynamicComponent("custom-tabbar"),o);return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:i.statusBarHeight+"px"})},[e.createElementVNode("view",{class:"nav-content"},[e.createElementVNode("view",{class:"nav-brand"},[e.createElementVNode("text",{class:"nav-logo"},"å…­è¶£DNS")])])],4),e.createElementVNode("view",{class:"page-content",style:e.normalizeStyle({paddingTop:i.navBarHeight+"px"})},[e.createElementVNode("view",{class:"hero-section"},[e.createElementVNode("view",{class:"hero-bg"}),e.createElementVNode("view",{class:"hero-content"},[e.createElementVNode("text",{class:"hero-title"},"ä¸“ä¸šDNSè§£ææœåŠ¡"),e.createElementVNode("text",{class:"hero-subtitle"},"ç¨³å®š Â· å¿«é€Ÿ Â· å®‰å…¨"),e.createElementVNode("view",{class:"hero-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},e.toDisplayString(i.domains.length),1),e.createElementVNode("text",{class:"stat-label"},"å¯ç”¨åŸŸå")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},e.toDisplayString(i.myDomains.length),1),e.createElementVNode("text",{class:"stat-label"},"æˆ‘çš„åŸŸå")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-num"},"24/7"),e.createElementVNode("text",{class:"stat-label"},"å…¨å¤©æœåŠ¡")])])])]),i.announcements.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"notice-bar",onClick:s[0]||(s[0]=(...e)=>c.goToAnnouncements&&c.goToAnnouncements(...e))},[e.createElementVNode("view",{class:"notice-tag"},"é€šçŸ¥"),e.createElementVNode("swiper",{class:"notice-swiper",vertical:"",autoplay:"",circular:"",interval:3e3},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.announcements,(t=>(e.openBlock(),e.createElementBlock("swiper-item",{key:t.id},[e.createElementVNode("text",{class:"notice-text"},e.toDisplayString(t.title),1)])))),128))]),e.createElementVNode("text",{class:"notice-arrow"},"â€º")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"service-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"å¿«æ·æœåŠ¡")]),e.createElementVNode("view",{class:"service-grid"},[e.createElementVNode("view",{class:"service-card",onClick:s[1]||(s[1]=(...e)=>c.goToPurchase&&c.goToPurchase(...e))},[e.createElementVNode("view",{class:"service-icon-wrap blue"},[e.createElementVNode("text",{class:"service-icon"},"ğŸŒ")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"æ³¨å†ŒåŸŸå"),e.createElementVNode("text",{class:"service-desc"},"å¿«é€Ÿæ³¨å†ŒäºŒçº§åŸŸå")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:s[2]||(s[2]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"service-icon-wrap green"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ“Š")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"service-desc"},"ç®¡ç†DNSè§£æè®°å½•")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:s[3]||(s[3]=(...e)=>c.goToRecharge&&c.goToRecharge(...e))},[e.createElementVNode("view",{class:"service-icon-wrap orange"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ’³")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"è´¦æˆ·å……å€¼"),e.createElementVNode("text",{class:"service-desc"},"ä½¿ç”¨å¡å¯†å……å€¼ä½™é¢")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")]),e.createElementVNode("view",{class:"service-card",onClick:s[4]||(s[4]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"service-icon-wrap purple"},[e.createElementVNode("text",{class:"service-icon"},"ğŸ“‹")]),e.createElementVNode("view",{class:"service-info"},[e.createElementVNode("text",{class:"service-name"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"service-desc"},"æŸ¥çœ‹è´­ä¹°ä¸ç»­è´¹è®°å½•")]),e.createElementVNode("text",{class:"service-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"domain-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"å¯é€‰åŸŸååç¼€"),e.createElementVNode("text",{class:"section-more",onClick:s[5]||(s[5]=(...e)=>c.goToPurchase&&c.goToPurchase(...e))},"å…¨éƒ¨ â€º")]),e.createElementVNode("view",{class:"domain-cards"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id,onClick:e=>c.selectDomain(t)},[e.createElementVNode("view",{class:"domain-card-header"},[e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(t.name.split(".").pop()),1),t.allow_register?(e.openBlock(),e.createElementBlock("view",{key:0,class:"domain-badge"},"å¯æ³¨å†Œ")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"domain-full"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:"domain-card-footer"},[e.createElementVNode("text",{class:"domain-registered"},e.toDisplayString(t.subdomains_count)+" å·²æ³¨å†Œ",1),e.createElementVNode("view",{class:"domain-register-btn"},"ç«‹å³æ³¨å†Œ")])],8,["onClick"])))),128))]),0!==i.domains.length||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“­"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¯ç”¨åŸŸå")]))]),i.isLoggedIn&&i.myDomains.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"my-domain-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"æˆ‘çš„åŸŸå"),e.createElementVNode("text",{class:"section-more",onClick:s[6]||(s[6]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},"ç®¡ç† â€º")]),e.createElementVNode("view",{class:"my-domain-cards"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.myDomains.slice(0,3),(t=>(e.openBlock(),e.createElementBlock("view",{class:"my-domain-card",key:t.id,onClick:e=>c.goToDomainDetail(t)},[e.createElementVNode("view",{class:"my-domain-left"},[e.createElementVNode("view",{class:e.normalizeClass(["my-domain-status",{expired:t.is_expired,active:!t.is_expired}])},null,2),e.createElementVNode("view",{class:"my-domain-content"},[e.createElementVNode("text",{class:"my-domain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("text",{class:"my-domain-meta"},e.toDisplayString(t.records_count)+" æ¡è§£æè®°å½•",1)])]),e.createElementVNode("view",{class:"my-domain-right"},[e.createElementVNode("text",{class:e.normalizeClass(["my-domain-expire",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":`${t.days_remaining}å¤©`),3),e.createElementVNode("text",{class:"my-domain-arrow"},"â€º")])],8,["onClick"])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"feature-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬")]),e.createElementVNode("view",{class:"feature-list"},[e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"âš¡"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"æé€Ÿè§£æ"),e.createElementVNode("text",{class:"feature-desc"},"åŸºäºCloudflareå…¨çƒCDNï¼Œæ¯«ç§’çº§å“åº”")])]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"ğŸ›¡ï¸"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"å®‰å…¨å¯é "),e.createElementVNode("text",{class:"feature-desc"},"DDoSé˜²æŠ¤ï¼ŒSSLåŠ å¯†ï¼Œæ•°æ®å®‰å…¨æœ‰ä¿éšœ")])]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("view",{class:"feature-icon"},"ğŸ’¡"),e.createElementVNode("view",{class:"feature-content"},[e.createElementVNode("text",{class:"feature-title"},"ç®€å•æ˜“ç”¨"),e.createElementVNode("text",{class:"feature-desc"},"å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œä¸€é”®é…ç½®DNSè®°å½•")])])])]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"footer-text"},"å…­è¶£DNS Â· ä¸“ä¸šåŸŸåè§£ææœåŠ¡"),e.createElementVNode("text",{class:"footer-copyright"},"Â© 2024 All Rights Reserved")]),e.createElementVNode("view",{class:"bottom-space"})],4),e.createVNode(r,{current:"/pages/index/index"})])}]]);function v(e){return n({url:"/auth/captcha",method:"GET",data:e?{id:e}:{}})}function w(){return n({url:"/auth/me",method:"GET"})}const V=s({components:{CustomTabbar:o},data:()=>({statusBarHeight:20,navBarHeight:88,isLoggedIn:!1,userInfo:null,unreadCount:0}),computed:{isAdmin(){var e,t;return"admin"===(null==(e=this.userInfo)?void 0:e.role)||"demo"===(null==(t=this.userInfo)?void 0:t.role)},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)},roleText(){var e;const t=null==(e=this.userInfo)?void 0:e.role;return"admin"===t?"ç®¡ç†å‘˜":"demo"===t?"æ¼”ç¤º":"ç”¨æˆ·"}},onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight,this.navBarHeight=e.statusBarHeight+44},onShow(){this.isLoggedIn=p(),this.isLoggedIn?(this.loadUserInfo(),this.loadUnreadCount()):this.userInfo=null},methods:{async loadUserInfo(){try{const e=await w();this.userInfo=e.data,u(e.data)}catch(e){this.userInfo=h()}},async loadUnreadCount(){var e;try{const t=await n({url:"/announcements/unread",method:"GET"});this.unreadCount=(null==(e=t.data)?void 0:e.unread_count)||0}catch(a){t("error","at pages/mine/mine.vue:214","è·å–æœªè¯»å…¬å‘Šå¤±è´¥",a)}},goToLogin(){uni.navigateTo({url:"/pages/login/login"})},goToRecharge(){this.isLoggedIn?uni.navigateTo({url:"/pages/recharge/recharge"}):uni.navigateTo({url:"/pages/login/login"})},goToMyDomains(){this.isLoggedIn?uni.navigateTo({url:"/pages/domain/list"}):uni.navigateTo({url:"/pages/login/login"})},goToRecords(){this.isLoggedIn?uni.navigateTo({url:"/pages/record/record"}):uni.navigateTo({url:"/pages/login/login"})},goToAnnouncements(){uni.navigateTo({url:"/pages/announcement/list"})},goToSettings(){uni.navigateTo({url:"/pages/settings/settings"})},goToAdmin(){uni.navigateTo({url:"/pages/admin/index"})},handleLogout(){uni.showModal({title:"æç¤º",content:"ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ",success:e=>{e.confirm&&(E(),this.isLoggedIn=!1,this.userInfo=null,uni.showToast({title:"å·²é€€å‡ºç™»å½•",icon:"success"}))}})}}},[["render",function(t,s,n,l,i,c){var r,d,m,u,h,p,E,g;const v=a(e.resolveDynamicComponent("custom-tabbar"),o);return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:i.statusBarHeight+"px"})},[e.createElementVNode("view",{class:"nav-content"},[e.createElementVNode("text",{class:"nav-title"},"ä¸ªäººä¸­å¿ƒ")])],4),e.createElementVNode("view",{class:"page-content","scroll-y":"",style:e.normalizeStyle({paddingTop:i.navBarHeight+"px"})},[e.createElementVNode("view",{class:"user-section"},[e.createElementVNode("view",{class:"user-bg"}),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"user-content"},[e.createElementVNode("view",{class:"avatar-wrap"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString((null==(m=null==(d=null==(r=i.userInfo)?void 0:r.username)?void 0:d.charAt(0))?void 0:m.toUpperCase())||"U"),1)]),e.createElementVNode("view",{class:e.normalizeClass(["user-status",{admin:c.isAdmin,demo:c.isDemo}])},[e.createElementVNode("text",{class:"status-text"},e.toDisplayString(c.roleText),1)],2)]),e.createElementVNode("text",{class:"username"},e.toDisplayString((null==(u=i.userInfo)?void 0:u.username)||"ç”¨æˆ·"),1),e.createElementVNode("text",{class:"email"},e.toDisplayString((null==(h=i.userInfo)?void 0:h.email)||""),1)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"user-content guest",onClick:s[0]||(s[0]=(...e)=>c.goToLogin&&c.goToLogin(...e))},[e.createElementVNode("view",{class:"avatar-wrap"},[e.createElementVNode("view",{class:"avatar guest"},[e.createElementVNode("text",{class:"avatar-text"},"ğŸ‘¤")])]),e.createElementVNode("text",{class:"username"},"ç‚¹å‡»ç™»å½•"),e.createElementVNode("text",{class:"email"},"ç™»å½•åäº«å—å®Œæ•´æœåŠ¡")]))]),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"overview-card"},[e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(p=i.userInfo)?void 0:p.balance_text)||"Â¥0.00"),1),e.createElementVNode("text",{class:"overview-label"},"è´¦æˆ·ä½™é¢")]),e.createElementVNode("view",{class:"overview-divider"}),e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(E=i.userInfo)?void 0:E.used_domains)||0),1),e.createElementVNode("text",{class:"overview-label"},"å·²ç”¨åŸŸå")]),e.createElementVNode("view",{class:"overview-divider"}),e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-value"},e.toDisplayString((null==(g=i.userInfo)?void 0:g.max_domains)||0),1),e.createElementVNode("text",{class:"overview-label"},"åŸŸåä¸Šé™")])])):e.createCommentVNode("",!0),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:1,class:"quick-actions"},[e.createElementVNode("view",{class:"action-item",onClick:s[1]||(s[1]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"action-text"},"æˆ‘çš„åŸŸå")]),e.createElementVNode("view",{class:"action-item",onClick:s[2]||(s[2]=(...e)=>c.goToRecharge&&c.goToRecharge(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸ’³"),e.createElementVNode("text",{class:"action-text"},"å……å€¼")]),e.createElementVNode("view",{class:"action-item",onClick:s[3]||(s[3]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"action-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"action-text"},"è®°å½•")]),e.createElementVNode("view",{class:"action-item",onClick:s[4]||(s[4]=(...e)=>c.goToAnnouncements&&c.goToAnnouncements(...e))},[e.createElementVNode("view",{class:"action-icon"},[e.createTextVNode(" ğŸ“¢ "),i.unreadCount>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-badge"},[e.createElementVNode("text",{class:"badge-text"},e.toDisplayString(i.unreadCount>99?"99+":i.unreadCount),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"action-text"},"å…¬å‘Š")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"menu-section-title"},"æœåŠ¡ä¸è®¾ç½®"),e.createElementVNode("view",{class:"menu-card"},[e.createElementVNode("view",{class:"menu-item",onClick:s[5]||(s[5]=(...e)=>c.goToMyDomains&&c.goToMyDomains(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap blue"},[e.createElementVNode("text",{class:"menu-icon"},"ğŸŒ")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"menu-desc"},"æŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„åŸŸå")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:s[6]||(s[6]=(...e)=>c.goToRecords&&c.goToRecords(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap green"},[e.createElementVNode("text",{class:"menu-icon"},"ğŸ“")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"menu-desc"},"è´­ä¹°å’Œç»­è´¹å†å²")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:s[7]||(s[7]=(...e)=>c.goToSettings&&c.goToSettings(...e))},[e.createElementVNode("view",{class:"menu-icon-wrap gray"},[e.createElementVNode("text",{class:"menu-icon"},"âš™ï¸")]),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},"è´¦æˆ·è®¾ç½®"),e.createElementVNode("text",{class:"menu-desc"},"å¯†ç ã€å®‰å…¨è®¾ç½®")]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])]),c.isAdmin?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["menu-card admin-card",{"demo-card":c.isDemo}])},[e.createElementVNode("view",{class:"menu-item",onClick:s[8]||(s[8]=(...e)=>c.goToAdmin&&c.goToAdmin(...e))},[e.createElementVNode("view",{class:e.normalizeClass(["menu-icon-wrap",c.isDemo?"orange":"red"])},[e.createElementVNode("text",{class:"menu-icon"},e.toDisplayString(c.isDemo?"ğŸ‘ï¸":"ğŸ›¡ï¸"),1)],2),e.createElementVNode("view",{class:"menu-info"},[e.createElementVNode("text",{class:"menu-title"},e.toDisplayString(c.isDemo?"æ¼”ç¤ºä¸­å¿ƒ":"ç®¡ç†ä¸­å¿ƒ"),1),e.createElementVNode("text",{class:"menu-desc"},e.toDisplayString(c.isDemo?"æŸ¥çœ‹ç³»ç»Ÿæ•°æ®ï¼ˆåªè¯»ï¼‰":"ç³»ç»Ÿç®¡ç†ä¸æ•°æ®ç»Ÿè®¡"),1)]),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])],2)):e.createCommentVNode("",!0)]),i.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:2,class:"logout-section"},[e.createElementVNode("view",{class:"logout-btn",onClick:s[9]||(s[9]=(...e)=>c.handleLogout&&c.handleLogout(...e))},[e.createElementVNode("text",{class:"logout-text"},"é€€å‡ºç™»å½•")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"footer-info"},[e.createElementVNode("text",{class:"version-text"},"å…­è¶£DNS v1.0.0")]),e.createElementVNode("view",{class:"bottom-space"})],4),e.createVNode(v,{current:"/pages/mine/mine"})])}]]);const N=s({data:()=>({form:{email:"",password:"",captcha:"",captcha_id:""},needCaptcha:!0,captchaUrl:""}),onLoad(){this.refreshCaptcha()},methods:{async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(s){t("error","at pages/login/login.vue:96","è·å–éªŒè¯ç å¤±è´¥",s)}},async handleLogin(){var e;if(this.form.email)if(this.form.password)if(this.form.captcha)try{uni.showLoading({title:"ç™»å½•ä¸­..."});const t=await(e={email:this.form.email,password:this.form.password,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},n({url:"/auth/login",method:"POST",data:e}));uni.hideLoading(),m(t.data.access_token),u(t.data.user),uni.showToast({title:"ç™»å½•æˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.reLaunch({url:"/pages/mine/mine"})}),1500)}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¯†ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},goToRegister(){uni.navigateTo({url:"/pages/register/register"})},goToForgotPassword(){uni.navigateTo({url:"/pages/forgot-password/forgot-password"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"ğŸŒ")]),e.createElementVNode("text",{class:"brand-name"},"å…­è¶£DNS"),e.createElementVNode("text",{class:"brand-slogan"},"ä¸“ä¸šåŸŸåè§£ææœåŠ¡")]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("text",{class:"form-title"},"è´¦å·ç™»å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±"},null,512),[[e.vModelText,n.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[1]||(a[1]=e=>n.form.password=e),placeholder:"è¯·è¾“å…¥å¯†ç "},null,512),[[e.vModelText,n.form.password]])])]),n.needCaptcha?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>n.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,n.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:n.captchaUrl,onClick:a[3]||(a[3]=(...e)=>l.refreshCaptcha&&l.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"btn-primary",onClick:a[4]||(a[4]=(...e)=>l.handleLogin&&l.handleLogin(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç™» å½•")]),e.createElementVNode("view",{class:"form-footer"},[e.createElementVNode("text",{class:"forgot-link",onClick:a[5]||(a[5]=(...e)=>l.goToForgotPassword&&l.goToForgotPassword(...e))},"å¿˜è®°å¯†ç ï¼Ÿ")])]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-tip"},"è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ"),e.createElementVNode("text",{class:"register-link",onClick:a[6]||(a[6]=(...e)=>l.goToRegister&&l.goToRegister(...e))},"ç«‹å³æ³¨å†Œ")]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"footer-text"},"Â© 2024 å…­è¶£DNS Â· å®‰å…¨å¯é çš„DNSæœåŠ¡")])])}]]);const f=s({data:()=>({smtpConfigured:!0,step:1,form:{email:"",username:"",password:"",confirmPassword:"",token:"",captcha:"",captcha_id:""},captchaUrl:""}),onLoad(e){e.token?(this.form.token=e.token,this.step=2,this.smtpConfigured=!0):this.checkSmtp()},methods:{async checkSmtp(){var e;try{const t=await n({url:"/auth/smtp-status",method:"GET"});this.smtpConfigured=(null==(e=t.data)?void 0:e.configured)||!1,this.refreshCaptcha()}catch(t){this.smtpConfigured=!1,this.refreshCaptcha()}},async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(s){t("error","at pages/register/register.vue:182","è·å–éªŒè¯ç å¤±è´¥",s)}},async sendVerifyEmail(){var e;if(this.form.email)if(this.form.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={email:this.form.email,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},n({url:"/auth/register/send",method:"POST",data:e})),uni.hideLoading(),uni.showModal({title:"éªŒè¯é‚®ä»¶å·²å‘é€",content:"è¯·å‰å¾€é‚®ç®±ç‚¹å‡»éªŒè¯é“¾æ¥å®Œæˆæ³¨å†Œ",showCancel:!1,confirmText:"æˆ‘çŸ¥é“äº†"})}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},async completeRegister(){var e;if(this.form.token){if(this.validateForm())try{uni.showLoading({title:"æ³¨å†Œä¸­..."});const t=await(e={token:this.form.token,username:this.form.username,password:this.form.password},n({url:"/auth/register/complete",method:"POST",data:e}));uni.hideLoading(),m(t.data.access_token),u(t.data.user),uni.showToast({title:"æ³¨å†ŒæˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.switchTab({url:"/pages/mine/mine"})}),1500)}catch(t){uni.hideLoading()}}else uni.showToast({title:"éªŒè¯é“¾æ¥æ— æ•ˆ",icon:"none"})},async handleRegister(){var e,t;if(this.validateForm())try{uni.showLoading({title:"æ³¨å†Œä¸­..."});const a=await(t={username:this.form.username,email:this.form.email,password:this.form.password},n({url:"/auth/register",method:"POST",data:t}));uni.hideLoading(),(null==(e=a.data)?void 0:e.access_token)&&(m(a.data.access_token),u(a.data.user)),uni.showToast({title:"æ³¨å†ŒæˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.switchTab({url:"/pages/mine/mine"})}),1500)}catch(a){uni.hideLoading()}},validateForm(){return!this.form.username||this.form.username.length<3||this.form.username.length>20?(uni.showToast({title:"ç”¨æˆ·åéœ€3-20ä¸ªå­—ç¬¦",icon:"none"}),!1):this.smtpConfigured||this.form.email?!this.form.password||this.form.password.length<6||this.form.password.length>32?(uni.showToast({title:"å¯†ç éœ€6-32ä¸ªå­—ç¬¦",icon:"none"}),!1):this.form.password===this.form.confirmPassword||(uni.showToast({title:"ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´",icon:"none"}),!1):(uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"}),!1)},goToLogin(){uni.navigateTo({url:"/pages/login/login"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"âœ¨")]),e.createElementVNode("text",{class:"brand-name"},"åˆ›å»ºè´¦å·"),e.createElementVNode("text",{class:"brand-slogan"},"åŠ å…¥å…­è¶£DNSï¼Œå¼€å¯åŸŸåä¹‹æ—…")]),e.createElementVNode("view",{class:"form-card"},[n.smtpConfigured?(e.openBlock(),e.createElementBlock("view",{key:0,class:"steps"},[e.createElementVNode("view",{class:e.normalizeClass(["step",{active:n.step>=1}])},[e.createElementVNode("view",{class:"step-num"},"1"),e.createElementVNode("text",{class:"step-text"},"éªŒè¯é‚®ç®±")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:n.step>=2}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step",{active:n.step>=2}])},[e.createElementVNode("view",{class:"step-num"},"2"),e.createElementVNode("text",{class:"step-text"},"å®Œå–„ä¿¡æ¯")],2)])):e.createCommentVNode("",!0),n.smtpConfigured&&1===n.step?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€"},null,512),[[e.vModelText,n.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>n.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,n.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:n.captchaUrl,onClick:a[2]||(a[2]=(...e)=>l.refreshCaptcha&&l.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[3]||(a[3]=(...e)=>l.sendVerifyEmail&&l.sendVerifyEmail(...e))},[e.createElementVNode("text",{class:"btn-text"},"å‘é€éªŒè¯é‚®ä»¶")])])):e.createCommentVNode("",!0),n.smtpConfigured&&2===n.step?(e.openBlock(),e.createElementBlock("view",{key:2,class:"form-content"},[e.createElementVNode("view",{class:"tip-card"},[e.createElementVNode("text",{class:"tip-icon"},"âœ…"),e.createElementVNode("text",{class:"tip-text"},"é‚®ç®±éªŒè¯æˆåŠŸï¼Œè¯·å®Œå–„è´¦å·ä¿¡æ¯")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ‘¤"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>n.form.username=e),placeholder:"ç”¨æˆ·å (3-20ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,n.form.username]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>n.form.password=e),placeholder:"å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,n.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[6]||(a[6]=e=>n.form.confirmPassword=e),placeholder:"ç¡®è®¤å¯†ç "},null,512),[[e.vModelText,n.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[7]||(a[7]=(...e)=>l.completeRegister&&l.completeRegister(...e))},[e.createElementVNode("text",{class:"btn-text"},"å®Œæˆæ³¨å†Œ")])])):e.createCommentVNode("",!0),n.smtpConfigured?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ‘¤"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[8]||(a[8]=e=>n.form.username=e),placeholder:"ç”¨æˆ·å (3-20ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,n.form.username]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[9]||(a[9]=e=>n.form.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±"},null,512),[[e.vModelText,n.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[10]||(a[10]=e=>n.form.password=e),placeholder:"å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,n.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[11]||(a[11]=e=>n.form.confirmPassword=e),placeholder:"ç¡®è®¤å¯†ç "},null,512),[[e.vModelText,n.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[12]||(a[12]=(...e)=>l.handleRegister&&l.handleRegister(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç«‹å³æ³¨å†Œ")])]))]),e.createElementVNode("view",{class:"login-section"},[e.createElementVNode("text",{class:"login-tip"},"å·²æœ‰è´¦å·ï¼Ÿ"),e.createElementVNode("text",{class:"login-link",onClick:a[13]||(a[13]=(...e)=>l.goToLogin&&l.goToLogin(...e))},"ç«‹å³ç™»å½•")])])}]]);const y=s({data:()=>({hasToken:!1,step:1,form:{email:"",token:"",password:"",confirmPassword:"",captcha:"",captcha_id:""},captchaUrl:""}),onLoad(e){e.token?(this.form.token=e.token,this.hasToken=!0):this.refreshCaptcha()},methods:{async refreshCaptcha(){var e,a;try{const t=await v(this.form.captcha_id);this.form.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.captchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(s){t("error","at pages/forgot-password/forgot-password.vue:140","è·å–éªŒè¯ç å¤±è´¥",s)}},async sendResetEmail(){var e;if(this.form.email)if(this.form.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={email:this.form.email,captcha_id:this.form.captcha_id,captcha_code:this.form.captcha},n({url:"/auth/forgot-password",method:"POST",data:e})),uni.hideLoading(),this.step=2}catch(t){uni.hideLoading(),this.form.captcha="",this.refreshCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥é‚®ç®±",icon:"none"})},async resetPassword(){var e;if(!this.form.password||this.form.password.length<6||this.form.password.length>32)uni.showToast({title:"å¯†ç éœ€6-32ä¸ªå­—ç¬¦",icon:"none"});else if(this.form.password===this.form.confirmPassword)try{uni.showLoading({title:"é‡ç½®ä¸­..."}),await(e={token:this.form.token,password:this.form.password},n({url:"/auth/reset-password",method:"POST",data:e})),uni.hideLoading(),uni.showModal({title:"é‡ç½®æˆåŠŸ",content:"å¯†ç å·²é‡ç½®ï¼Œè¯·ä½¿ç”¨æ–°å¯†ç ç™»å½•",showCancel:!1,success:()=>{uni.redirectTo({url:"/pages/login/login"})}})}catch(t){uni.hideLoading()}else uni.showToast({title:"ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´",icon:"none"})},goToLogin(){uni.navigateTo({url:"/pages/login/login"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-shape"})]),e.createElementVNode("view",{class:"brand-section"},[e.createElementVNode("view",{class:"brand-icon"},[e.createElementVNode("text",{class:"brand-emoji"},"ğŸ”‘")]),e.createElementVNode("text",{class:"brand-name"},e.toDisplayString(n.hasToken?"é‡ç½®å¯†ç ":"å¿˜è®°å¯†ç "),1),e.createElementVNode("text",{class:"brand-slogan"},e.toDisplayString(n.hasToken?"è®¾ç½®æ‚¨çš„æ–°å¯†ç ":"é€šè¿‡é‚®ç®±æ‰¾å›æ‚¨çš„å¯†ç "),1)]),e.createElementVNode("view",{class:"form-card"},[n.hasToken?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"steps"},[e.createElementVNode("view",{class:e.normalizeClass(["step",{active:n.step>=1}])},[e.createElementVNode("view",{class:"step-num"},"1"),e.createElementVNode("text",{class:"step-text"},"éªŒè¯é‚®ç®±")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:n.step>=2}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step",{active:n.step>=2}])},[e.createElementVNode("view",{class:"step-num"},"2"),e.createElementVNode("text",{class:"step-text"},"é‡ç½®å¯†ç ")],2)])),n.hasToken||1!==n.step?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ“§"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.form.email=e),placeholder:"è¯·è¾“å…¥æ³¨å†Œé‚®ç®±"},null,512),[[e.vModelText,n.form.email]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"captcha-row"},[e.createElementVNode("view",{class:"input-wrapper captcha-input-wrap"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>n.form.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,n.form.captcha]])]),e.createElementVNode("image",{class:"captcha-img",src:n.captchaUrl,onClick:a[2]||(a[2]=(...e)=>l.refreshCaptcha&&l.refreshCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[3]||(a[3]=(...e)=>l.sendResetEmail&&l.sendResetEmail(...e))},[e.createElementVNode("text",{class:"btn-text"},"å‘é€é‡ç½®é‚®ä»¶")])])),n.hasToken||2!==n.step?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"form-content"},[e.createElementVNode("view",{class:"success-card"},[e.createElementVNode("text",{class:"success-icon"},"ğŸ“¬"),e.createElementVNode("text",{class:"success-title"},"é‚®ä»¶å·²å‘é€"),e.createElementVNode("text",{class:"success-text"},"é‡ç½®å¯†ç é‚®ä»¶å·²å‘é€åˆ° "+e.toDisplayString(n.form.email),1),e.createElementVNode("text",{class:"success-tip"},"è¯·å‰å¾€é‚®ç®±ç‚¹å‡»é“¾æ¥é‡ç½®å¯†ç ")]),e.createElementVNode("view",{class:"btn-secondary",onClick:a[4]||(a[4]=e=>n.step=1)},[e.createElementVNode("text",{class:"btn-text-secondary"},"é‡æ–°å‘é€")])])),n.hasToken?(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-content"},[e.createElementVNode("view",{class:"tip-card"},[e.createElementVNode("text",{class:"tip-icon"},"âœ…"),e.createElementVNode("text",{class:"tip-text"},"éªŒè¯æˆåŠŸï¼Œè¯·è®¾ç½®æ–°å¯†ç ")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”’"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>n.form.password=e),placeholder:"æ–°å¯†ç  (6-32ä¸ªå­—ç¬¦)"},null,512),[[e.vModelText,n.form.password]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[6]||(a[6]=e=>n.form.confirmPassword=e),placeholder:"ç¡®è®¤æ–°å¯†ç "},null,512),[[e.vModelText,n.form.confirmPassword]])])]),e.createElementVNode("view",{class:"btn-primary",onClick:a[7]||(a[7]=(...e)=>l.resetPassword&&l.resetPassword(...e))},[e.createElementVNode("text",{class:"btn-text"},"ç¡®è®¤é‡ç½®")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"login-section"},[e.createElementVNode("text",{class:"login-tip"},"æƒ³èµ·å¯†ç äº†ï¼Ÿ"),e.createElementVNode("text",{class:"login-link",onClick:a[8]||(a[8]=(...e)=>l.goToLogin&&l.goToLogin(...e))},"è¿”å›ç™»å½•")])])}]]);const x=s({data:()=>({subdomains:[],loading:!0,refreshing:!1}),onShow(){this.loadData()},methods:{async onRefresh(){this.refreshing=!0,await this.loadData(),this.refreshing=!1},async loadData(){var e;this.loading=!0;try{const t=await r();this.subdomains=(null==(e=t.data)?void 0:e.subdomains)||[]}catch(a){t("error","at pages/domain/list.vue:84","åŠ è½½åŸŸåå¤±è´¥",a)}finally{this.loading=!1}},goToDetail(e){uni.navigateTo({url:`/pages/domain/detail?id=${e.id}`})},goToPurchase(){uni.navigateTo({url:"/pages/domain/purchase"})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"header-title"},"æˆ‘çš„åŸŸå"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.subdomains.length)+" ä¸ª",1)])]),e.createElementVNode("scroll-view",{class:"domain-list","scroll-y":"","refresher-enabled":"","refresher-triggered":n.refreshing,onRefresherrefresh:a[1]||(a[1]=(...e)=>l.onRefresh&&l.onRefresh(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.subdomains,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id,onClick:e=>l.goToDetail(t)},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["status-dot",{expired:t.is_expired}])},null,2)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("view",{class:"domain-meta"},[e.createElementVNode("text",{class:"meta-item"},e.toDisplayString((null==(a=t.plan)?void 0:a.name)||"å¥—é¤"),1),e.createElementVNode("text",{class:"meta-dot"},"Â·"),e.createElementVNode("text",{class:"meta-item"},e.toDisplayString(t.records_count)+" æ¡è®°å½•",1)])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("text",{class:e.normalizeClass(["expire-text",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":`${t.days_remaining}å¤©`),3),e.createElementVNode("text",{class:"arrow"},"â€º")])],8,["onClick"])})),128)),n.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-state"},[e.createElementVNode("text",{class:"loading-text"},"åŠ è½½ä¸­...")])):e.createCommentVNode("",!0),0!==n.subdomains.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"empty-title"},"æš‚æ— åŸŸå"),e.createElementVNode("text",{class:"empty-desc"},"ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ³¨å†Œæ‚¨çš„ç¬¬ä¸€ä¸ªåŸŸå"),e.createElementVNode("view",{class:"empty-btn",onClick:a[0]||(a[0]=(...e)=>l.goToPurchase&&l.goToPurchase(...e))},[e.createElementVNode("text",{class:"empty-btn-text"},"ç«‹å³æ³¨å†Œ")])])),e.createElementVNode("view",{class:"bottom-space"})],40,["refresher-triggered"]),e.createElementVNode("view",{class:"fab",onClick:a[2]||(a[2]=(...e)=>l.goToPurchase&&l.goToPurchase(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")])])}]]);const k=s({data:()=>({domains:[],plans:[],selectedDomain:null,selectedPlan:null,subdomainName:"",couponCode:"",couponLoading:!1,couponApplied:!1,couponInfo:null}),computed:{finalPrice(){return this.selectedPlan?this.selectedPlan.price<=0?"å…è´¹":this.couponApplied&&this.couponInfo?"Â¥"+this.couponInfo.final_price:"Â¥"+this.selectedPlan.price:"Â¥0"}},onLoad(e){this.loadDomains(e.domainId)},methods:{async loadDomains(e){var a;try{const t=await c();if(this.domains=(null==(a=t.data)?void 0:a.domains)||[],e){const t=this.domains.find((t=>t.id==e));t&&this.selectDomain(t)}}catch(s){t("error","at pages/domain/purchase.vue:192","åŠ è½½åŸŸåå¤±è´¥",s)}},async selectDomain(e){var a,s;this.selectedDomain=e,this.selectedPlan=null,this.cancelCoupon();try{const t=await(s=e.id,n({url:`/domains/${s}/plans`,method:"GET"}));this.plans=(null==(a=t.data)?void 0:a.plans)||[]}catch(o){t("error","at pages/domain/purchase.vue:203","åŠ è½½å¥—é¤å¤±è´¥",o)}},selectPlan(e){this.selectedPlan=e,this.cancelCoupon()},async handleCoupon(){if(this.couponCode.trim()){if(!this.couponLoading){this.couponLoading=!0;try{const t=await(e={code:this.couponCode.trim(),plan_id:this.selectedPlan.id,price:this.selectedPlan.price},n({url:"/coupon/validate",method:"POST",data:e}));this.couponInfo=t.data,this.couponApplied=!0,uni.showToast({title:"ä¼˜æƒ ç å·²åº”ç”¨",icon:"success"})}catch(a){t("error","at pages/domain/purchase.vue:228","éªŒè¯ä¼˜æƒ ç å¤±è´¥",a)}var e;this.couponLoading=!1}}else uni.showToast({title:"è¯·è¾“å…¥ä¼˜æƒ ç ",icon:"none"})},cancelCoupon(){this.couponCode="",this.couponApplied=!1,this.couponInfo=null},async handlePurchase(){if(!p())return void uni.navigateTo({url:"/pages/login/login"});if(!this.subdomainName)return void uni.showToast({title:"è¯·è¾“å…¥äºŒçº§åŸŸå",icon:"none"});const e=this.subdomainName.length;var t;if(e<this.selectedPlan.min_length||e>this.selectedPlan.max_length)uni.showToast({title:`åŸŸåé•¿åº¦éœ€${this.selectedPlan.min_length}-${this.selectedPlan.max_length}å­—ç¬¦`,icon:"none"});else try{uni.showLoading({title:"è´­ä¹°ä¸­..."});const e={domain_id:this.selectedDomain.id,plan_id:this.selectedPlan.id,name:this.subdomainName};this.couponApplied&&this.couponCode&&(e.coupon_code=this.couponCode.trim()),await(t=e,n({url:"/purchase",method:"POST",data:t})),uni.hideLoading(),uni.showToast({title:"è´­ä¹°æˆåŠŸ",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/domain/list"})}),1500)}catch(a){uni.hideLoading()}}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"page-title"},"æ³¨å†ŒåŸŸå"),e.createElementVNode("text",{class:"page-subtitle"},"é€‰æ‹©å¿ƒä»ªçš„åŸŸååç¼€å¼€å§‹æ³¨å†Œ")]),e.createElementVNode("view",{class:"steps-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:!0,done:n.selectedDomain}])},[e.createElementVNode("view",{class:"step-dot"},"1"),e.createElementVNode("text",{class:"step-label"},"é€‰æ‹©åŸŸå")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:n.selectedDomain}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:n.selectedDomain,done:n.selectedPlan}])},[e.createElementVNode("view",{class:"step-dot"},"2"),e.createElementVNode("text",{class:"step-label"},"é€‰æ‹©å¥—é¤")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-line",{active:n.selectedPlan}])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:n.selectedPlan}])},[e.createElementVNode("view",{class:"step-dot"},"3"),e.createElementVNode("text",{class:"step-label"},"å¡«å†™ä¿¡æ¯")],2)]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"é€‰æ‹©åŸŸååç¼€"),e.createElementVNode("text",{class:"section-count"},e.toDisplayString(n.domains.length)+" ä¸ªå¯é€‰",1)]),e.createElementVNode("view",{class:"domain-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.domains,(t=>{var a,s;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["domain-card",{active:(null==(a=n.selectedDomain)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>l.selectDomain(t)},[(null==(s=n.selectedDomain)?void 0:s.id)===t.id?(e.openBlock(),e.createElementBlock("view",{key:0,class:"domain-check"},"âœ“")):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(t.name.split(".").pop()),1),e.createElementVNode("text",{class:"domain-full"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"domain-count"},e.toDisplayString(t.subdomains_count)+" å·²æ³¨å†Œ",1)],10,["onClick"])})),128))])]),n.selectedDomain?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"é€‰æ‹©å¥—é¤æ–¹æ¡ˆ")]),e.createElementVNode("view",{class:"plan-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.plans,(t=>{var a,s;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["plan-card",{active:(null==(a=n.selectedPlan)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>l.selectPlan(t)},[e.createElementVNode("view",{class:"plan-radio"},[(null==(s=n.selectedPlan)?void 0:s.id)===t.id?(e.openBlock(),e.createElementBlock("view",{key:0,class:"radio-inner"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"plan-content"},[e.createElementVNode("view",{class:"plan-top"},[e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"plan-price"},e.toDisplayString(t.price>0?"Â¥"+t.price:"å…è´¹"),1)]),e.createElementVNode("view",{class:"plan-tags"},[e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.duration_text),1),e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.min_length)+"-"+e.toDisplayString(t.max_length)+"å­—ç¬¦",1),e.createElementVNode("text",{class:"plan-tag"},e.toDisplayString(t.max_records_text)+"è®°å½•",1)])])],10,["onClick"])})),128))])])):e.createCommentVNode("",!0),n.selectedPlan?(e.openBlock(),e.createElementBlock("view",{key:1,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"è®¾ç½®æ‚¨çš„åŸŸå")]),e.createElementVNode("view",{class:"domain-input-card"},[e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{class:"subdomain-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.subdomainName=e),placeholder:`è¾“å…¥${n.selectedPlan.min_length}-${n.selectedPlan.max_length}ä¸ªå­—ç¬¦`},null,8,["placeholder"]),[[e.vModelText,n.subdomainName]]),e.createElementVNode("view",{class:"domain-suffix-box"},[e.createElementVNode("text",{class:"domain-suffix"},"."+e.toDisplayString(n.selectedDomain.name),1)])]),n.subdomainName?(e.openBlock(),e.createElementBlock("view",{key:0,class:"preview-row"},[e.createElementVNode("text",{class:"preview-label"},"é¢„è§ˆï¼š"),e.createElementVNode("text",{class:"preview-domain"},e.toDisplayString(n.subdomainName)+"."+e.toDisplayString(n.selectedDomain.name),1)])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0),n.selectedPlan&&n.selectedPlan.price>0?(e.openBlock(),e.createElementBlock("view",{key:2,class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"ä¼˜æƒ ç "),e.createElementVNode("text",{class:"section-optional"},"é€‰å¡«")]),e.createElementVNode("view",{class:"coupon-input-card"},[e.createElementVNode("view",{class:"coupon-input-row"},[e.withDirectives(e.createElementVNode("input",{class:"coupon-input","onUpdate:modelValue":a[1]||(a[1]=e=>n.couponCode=e),placeholder:"è¾“å…¥ä¼˜æƒ ç ",disabled:n.couponApplied},null,8,["disabled"]),[[e.vModelText,n.couponCode]]),n.couponApplied?(e.openBlock(),e.createElementBlock("view",{key:1,class:"coupon-btn cancel",onClick:a[3]||(a[3]=(...e)=>l.cancelCoupon&&l.cancelCoupon(...e))},[e.createElementVNode("text",null,"å–æ¶ˆ")])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"coupon-btn",onClick:a[2]||(a[2]=(...e)=>l.handleCoupon&&l.handleCoupon(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.couponLoading?"éªŒè¯ä¸­...":"ä½¿ç”¨"),1)]))]),n.couponApplied&&n.couponInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"coupon-result"},[e.createElementVNode("view",{class:"coupon-success"},[e.createElementVNode("text",{class:"coupon-icon"},"ğŸ‰"),e.createElementVNode("text",{class:"coupon-msg"},e.toDisplayString(n.couponInfo.coupon.name),1)]),e.createElementVNode("view",{class:"coupon-discount"},[e.createElementVNode("text",null,"ä¼˜æƒ  -Â¥"+e.toDisplayString(n.couponInfo.discount),1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0),n.selectedPlan?(e.openBlock(),e.createElementBlock("view",{key:3,class:"footer"},[e.createElementVNode("view",{class:"footer-left"},[e.createElementVNode("text",{class:"price-label"},"åº”ä»˜é‡‘é¢"),e.createElementVNode("text",{class:"price-value"},e.toDisplayString(l.finalPrice),1),n.couponApplied&&n.couponInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"price-original"},"åŸä»· Â¥"+e.toDisplayString(n.selectedPlan.price),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"submit-btn",onClick:a[4]||(a[4]=(...e)=>l.handlePurchase&&l.handlePurchase(...e))},[e.createElementVNode("text",{class:"submit-text"},"ç«‹å³æ³¨å†Œ")])])):e.createCommentVNode("",!0)])}]]);const D=s({data:()=>({subdomainId:null,subdomain:{},records:[],renewPlans:[],selectedRenewPlan:null,showAddRecord:!1,showEditRecord:!1,showRenewModal:!1,recordTypes:["A","AAAA","CNAME","TXT","MX"],newRecord:{type:"A",name:"@",content:""},editingRecord:{id:null,type:"",name:"",content:"",ttl:300,proxied:!1}}),onLoad(e){this.subdomainId=e.id,this.loadData()},methods:{async loadData(){var e,a,s,o;try{const t=await(o=this.subdomainId,n({url:`/subdomains/${o}`,method:"GET"}));this.subdomain=(null==(e=t.data)?void 0:e.subdomain)||{}}catch(l){t("error","at pages/domain/detail.vue:220","è·å–åŸŸåä¿¡æ¯å¤±è´¥",l)}try{const e=await function(e){return n({url:`/subdomains/${e}/records`,method:"GET"})}(this.subdomainId);this.records=(null==(a=e.data)?void 0:a.records)||[]}catch(l){t("error","at pages/domain/detail.vue:228","è·å–DNSè®°å½•å¤±è´¥",l),this.records=[]}try{const e=await function(e){return n({url:`/subdomains/${e}/renew-plans`,method:"GET"})}(this.subdomainId);this.renewPlans=(null==(s=e.data)?void 0:s.plans)||[]}catch(l){t("error","at pages/domain/detail.vue:237","è·å–ç»­è´¹å¥—é¤å¤±è´¥",l),this.renewPlans=[]}},formatDate:e=>e?e.split("T")[0]:"-",onTypeChange(e){this.newRecord.type=this.recordTypes[e.detail.value]},async addRecord(){var e,t;if(this.newRecord.content)try{uni.showLoading({title:"æ·»åŠ ä¸­..."}),await(e=this.subdomainId,t=this.newRecord,n({url:`/subdomains/${e}/records`,method:"POST",data:t})),uni.hideLoading(),uni.showToast({title:"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showAddRecord=!1,this.newRecord={type:"A",name:"@",content:""},this.loadData()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},editRecord(e){this.editingRecord={id:e.id,type:e.type,name:e.name,content:e.content,ttl:e.ttl||300,proxied:e.proxied||!1},this.showEditRecord=!0},async saveEditRecord(){var e,t;if(this.editingRecord.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.editingRecord.id,t={content:this.editingRecord.content,ttl:this.editingRecord.ttl,proxied:this.editingRecord.proxied},n({url:`/records/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showEditRecord=!1,this.loadData()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},deleteRecord(e){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡DNSè®°å½•å—ï¼Ÿ",success:async t=>{if(t.confirm)try{await(a=e.id,n({url:`/records/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.loadData()}catch(s){}var a}})},async handleRenew(){if(this.selectedRenewPlan)try{uni.showLoading({title:"ç»­è´¹ä¸­..."}),await d(this.subdomainId,this.selectedRenewPlan.id),uni.hideLoading(),uni.showToast({title:"ç»­è´¹æˆåŠŸ",icon:"success"}),this.showRenewModal=!1,this.loadData()}catch(e){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©ç»­è´¹å¥—é¤",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"åˆ é™¤åæ— æ³•æ¢å¤ï¼Œç¡®å®šè¦åˆ é™¤å—ï¼Ÿ",success:async e=>{if(e.confirm)try{await function(e,t={}){return n({url:`/subdomains/${e}`,method:"DELETE",data:t})}(this.subdomainId),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),setTimeout((()=>uni.navigateBack()),1500)}catch(t){}}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"åŸŸåè¯¦æƒ…")]),e.createElementVNode("view",{class:"info-card"},[e.createElementVNode("view",{class:"domain-header"},[e.createElementVNode("text",{class:"domain-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(n.subdomain.full_name),1)]),e.createElementVNode("view",{class:"status-row"},[e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{expired:n.subdomain.is_expired}])},e.toDisplayString(n.subdomain.is_expired?"å·²è¿‡æœŸ":"æ­£å¸¸è¿è¡Œ"),3),e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(null==(i=n.subdomain.plan)?void 0:i.name),1)]),e.createElementVNode("view",{class:"info-grid"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"åˆ°æœŸæ—¶é—´"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(l.formatDate(n.subdomain.expires_at)),1)]),n.subdomain.is_expired?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"å‰©ä½™å¤©æ•°"),e.createElementVNode("text",{class:"info-value highlight"},e.toDisplayString(n.subdomain.days_remaining)+" å¤©",1)]))]),e.createElementVNode("view",{class:"action-btns"},[e.createElementVNode("view",{class:"action-btn primary",onClick:a[0]||(a[0]=e=>n.showRenewModal=!0)},[e.createElementVNode("text",{class:"action-text"},"ç»­è´¹")]),e.createElementVNode("view",{class:"action-btn danger",onClick:a[1]||(a[1]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",{class:"action-text"},"åˆ é™¤åŸŸå")])])]),e.createElementVNode("view",{class:"records-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"DNSè®°å½•"),e.createElementVNode("view",{class:"section-badge"},e.toDisplayString(n.records.length),1),e.createElementVNode("view",{class:"section-action",onClick:a[2]||(a[2]=e=>n.showAddRecord=!0)},[e.createElementVNode("text",{class:"action-icon"},"+"),e.createElementVNode("text",{class:"action-label"},"æ·»åŠ ")])]),e.createElementVNode("view",{class:"record-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id},[e.createElementVNode("view",{class:"record-main"},[e.createElementVNode("view",{class:"record-row"},[e.createElementVNode("view",{class:e.normalizeClass(["type-badge",t.type.toLowerCase()])},e.toDisplayString(t.type),3),e.createElementVNode("text",{class:"record-name"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"content-box"},[e.createElementVNode("text",{class:"record-content"},e.toDisplayString(t.content),1)])]),e.createElementVNode("view",{class:"record-actions"},[e.createElementVNode("text",{class:"record-btn edit",onClick:e=>l.editRecord(t)},"ç¼–è¾‘",8,["onClick"]),e.createElementVNode("text",{class:"record-btn delete",onClick:e=>l.deleteRecord(t)},"åˆ é™¤",8,["onClick"])])])))),128)),0===n.records.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¡"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— DNSè®°å½•"),e.createElementVNode("text",{class:"empty-hint"},'ç‚¹å‡»ä¸Šæ–¹"æ·»åŠ "æŒ‰é’®åˆ›å»ºè®°å½•')])):e.createCommentVNode("",!0)])]),n.showAddRecord?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>n.showAddRecord=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"æ·»åŠ DNSè®°å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("picker",{range:n.recordTypes,onChange:a[3]||(a[3]=(...e)=>l.onTypeChange&&l.onTypeChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(n.newRecord.type||"è¯·é€‰æ‹©"),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[4]||(a[4]=e=>n.newRecord.name=e),placeholder:"@è¡¨ç¤ºæ ¹åŸŸå"},null,512),[[e.vModelText,n.newRecord.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[5]||(a[5]=e=>n.newRecord.content=e),placeholder:"è¯·è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,n.newRecord.content]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[6]||(a[6]=e=>n.showAddRecord=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>l.addRecord&&l.addRecord(...e))},[e.createElementVNode("text",null,"ç¡®å®š")])])])])):e.createCommentVNode("",!0),n.showRenewModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[11]||(a[11]=e.withModifiers((e=>n.showRenewModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç»­è´¹"),e.createElementVNode("view",{class:"plan-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.renewPlans,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["plan-opt",{active:(null==(a=n.selectedRenewPlan)?void 0:a.id)===t.id}]),key:t.id,onClick:e=>n.selectedRenewPlan=t},[e.createElementVNode("text",{class:"plan-opt-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"plan-opt-price"},"Â¥"+e.toDisplayString(t.price),1),e.createElementVNode("text",{class:"plan-opt-duration"},e.toDisplayString(t.duration_text),1)],10,["onClick"])})),128))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[9]||(a[9]=e=>n.showRenewModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>l.handleRenew&&l.handleRenew(...e))},[e.createElementVNode("text",null,"ç¡®å®šç»­è´¹")])])])])):e.createCommentVNode("",!0),n.showEditRecord?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[16]||(a[16]=e.withModifiers((e=>n.showEditRecord=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘DNSè®°å½•"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("view",{class:"picker disabled"},e.toDisplayString(n.editingRecord.type),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.createElementVNode("view",{class:"picker disabled"},e.toDisplayString(n.editingRecord.name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[12]||(a[12]=e=>n.editingRecord.content=e),placeholder:"è¯·è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,n.editingRecord.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"TTL (ç§’)"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[13]||(a[13]=e=>n.editingRecord.ttl=e),placeholder:"300"},null,512),[[e.vModelText,n.editingRecord.ttl]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=e=>n.showEditRecord=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[15]||(a[15]=(...e)=>l.saveEditRecord&&l.saveEditRecord(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const _=function(e){return n({url:"/redeem",method:"POST",data:e})};const C=s({data:()=>({userInfo:null,redeemCode:"",codeValue:"",codeVerified:!1}),onShow(){this.loadUserInfo()},methods:{async loadUserInfo(){try{const e=await w();this.userInfo=e.data,u(e.data)}catch(e){t("error","at pages/recharge/recharge.vue:102","è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",e)}},async verifyCode(){var e,t;if(this.redeemCode)try{uni.showLoading({title:"éªŒè¯ä¸­..."});const a=await(t={code:this.redeemCode},n({url:"/redeem/verify",method:"POST",data:t}));uni.hideLoading(),this.codeValue=(null==(e=a.data)?void 0:e.value_text)||"",this.codeVerified=!0,uni.showToast({title:"å¡å¯†æœ‰æ•ˆ",icon:"success"})}catch(a){uni.hideLoading(),this.codeVerified=!1,this.codeValue=""}else uni.showToast({title:"è¯·è¾“å…¥å¡å¯†",icon:"none"})},async handleRedeem(){var e,t;if(this.codeVerified)try{uni.showLoading({title:"å……å€¼ä¸­..."});const a=await _({code:this.redeemCode});uni.hideLoading(),uni.showToast({title:"å……å€¼æˆåŠŸ",icon:"success"}),this.userInfo.balance=null==(e=a.data)?void 0:e.balance,this.userInfo.balance_text=null==(t=a.data)?void 0:t.balance_text,u(this.userInfo),this.redeemCode="",this.codeValue="",this.codeVerified=!1}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å…ˆéªŒè¯å¡å¯†",icon:"none"})}}},[["render",function(t,a,s,o,n,l){var i,c;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"balance-section"},[e.createElementVNode("view",{class:"balance-bg"}),e.createElementVNode("view",{class:"balance-content"},[e.createElementVNode("text",{class:"balance-label"},"è´¦æˆ·ä½™é¢"),e.createElementVNode("view",{class:"balance-row"},[e.createElementVNode("text",{class:"balance-symbol"},"Â¥"),e.createElementVNode("text",{class:"balance-value"},e.toDisplayString((null==(c=null==(i=n.userInfo)?void 0:i.balance)?void 0:c.toFixed(2))||"0.00"),1)]),e.createElementVNode("text",{class:"balance-tip"},"ä½™é¢å¯ç”¨äºè´­ä¹°å’Œç»­è´¹åŸŸå")])]),e.createElementVNode("view",{class:"recharge-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-icon"},"ğŸ’³"),e.createElementVNode("text",{class:"card-title"},"å¡å¯†å……å€¼")]),e.createElementVNode("view",{class:"input-section"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"input-icon"},"ğŸ”‘"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[0]||(a[0]=e=>n.redeemCode=e),placeholder:"è¯·è¾“å…¥å……å€¼å¡å¯†"},null,512),[[e.vModelText,n.redeemCode]])]),e.createElementVNode("view",{class:"verify-btn",onClick:a[1]||(a[1]=(...e)=>l.verifyCode&&l.verifyCode(...e))},[e.createElementVNode("text",{class:"verify-text"},"éªŒè¯")])]),n.codeValue?(e.openBlock(),e.createElementBlock("view",{key:0,class:"code-result"},[e.createElementVNode("view",{class:"result-icon"},"âœ“"),e.createElementVNode("view",{class:"result-info"},[e.createElementVNode("text",{class:"result-label"},"å¡å¯†é‡‘é¢"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(n.codeValue),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["submit-btn",{disabled:!n.codeVerified}]),onClick:a[2]||(a[2]=(...e)=>l.handleRedeem&&l.handleRedeem(...e))},[e.createElementVNode("text",{class:"submit-text"},e.toDisplayString(n.codeVerified?"ç¡®è®¤å……å€¼":"è¯·å…ˆéªŒè¯å¡å¯†"),1)],2)]),e.createElementVNode("view",{class:"tips-card"},[e.createElementVNode("view",{class:"tips-header"},[e.createElementVNode("text",{class:"tips-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"tips-title"},"å……å€¼è¯´æ˜")]),e.createElementVNode("view",{class:"tips-list"},[e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"1"),e.createElementVNode("text",{class:"tip-text"},"è¯·è¾“å…¥æ­£ç¡®çš„å¡å¯†è¿›è¡Œå……å€¼")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"2"),e.createElementVNode("text",{class:"tip-text"},"æ¯å¼ å¡å¯†åªèƒ½ä½¿ç”¨ä¸€æ¬¡")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"3"),e.createElementVNode("text",{class:"tip-text"},"å……å€¼æˆåŠŸåä½™é¢ç«‹å³åˆ°è´¦")]),e.createElementVNode("view",{class:"tip-item"},[e.createElementVNode("text",{class:"tip-num"},"4"),e.createElementVNode("text",{class:"tip-text"},"å¦‚æœ‰é—®é¢˜è¯·è”ç³»å®¢æœå¤„ç†")])])])])}]]);const b=s({data:()=>({records:[],page:1,perPage:20,total:0,loading:!1,refreshing:!1,hasMore:!0}),onLoad(){this.loadData()},methods:{async onRefresh(){this.refreshing=!0,this.page=1,this.records=[],this.hasMore=!0,await this.loadData(),this.refreshing=!1},async loadData(){var e,a;this.loading=!0;try{const t=await function(e={}){return n({url:"/purchase-records",method:"GET",data:e})}(this.page,this.perPage),s=(null==(e=t.data)?void 0:e.records)||[];this.records=[...this.records,...s];const o=(null==(a=t.data)?void 0:a.pagination)||{};this.total=o.total||0,this.hasMore=this.page<(o.pages||1)}catch(s){t("error","at pages/record/record.vue:91","åŠ è½½è®°å½•å¤±è´¥",s)}finally{this.loading=!1}},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"äº¤æ˜“è®°å½•"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.total)+" æ¡",1)]),e.createElementVNode("scroll-view",{class:"record-list","scroll-y":"","refresher-enabled":"","refresher-triggered":n.refreshing,onRefresherrefresh:a[0]||(a[0]=(...e)=>l.onRefresh&&l.onRefresh(...e)),onScrolltolower:a[1]||(a[1]=(...e)=>l.loadMore&&l.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["record-icon","renew"===t.type?"renew":"buy"])},e.toDisplayString("renew"===t.type?"ç»­":"è´­"),3)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"record-domain"},e.toDisplayString(t.subdomain_name),1),e.createElementVNode("view",{class:"record-tags"},[e.createElementVNode("text",{class:"tag plan"},e.toDisplayString(t.plan_name),1),e.createElementVNode("text",{class:e.normalizeClass(["tag type",t.type])},e.toDisplayString("renew"===t.type?"ç»­è´¹":"è´­ä¹°"),3)])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("text",{class:"record-price"},e.toDisplayString(t.price_text),1),e.createElementVNode("text",{class:"record-time"},e.toDisplayString(l.formatDate(t.created_at)),1)])])))),128)),0!==n.records.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— äº¤æ˜“è®°å½•")])),n.hasMore&&!n.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"load-more"},[e.createElementVNode("text",{class:"load-more-text"},"ä¸Šæ‹‰åŠ è½½æ›´å¤š")])):e.createCommentVNode("",!0),n.loading?(e.openBlock(),e.createElementBlock("view",{key:2,class:"load-more"},[e.createElementVNode("text",{class:"load-more-text"},"åŠ è½½ä¸­...")])):e.createCommentVNode("",!0),!n.hasMore&&n.records.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"no-more"},[e.createElementVNode("text",{class:"no-more-text"},"â€” å·²åŠ è½½å…¨éƒ¨ â€”")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bottom-space"})],40,["refresher-triggered"])])}]]);const S=s({data:()=>({announcements:[],loading:!0,showModal:!1,currentAnnouncement:{}}),onLoad(){this.loadData()},methods:{async loadData(){var e;this.loading=!0;try{const t=await l();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[]}catch(a){t("error","at pages/announcement/list.vue:82","åŠ è½½å…¬å‘Šå¤±è´¥",a)}finally{this.loading=!1}},async showDetail(e){if(this.currentAnnouncement=e,this.showModal=!0,p()&&!e.is_read)try{await i(e.id),e.is_read=!0}catch(t){}},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ç³»ç»Ÿå…¬å‘Š"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.announcements.length)+" æ¡",1)]),e.createElementVNode("view",{class:"announcement-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.announcements,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["announcement-card",{unread:!t.is_read}]),key:t.id,onClick:e=>l.showDetail(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"title-row"},[t.is_read?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"unread-dot"})),e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1)]),t.is_important?(e.openBlock(),e.createElementBlock("view",{key:0,class:"important-tag"},"ğŸ”¥ é‡è¦")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"card-content"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(l.formatDate(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],10,["onClick"])))),128)),0!==n.announcements.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¢"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å…¬å‘Š")]))]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[1]||(a[1]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.currentAnnouncement.title),1),n.currentAnnouncement.is_important?(e.openBlock(),e.createElementBlock("text",{key:0,class:"important-tag"},"é‡è¦")):e.createCommentVNode("",!0)]),e.createElementVNode("scroll-view",{class:"modal-body","scroll-y":""},[e.createElementVNode("text",{class:"modal-text"},e.toDisplayString(n.currentAnnouncement.content),1)]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("text",{class:"modal-time"},e.toDisplayString(l.formatDate(n.currentAnnouncement.created_at)),1),e.createElementVNode("view",{class:"modal-close",onClick:a[0]||(a[0]=e=>n.showModal=!1)},[e.createElementVNode("text",{class:"close-text"},"å…³é—­")])])])])):e.createCommentVNode("",!0)])}]]);const T=s({data:()=>({isLoggedIn:!1,cacheSize:"0KB",showPasswordModal:!1,showEmailModal:!1,passwordForm:{captcha:"",captcha_id:""},emailForm:{captcha:"",captcha_id:""},passwordCaptchaUrl:"",emailCaptchaUrl:""}),onShow(){this.isLoggedIn=p(),this.getCacheSize()},methods:{getCacheSize(){try{const e=uni.getStorageInfoSync().currentSize||0;this.cacheSize=e<1024?e+"KB":(e/1024).toFixed(2)+"MB"}catch(e){this.cacheSize="0KB"}},async refreshPasswordCaptcha(){var e,a;try{const t=await v(this.passwordForm.captcha_id);this.passwordForm.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.passwordCaptchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(s){t("error","at pages/settings/settings.vue:152","è·å–éªŒè¯ç å¤±è´¥",s)}},async refreshEmailCaptcha(){var e,a;try{const t=await v(this.emailForm.captcha_id);this.emailForm.captcha_id=(null==(e=t.data)?void 0:e.id)||"",this.emailCaptchaUrl=(null==(a=t.data)?void 0:a.image)||""}catch(s){t("error","at pages/settings/settings.vue:161","è·å–éªŒè¯ç å¤±è´¥",s)}},changePassword(){this.showPasswordModal=!0,this.passwordForm.captcha="",this.refreshPasswordCaptcha()},async sendPasswordEmail(){var e;if(this.passwordForm.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={captcha_id:this.passwordForm.captcha_id,captcha_code:this.passwordForm.captcha},n({url:"/auth/change-password/send",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"éªŒè¯é‚®ä»¶å·²å‘é€",icon:"success"}),this.showPasswordModal=!1}catch(t){uni.hideLoading(),this.passwordForm.captcha="",this.refreshPasswordCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"})},changeEmail(){this.showEmailModal=!0,this.emailForm.captcha="",this.refreshEmailCaptcha()},async sendEmailCode(){var e;if(this.emailForm.captcha)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(e={captcha_id:this.emailForm.captcha_id,captcha_code:this.emailForm.captcha},n({url:"/auth/change-email/send",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"éªŒè¯é‚®ä»¶å·²å‘é€",icon:"success"}),this.showEmailModal=!1}catch(t){uni.hideLoading(),this.emailForm.captcha="",this.refreshEmailCaptcha()}else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"})},clearCache(){uni.showModal({title:"æç¤º",content:"ç¡®å®šè¦æ¸…é™¤ç¼“å­˜å—ï¼Ÿ",success:e=>{if(e.confirm)try{uni.clearStorageSync(),this.cacheSize="0KB",uni.showToast({title:"æ¸…é™¤æˆåŠŸ",icon:"success"})}catch(t){uni.showToast({title:"æ¸…é™¤å¤±è´¥",icon:"none"})}}})},showAbout(){uni.showModal({title:"å…³äºæˆ‘ä»¬",content:"åŸŸåç®¡ç†ç³»ç»Ÿ v1.0.0\næä¾›ä¾¿æ·çš„äºŒçº§åŸŸåç®¡ç†æœåŠ¡",showCancel:!1})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"è®¾ç½®")]),n.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"è´¦æˆ·è®¾ç½®"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[0]||(a[0]=(...e)=>l.changePassword&&l.changePassword(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ”"),e.createElementVNode("text",{class:"menu-text"},"ä¿®æ”¹å¯†ç "),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item",onClick:a[1]||(a[1]=(...e)=>l.changeEmail&&l.changeEmail(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ“§"),e.createElementVNode("text",{class:"menu-text"},"ä¿®æ”¹é‚®ç®±"),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"é€šç”¨"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[2]||(a[2]=(...e)=>l.clearCache&&l.clearCache(...e))},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ—‘ï¸"),e.createElementVNode("text",{class:"menu-text"},"æ¸…é™¤ç¼“å­˜"),e.createElementVNode("text",{class:"menu-value"},e.toDisplayString(n.cacheSize),1),e.createElementVNode("text",{class:"menu-arrow"},"â€º")]),e.createElementVNode("view",{class:"menu-item"},[e.createElementVNode("view",{class:"menu-icon"},"ğŸ“±"),e.createElementVNode("text",{class:"menu-text"},"å½“å‰ç‰ˆæœ¬"),e.createElementVNode("text",{class:"menu-value"},"v1.0.0")])])]),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("text",{class:"section-label"},"å…¶ä»–"),e.createElementVNode("view",{class:"menu-group"},[e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=(...e)=>l.showAbout&&l.showAbout(...e))},[e.createElementVNode("view",{class:"menu-icon"},"â„¹ï¸"),e.createElementVNode("text",{class:"menu-text"},"å…³äºæˆ‘ä»¬"),e.createElementVNode("text",{class:"menu-arrow"},"â€º")])])]),n.showPasswordModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>n.showPasswordModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä¿®æ”¹å¯†ç "),e.createElementVNode("text",{class:"modal-tip"},"è¯·è¾“å…¥éªŒè¯ç åå‘é€éªŒè¯é‚®ä»¶"),e.createElementVNode("view",{class:"modal-captcha"},[e.createElementVNode("view",{class:"captcha-row"},[e.withDirectives(e.createElementVNode("input",{class:"captcha-input",type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>n.passwordForm.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,n.passwordForm.captcha]]),e.createElementVNode("image",{class:"captcha-img",src:n.passwordCaptchaUrl,onClick:a[5]||(a[5]=(...e)=>l.refreshPasswordCaptcha&&l.refreshPasswordCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[6]||(a[6]=e=>n.showPasswordModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>l.sendPasswordEmail&&l.sendPasswordEmail(...e))},[e.createElementVNode("text",null,"å‘é€éªŒè¯é‚®ä»¶")])])])])):e.createCommentVNode("",!0),n.showEmailModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[13]||(a[13]=e.withModifiers((e=>n.showEmailModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä¿®æ”¹é‚®ç®±"),e.createElementVNode("text",{class:"modal-tip"},"è¯·è¾“å…¥éªŒè¯ç åå‘é€éªŒè¯é‚®ä»¶"),e.createElementVNode("view",{class:"modal-captcha"},[e.createElementVNode("view",{class:"captcha-row"},[e.withDirectives(e.createElementVNode("input",{class:"captcha-input",type:"number","onUpdate:modelValue":a[9]||(a[9]=e=>n.emailForm.captcha=e),placeholder:"éªŒè¯ç ",maxlength:"4"},null,512),[[e.vModelText,n.emailForm.captcha]]),e.createElementVNode("image",{class:"captcha-img",src:n.emailCaptchaUrl,onClick:a[10]||(a[10]=(...e)=>l.refreshEmailCaptcha&&l.refreshEmailCaptcha(...e)),mode:"aspectFit"},null,8,["src"])])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[11]||(a[11]=e=>n.showEmailModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[12]||(a[12]=(...e)=>l.sendEmailCode&&l.sendEmailCode(...e))},[e.createElementVNode("text",null,"å‘é€éªŒè¯é‚®ä»¶")])])])])):e.createCommentVNode("",!0)])}]]);function B(){return n({url:"/admin/domains",method:"GET"})}function M(e,t){return n({url:`/admin/domains/${e}`,method:"PUT",data:t})}function P(){return n({url:"/admin/channels",method:"GET"})}const L=s({data:()=>({stats:{},userInfo:null}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadStats()},methods:{async loadStats(){try{const e=await n({url:"/admin/stats",method:"GET"});this.stats=e.data||{}}catch(e){}},goTo(e){uni.navigateTo({url:e})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"header-title"},e.toDisplayString(l.isDemo?"æ¼”ç¤ºä¸­å¿ƒ":"ç®¡ç†ä¸­å¿ƒ"),1),e.createElementVNode("text",{class:"header-subtitle"},e.toDisplayString(l.isDemo?"åªè¯»æ¨¡å¼ï¼Œä»…ä¾›æŸ¥çœ‹":"ç³»ç»Ÿæ•°æ®æ¦‚è§ˆä¸ç®¡ç†"),1)]),l.isDemo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"demo-badge"},"æ¼”ç¤º")):e.createCommentVNode("",!0)]),l.isDemo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"demo-notice"},[e.createElementVNode("text",{class:"notice-icon"},"ğŸ‘ï¸"),e.createElementVNode("text",{class:"notice-text"},"æ¼”ç¤ºæ¨¡å¼ï¼šæ‚¨å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ•°æ®ï¼Œä½†æ— æ³•è¿›è¡Œä¿®æ”¹æ“ä½œ")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stats-grid"},[e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon users"},"ğŸ‘¥"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.users_count||0),1),e.createElementVNode("text",{class:"stat-label"},"ç”¨æˆ·æ€»æ•°")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon domains"},"ğŸŒ"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.domains_count||0),1),e.createElementVNode("text",{class:"stat-label"},"ä¸»åŸŸå")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon subdomains"},"ğŸ”—"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.subdomains_count||0),1),e.createElementVNode("text",{class:"stat-label"},"äºŒçº§åŸŸå")])]),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon records"},"ğŸ“"),e.createElementVNode("view",{class:"stat-info"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.stats.records_count||0),1),e.createElementVNode("text",{class:"stat-label"},"DNSè®°å½•")])])])]),e.createElementVNode("view",{class:"today-card"},[e.createElementVNode("view",{class:"today-header"},[e.createElementVNode("text",{class:"today-title"},"ğŸ“Š ä»Šæ—¥æ•°æ®")]),e.createElementVNode("view",{class:"today-grid"},[e.createElementVNode("view",{class:"today-item"},[e.createElementVNode("text",{class:"today-value green"},"+"+e.toDisplayString(n.stats.today_new_users||0),1),e.createElementVNode("text",{class:"today-label"},"æ–°å¢ç”¨æˆ·")]),e.createElementVNode("view",{class:"today-divider"}),e.createElementVNode("view",{class:"today-item"},[e.createElementVNode("text",{class:"today-value blue"},"+"+e.toDisplayString(n.stats.today_new_subdomains||0),1),e.createElementVNode("text",{class:"today-label"},"æ–°å¢åŸŸå")])])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"section-title"},"å¿«æ·ç®¡ç†"),e.createElementVNode("view",{class:"menu-card"},[e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[0]||(a[0]=e=>l.goTo("/pages/admin/users"))},[e.createElementVNode("view",{class:"menu-icon-wrap blue"},"ğŸ‘¥"),e.createElementVNode("text",{class:"menu-text"},"ç”¨æˆ·")]),e.createElementVNode("view",{class:"menu-item",onClick:a[1]||(a[1]=e=>l.goTo("/pages/admin/domains"))},[e.createElementVNode("view",{class:"menu-icon-wrap green"},"ğŸŒ"),e.createElementVNode("text",{class:"menu-text"},"åŸŸå")]),e.createElementVNode("view",{class:"menu-item",onClick:a[2]||(a[2]=e=>l.goTo("/pages/admin/cf-accounts"))},[e.createElementVNode("view",{class:"menu-icon-wrap yellow"},"â˜ï¸"),e.createElementVNode("text",{class:"menu-text"},"æ¸ é“")]),e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=e=>l.goTo("/pages/admin/plans"))},[e.createElementVNode("view",{class:"menu-icon-wrap purple"},"ğŸ“¦"),e.createElementVNode("text",{class:"menu-text"},"å¥—é¤")])]),e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[4]||(a[4]=e=>l.goTo("/pages/admin/redeem"))},[e.createElementVNode("view",{class:"menu-icon-wrap orange"},"ğŸ«"),e.createElementVNode("text",{class:"menu-text"},"å¡å¯†")]),e.createElementVNode("view",{class:"menu-item",onClick:a[5]||(a[5]=e=>l.goTo("/pages/admin/coupons"))},[e.createElementVNode("view",{class:"menu-icon-wrap pink"},"ğŸ"),e.createElementVNode("text",{class:"menu-text"},"ä¼˜æƒ åˆ¸")]),e.createElementVNode("view",{class:"menu-item",onClick:a[6]||(a[6]=e=>l.goTo("/pages/admin/orders"))},[e.createElementVNode("view",{class:"menu-icon-wrap cyan"},"ğŸ“‹"),e.createElementVNode("text",{class:"menu-text"},"è®¢å•")]),e.createElementVNode("view",{class:"menu-item",onClick:a[7]||(a[7]=e=>l.goTo("/pages/admin/subdomains"))},[e.createElementVNode("view",{class:"menu-icon-wrap teal"},"ğŸ”—"),e.createElementVNode("text",{class:"menu-text"},"å­åŸŸå")])]),e.createElementVNode("view",{class:"menu-row"},[e.createElementVNode("view",{class:"menu-item",onClick:a[8]||(a[8]=e=>l.goTo("/pages/admin/dns-records"))},[e.createElementVNode("view",{class:"menu-icon-wrap red"},"ğŸ“"),e.createElementVNode("text",{class:"menu-text"},"DNS")]),e.createElementVNode("view",{class:"menu-item",onClick:a[9]||(a[9]=e=>l.goTo("/pages/admin/app-versions"))},[e.createElementVNode("view",{class:"menu-icon-wrap indigo"},"ğŸ“±"),e.createElementVNode("text",{class:"menu-text"},"APPç‰ˆæœ¬")]),e.createElementVNode("view",{class:"menu-item",style:{visibility:"hidden"}},[e.createElementVNode("view",{class:"menu-icon-wrap"}),e.createElementVNode("text",{class:"menu-text"})]),e.createElementVNode("view",{class:"menu-item",style:{visibility:"hidden"}},[e.createElementVNode("view",{class:"menu-icon-wrap"}),e.createElementVNode("text",{class:"menu-text"})])])])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("text",{class:"section-title"},"ç³»ç»ŸåŠŸèƒ½"),e.createElementVNode("view",{class:"func-list"},[e.createElementVNode("view",{class:"func-item",onClick:a[10]||(a[10]=e=>l.goTo("/pages/admin/announcements"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon pink"},"ğŸ“¢"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"å…¬å‘Šç®¡ç†"),e.createElementVNode("text",{class:"func-desc"},"å‘å¸ƒå’Œç®¡ç†ç³»ç»Ÿå…¬å‘Š")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")]),e.createElementVNode("view",{class:"func-item",onClick:a[11]||(a[11]=e=>l.goTo("/pages/admin/logs"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon brown"},"ğŸ“œ"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"æ“ä½œæ—¥å¿—"),e.createElementVNode("text",{class:"func-desc"},"æŸ¥çœ‹ç³»ç»Ÿæ“ä½œè®°å½•")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")]),e.createElementVNode("view",{class:"func-item",onClick:a[12]||(a[12]=e=>l.goTo("/pages/admin/settings"))},[e.createElementVNode("view",{class:"func-left"},[e.createElementVNode("view",{class:"func-icon gray"},"âš™ï¸"),e.createElementVNode("view",{class:"func-info"},[e.createElementVNode("text",{class:"func-name"},"ç³»ç»Ÿè®¾ç½®"),e.createElementVNode("text",{class:"func-desc"},"é…ç½®ç³»ç»Ÿå‚æ•°")])]),e.createElementVNode("text",{class:"func-arrow"},"â€º")])])]),e.createElementVNode("view",{class:"bottom-space"})])}]]);const I=s({data:()=>({users:[],searchKey:"",page:1,hasMore:!0,loading:!1,showModal:!1,currentUser:{},editBalance:"",editMaxDomains:"",userInfo:null,roles:[{value:"user",label:"ç”¨æˆ·"},{value:"admin",label:"ç®¡ç†å‘˜"},{value:"demo",label:"æ¼”ç¤º"}]}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadUsers()},methods:{async loadUsers(){var e,t;if(!this.loading){this.loading=!0;try{const a=await function(e={}){return n({url:"/admin/users",method:"GET",data:e})}({page:this.page,per_page:20,search:this.searchKey}),s=(null==(e=a.data)?void 0:e.users)||[];1===this.page?this.users=s:this.users=[...this.users,...s];const o=(null==(t=a.data)?void 0:t.pagination)||{};this.hasMore=this.page<o.pages}catch(a){}this.loading=!1}},handleSearch(){this.page=1,this.loadUsers()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadUsers())},showUserDetail(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentUser={...e},this.editBalance=String(e.balance||0),this.editMaxDomains=String(e.max_domains||0),this.showModal=!0)},onRoleChange(e){this.currentUser.role=this.roles[e.detail.value].value},onStatusChange(e){this.currentUser.status=e.detail.value?1:0},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentUser.id,t={role:this.currentUser.role,status:this.currentUser.status,balance:parseFloat(this.editBalance),max_domains:parseInt(this.editMaxDomains)},n({url:`/admin/users/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadUsers()}catch(a){uni.hideLoading()}var e,t},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· ${this.currentUser.username} å—ï¼Ÿæ­¤æ“ä½œå°†åŒæ—¶åˆ é™¤è¯¥ç”¨æˆ·çš„æ‰€æœ‰åŸŸåå’Œè®°å½•ï¼`,confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentUser.id,n({url:`/admin/users/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadUsers()}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ç”¨æˆ·ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.users.length)+" ä½ç”¨æˆ·",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.searchKey=e),placeholder:"æœç´¢ç”¨æˆ·å/é‚®ç®±",onConfirm:a[1]||(a[1]=(...e)=>l.handleSearch&&l.handleSearch(...e))},null,544),[[e.vModelText,n.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>l.handleSearch&&l.handleSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"user-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.users,(t=>{var a,s;return e.openBlock(),e.createElementBlock("view",{class:"user-card",key:t.id,onClick:e=>l.showUserDetail(t)},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("view",{class:e.normalizeClass(["user-avatar",{admin:"admin"===t.role}])},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString((null==(s=null==(a=t.username)?void 0:a.charAt(0))?void 0:s.toUpperCase())||"U"),1)],2)]),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("view",{class:"user-row"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:e.normalizeClass(["role-tag",t.role])},e.toDisplayString("admin"===t.role?"ç®¡ç†å‘˜":"ç”¨æˆ·"),3)]),e.createElementVNode("text",{class:"email"},e.toDisplayString(t.email),1),e.createElementVNode("view",{class:"user-stats"},[e.createElementVNode("view",{class:"stat-chip"},[e.createElementVNode("text",{class:"chip-label"},"ä½™é¢"),e.createElementVNode("text",{class:"chip-value"},e.toDisplayString(t.balance_text),1)]),e.createElementVNode("view",{class:"stat-chip"},[e.createElementVNode("text",{class:"chip-label"},"åŸŸå"),e.createElementVNode("text",{class:"chip-value"},e.toDisplayString(t.used_domains)+"/"+e.toDisplayString(t.max_domains),1)])])]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"æ­£å¸¸":"ç¦ç”¨"),3),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])})),128)),0!==n.users.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ‘¥"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ç”¨æˆ·")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[11]||(a[11]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”¨æˆ·è¯¦æƒ…"),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"ç”¨æˆ·å"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.currentUser.username),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"é‚®ç®±"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.currentUser.email),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"è§’è‰²"),e.createElementVNode("picker",{range:n.roles,"range-key":"label",onChange:a[4]||(a[4]=(...e)=>l.onRoleChange&&l.onRoleChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString("admin"===n.currentUser.role?"ç®¡ç†å‘˜":"ç”¨æˆ·"),1)],40,["range"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===n.currentUser.status,onChange:a[5]||(a[5]=(...e)=>l.onStatusChange&&l.onStatusChange(...e))},null,40,["checked"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"ä½™é¢"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"digit","onUpdate:modelValue":a[6]||(a[6]=e=>n.editBalance=e),placeholder:"è¾“å…¥ä½™é¢"},null,512),[[e.vModelText,n.editBalance]])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åŸŸåä¸Šé™"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>n.editMaxDomains=e),placeholder:"è¾“å…¥ä¸Šé™"},null,512),[[e.vModelText,n.editMaxDomains]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[9]||(a[9]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const A=s({data:()=>({domains:[],channels:[],zones:[],selectedChannel:null,selectedZone:null,showModal:!1,isEdit:!1,currentId:null,zonesLoading:!1,userInfo:null,form:{name:"",description:"",allow_register:!0,zone_id:"",dns_channel_id:null}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadDomains(),this.loadChannels()},methods:{async loadDomains(){var e;try{const t=await B();this.domains=(null==(e=t.data)?void 0:e.domains)||[]}catch(a){t("error","at pages/admin/domains.vue:142","åŠ è½½åŸŸåå¤±è´¥:",a)}},async loadChannels(){var e;try{const t=await P();this.channels=(null==(e=t.data)?void 0:e.channels)||[]}catch(a){t("error","at pages/admin/domains.vue:150","åŠ è½½æ¸ é“å¤±è´¥:",a)}},async onChannelChange(e){var a;if(this.selectedChannel=this.channels[e.detail.value],this.selectedZone=null,this.zones=[],this.selectedChannel){this.zonesLoading=!0;try{const e=await function(e,t={}){return n({url:`/admin/channels/${e}/zones`,method:"GET",data:t})}(this.selectedChannel.id);this.zones=(null==(a=e.data)?void 0:a.zones)||[]}catch(s){t("error","at pages/admin/domains.vue:163","åŠ è½½Zoneå¤±è´¥:",s)}finally{this.zonesLoading=!1}}},onZoneChange(e){this.selectedZone=this.zones[e.detail.value]},showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.selectedChannel=null,this.selectedZone=null,this.zones=[],this.form={name:"",description:"",allow_register:!0,zone_id:"",dns_channel_id:null},this.showModal=!0)},editDomain(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.selectedChannel=e.channel,this.selectedZone=null,this.form={name:e.name,description:e.description||"",allow_register:e.allow_register,zone_id:e.zone_id,dns_channel_id:e.dns_channel_id},this.showModal=!0)},async toggleStatus(e){if(this.isDemo)uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ä¿®æ”¹",icon:"none"});else try{await M(e.id,{status:1===e.status?0:1}),this.loadDomains()}catch(a){t("error","at pages/admin/domains.vue:220","æ›´æ–°çŠ¶æ€å¤±è´¥:",a)}},async handleSave(){var e;if(this.isEdit||this.selectedChannel&&this.selectedZone)try{uni.showLoading({title:this.isEdit?"ä¿å­˜ä¸­...":"æ·»åŠ ä¸­..."}),this.isEdit?await M(this.currentId,{description:this.form.description,allow_register:this.form.allow_register}):await(e={dns_channel_id:this.selectedChannel.id,name:this.selectedZone.name,zone_id:this.selectedZone.id,description:this.form.description,allow_register:this.form.allow_register},n({url:"/admin/domains",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:this.isEdit?"ä¿å­˜æˆåŠŸ":"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadDomains()}catch(t){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©æ¸ é“å’ŒZone",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåŸŸåå—ï¼Ÿéœ€å…ˆåˆ é™¤è¯¥åŸŸåä¸‹çš„æ‰€æœ‰äºŒçº§åŸŸåå’Œå¥—é¤ã€‚",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,n({url:`/admin/domains/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadDomains()}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){var i,c;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.domains.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"domain-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"domain-card",key:t.id},[e.createElementVNode("view",{class:"card-main",onClick:e=>l.editDomain(t)},[e.createElementVNode("view",{class:"domain-row"},[e.createElementVNode("text",{class:"domain-name"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",{open:t.allow_register}])},e.toDisplayString(t.allow_register?"å¼€æ”¾":"å…³é—­"),3)]),e.createElementVNode("view",{class:"domain-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-label"},"äºŒçº§åŸŸå"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(t.subdomains_count),1)]),t.channel?(e.openBlock(),e.createElementBlock("view",{key:0,class:"stat-item"},[e.createElementVNode("text",{class:"stat-label"},"æ¸ é“"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(t.channel.name),1)])):e.createCommentVNode("",!0)]),t.description?(e.openBlock(),e.createElementBlock("text",{key:0,class:"domain-desc"},e.toDisplayString(t.description),1)):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"card-action"},[e.createElementVNode("switch",{checked:1===t.status,onChange:e=>l.toggleStatus(t)},null,40,["checked","onChange"])])])))),128)),0===n.domains.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸŒ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— åŸŸå")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>l.showAdd&&l.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("scroll-view",{class:"modal-content","scroll-y":""},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.isEdit?"ç¼–è¾‘åŸŸå":"æ·»åŠ åŸŸå"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"DNSæ¸ é“"),e.createElementVNode("picker",{range:n.channels,"range-key":"name",onChange:a[1]||(a[1]=(...e)=>l.onChannelChange&&l.onChannelChange(...e)),disabled:n.isEdit},[e.createElementVNode("view",{class:"picker"},e.toDisplayString((null==(i=n.selectedChannel)?void 0:i.name)||"è¯·é€‰æ‹©"),1)],40,["range","disabled"])]),n.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"Zone"),e.createElementVNode("picker",{range:n.zones,"range-key":"name",onChange:a[2]||(a[2]=(...e)=>l.onZoneChange&&l.onZoneChange(...e)),disabled:!n.selectedChannel||n.zonesLoading},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(n.zonesLoading?"åŠ è½½ä¸­...":(null==(c=n.selectedZone)?void 0:c.name)||"è¯·é€‰æ‹©"),1)],40,["range","disabled"])])),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"åŸŸå"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.form.name),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æè¿°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>n.form.description=e),placeholder:"å¯é€‰"},null,512),[[e.vModelText,n.form.description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¼€æ”¾æ³¨å†Œ"),e.createElementVNode("switch",{checked:n.form.allow_register,onChange:a[4]||(a[4]=e=>n.form.allow_register=e.detail.value)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[6]||(a[6]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.isEdit?"ä¿å­˜":"æ·»åŠ "),1)])])])])):e.createCommentVNode("",!0)])}]]);const U=s({data:()=>({plans:[],rawPlans:[],domains:[],domainOptions:[{id:0,name:"å…¨éƒ¨åŸŸå"}],filterDomain:null,showAddModal:!1,showEditModal:!1,currentPlanIds:[],userInfo:null,newPlan:{name:"",price:"",duration_days:"30",min_length:"1",max_length:"63",max_records:"10",domain_ids:[]},editData:{name:"",price:"",duration_days:"",min_length:"",max_length:"",max_records:"",status:1,domain_ids:[]}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadDomains(),this.loadPlans()},methods:{getDomainList:e=>e.domain_names&&Array.isArray(e.domain_names)?e.domain_names:e.domain_name?[e.domain_name]:[],mergePlansByName(e){const t=new Map;return e.forEach((e=>{const a=e.name;if(t.has(a)){const s=t.get(a);e.domain_name&&!s.domain_names.includes(e.domain_name)&&s.domain_names.push(e.domain_name),e.domain_id&&!s.domain_ids.includes(e.domain_id)&&s.domain_ids.push(e.domain_id),s.plan_ids.push(e.id)}else t.set(a,{...e,domain_names:e.domain_name?[e.domain_name]:[],domain_ids:e.domain_id?[e.domain_id]:[],plan_ids:[e.id]})})),Array.from(t.values())},async loadDomains(){var e;try{const t=await B();this.domains=(null==(e=t.data)?void 0:e.domains)||[],this.domainOptions=[{id:0,name:"å…¨éƒ¨åŸŸå"},...this.domains]}catch(t){}},async loadPlans(){var e,t;try{const a={};(null==(e=this.filterDomain)?void 0:e.id)&&(a.domain_id=this.filterDomain.id);const s=await function(e={}){return n({url:"/admin/plans",method:"GET",data:e})}(a);this.rawPlans=(null==(t=s.data)?void 0:t.plans)||[],this.plans=this.mergePlansByName(this.rawPlans)}catch(a){}},onDomainFilter(e){this.filterDomain=this.domainOptions[e.detail.value],0===this.filterDomain.id&&(this.filterDomain=null),this.loadPlans()},async openAddModal(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(0===this.domains.length&&await this.loadDomains(),this.newPlan={name:"",price:"",duration_days:"30",min_length:"1",max_length:"63",max_records:"10",domain_ids:[]},this.showAddModal=!0)},toggleNewDomain(e){const t=this.newPlan.domain_ids.findIndex((t=>t==e));t>-1?this.newPlan.domain_ids.splice(t,1):this.newPlan.domain_ids.push(e)},toggleEditDomain(e){const t=this.editData.domain_ids.findIndex((t=>t==e));t>-1?this.editData.domain_ids.splice(t,1):this.editData.domain_ids.push(e)},isDomainChecked:(e,t)=>t.some((t=>t==e)),async handleAdd(){var e;if(this.isDemo)uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"});else if(this.newPlan.name)if(0!==this.newPlan.domain_ids.length)try{uni.showLoading({title:"æ·»åŠ ä¸­..."}),await(e={domain_ids:this.newPlan.domain_ids,name:this.newPlan.name,price:parseFloat(this.newPlan.price)||0,duration_days:parseInt(this.newPlan.duration_days)||30,min_length:parseInt(this.newPlan.min_length)||1,max_length:parseInt(this.newPlan.max_length)||63,max_records:parseInt(this.newPlan.max_records)||10},n({url:"/admin/plans",method:"POST",data:e})),uni.hideLoading(),uni.showToast({title:"æ·»åŠ æˆåŠŸ",icon:"success"}),this.showAddModal=!1,this.loadPlans()}catch(t){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©å…³è”åŸŸå",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¥—é¤åç§°",icon:"none"})},async editPlan(e){if(this.isDemo)return void uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"});0===this.domains.length&&await this.loadDomains(),this.currentPlanIds=e.plan_ids||[e.id];const t=e.domain_ids?[...e.domain_ids]:[];this.editData={name:e.name,price:String(e.price||0),duration_days:String(e.duration_days||30),min_length:String(e.min_length||1),max_length:String(e.max_length||63),max_records:String(e.max_records||10),status:e.status,domain_ids:t},this.showEditModal=!0},async handleUpdate(){var e,t;if(this.editData.name)if(0!==this.editData.domain_ids.length)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentPlanIds[0],t={domain_ids:this.editData.domain_ids,name:this.editData.name,price:parseFloat(this.editData.price)||0,duration_days:parseInt(this.editData.duration_days)||30,min_length:parseInt(this.editData.min_length)||1,max_length:parseInt(this.editData.max_length)||63,max_records:parseInt(this.editData.max_records)||10,status:this.editData.status},n({url:`/admin/plans/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showEditModal=!1,this.loadPlans()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·é€‰æ‹©å…³è”åŸŸå",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥å¥—é¤åç§°",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¥—é¤å—ï¼Ÿå°†åˆ é™¤æ‰€æœ‰å…³è”åŸŸåçš„å¥—é¤è®°å½•",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{uni.showLoading({title:"åˆ é™¤ä¸­..."});for(const e of this.currentPlanIds)await(t=e,n({url:`/admin/plans/${t}`,method:"DELETE"}));uni.hideLoading(),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showEditModal=!1,this.loadPlans()}catch(a){uni.hideLoading()}var t}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å¥—é¤ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.plans.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:n.domainOptions,"range-key":"name",onChange:a[0]||(a[0]=(...e)=>l.onDomainFilter&&l.onDomainFilter(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString((null==(i=n.filterDomain)?void 0:i.name)||"å…¨éƒ¨åŸŸå"),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"plan-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.plans,(t=>(e.openBlock(),e.createElementBlock("view",{class:"plan-card",key:t.id,onClick:e=>l.editPlan(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"plan-title"},[e.createElementVNode("text",{class:"plan-name"},e.toDisplayString(t.name),1),e.createElementVNode("view",{class:e.normalizeClass(["plan-badge",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å¯ç”¨":"ç¦ç”¨"),3)]),e.createElementVNode("text",{class:"plan-price"},"Â¥"+e.toDisplayString(t.price),1)]),e.createElementVNode("view",{class:"domain-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.getDomainList(t),((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"domain-tag",key:a},e.toDisplayString(t),1)))),128))]),e.createElementVNode("view",{class:"plan-specs"},[e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"æ—¶é•¿"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.duration_text),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"é•¿åº¦"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.min_length)+"-"+e.toDisplayString(t.max_length),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createElementVNode("text",{class:"spec-label"},"è®°å½•"),e.createElementVNode("text",{class:"spec-value"},e.toDisplayString(t.max_records_text),1)])])],8,["onClick"])))),128)),0===n.plans.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¦"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¥—é¤")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[1]||(a[1]=(...e)=>l.openAddModal&&l.openAddModal(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showAddModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[10]||(a[10]=e.withModifiers((e=>n.showAddModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-scroll"},[e.createElementVNode("text",{class:"modal-title"},"æ·»åŠ å¥—é¤"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¥—é¤åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[2]||(a[2]=e=>n.newPlan.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,n.newPlan.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä»·æ ¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[3]||(a[3]=e=>n.newPlan.price=e),placeholder:"0"},null,512),[[e.vModelText,n.newPlan.price]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ‰æ•ˆå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>n.newPlan.duration_days=e),placeholder:"-1ä¸ºæ°¸ä¹…"},null,512),[[e.vModelText,n.newPlan.duration_days]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å°é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[5]||(a[5]=e=>n.newPlan.min_length=e),placeholder:"1"},null,512),[[e.vModelText,n.newPlan.min_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>n.newPlan.max_length=e),placeholder:"63"},null,512),[[e.vModelText,n.newPlan.max_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§è®°å½•æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>n.newPlan.max_records=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,n.newPlan.max_records]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å…³è”åŸŸåï¼ˆå¯å¤šé€‰ï¼‰"),n.domains.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkbox-group"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"checkbox-item",key:t.id,onClick:e=>l.toggleNewDomain(t.id)},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:l.isDomainChecked(t.id,n.newPlan.domain_ids)}])},"âœ“",2),e.createElementVNode("text",null,e.toDisplayString(t.name),1)],8,["onClick"])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æ— å¯é€‰åŸŸå")]))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>n.showAddModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[9]||(a[9]=(...e)=>l.handleAdd&&l.handleAdd(...e))},[e.createElementVNode("text",null,"æ·»åŠ ")])])])])])):e.createCommentVNode("",!0),n.showEditModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[21]||(a[21]=e.withModifiers((e=>n.showEditModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-scroll"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘å¥—é¤"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¥—é¤åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[11]||(a[11]=e=>n.editData.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,n.editData.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä»·æ ¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[12]||(a[12]=e=>n.editData.price=e),placeholder:"0"},null,512),[[e.vModelText,n.editData.price]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ‰æ•ˆå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[13]||(a[13]=e=>n.editData.duration_days=e),placeholder:"-1ä¸ºæ°¸ä¹…"},null,512),[[e.vModelText,n.editData.duration_days]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å°é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[14]||(a[14]=e=>n.editData.min_length=e),placeholder:"1"},null,512),[[e.vModelText,n.editData.min_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§é•¿åº¦"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[15]||(a[15]=e=>n.editData.max_length=e),placeholder:"63"},null,512),[[e.vModelText,n.editData.max_length]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§è®°å½•æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[16]||(a[16]=e=>n.editData.max_records=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,n.editData.max_records]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å…³è”åŸŸåï¼ˆå¯å¤šé€‰ï¼‰"),n.domains.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkbox-group"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.domains,(t=>(e.openBlock(),e.createElementBlock("view",{class:"checkbox-item",key:t.id,onClick:e=>l.toggleEditDomain(t.id)},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:l.isDomainChecked(t.id,n.editData.domain_ids)}])},"âœ“",2),e.createElementVNode("text",null,e.toDisplayString(t.name),1)],8,["onClick"])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-tip"},[e.createElementVNode("text",null,"æš‚æ— å¯é€‰åŸŸå")]))]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===n.editData.status,onChange:a[17]||(a[17]=e=>n.editData.status=e.detail.value?1:0)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[18]||(a[18]=e=>n.showEditModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[19]||(a[19]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[20]||(a[20]=(...e)=>l.handleUpdate&&l.handleUpdate(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])])):e.createCommentVNode("",!0)])}]]);const R=s({data:()=>({codes:[],statusFilter:"all",page:1,hasMore:!0,loading:!1,showGenModal:!1,showResultModal:!1,generatedCodes:[],userInfo:null,genForm:{amount:"",count:"10",expires_days:""}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadCodes()},methods:{async loadCodes(){var e,t;if(!this.loading){this.loading=!0;try{const a={page:this.page,per_page:20};"unused"===this.statusFilter?a.status=0:"used"===this.statusFilter&&(a.status=1);const s=await function(e={}){return n({url:"/admin/redeem-codes",method:"GET",data:e})}(a),o=(null==(e=s.data)?void 0:e.codes)||[];1===this.page?this.codes=o:this.codes=[...this.codes,...o];const l=(null==(t=s.data)?void 0:t.pagination)||{};this.hasMore=this.page<l.pages}catch(a){}this.loading=!1}},setFilter(e){this.statusFilter=e,this.page=1,this.loadCodes()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadCodes())},formatTime:e=>e?e.split("T")[0]:"",formatUser:e=>e?"string"==typeof e?e:e.username||e.email||"æœªçŸ¥ç”¨æˆ·":"",showGenerate(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç”Ÿæˆ",icon:"none"}):this.showGenModal=!0},async handleGenerate(){var e,t;if(this.genForm.amount&&this.genForm.count)try{uni.showLoading({title:"ç”Ÿæˆä¸­..."});const a={amount:parseFloat(this.genForm.amount),count:parseInt(this.genForm.count)};this.genForm.expires_days&&(a.expires_days=parseInt(this.genForm.expires_days));const s=await(t=a,n({url:"/admin/redeem-codes/generate",method:"POST",data:t}));uni.hideLoading(),this.generatedCodes=((null==(e=s.data)?void 0:e.codes)||[]).map((e=>e.code||e)),this.showGenModal=!1,this.showResultModal=!0,this.page=1,this.loadCodes()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"})},copyAll(){const e=this.generatedCodes.join("\n");uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"å·²å¤åˆ¶",icon:"success"}),this.showResultModal=!1}})},copyCode(e){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"å¡å¯†å·²å¤åˆ¶",icon:"success"})}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å¡å¯†ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.codes.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"all"===n.statusFilter}]),onClick:a[0]||(a[0]=e=>l.setFilter("all"))},[e.createElementVNode("text",{class:"filter-text"},"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"unused"===n.statusFilter}]),onClick:a[1]||(a[1]=e=>l.setFilter("unused"))},[e.createElementVNode("text",{class:"filter-text"},"æœªä½¿ç”¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"used"===n.statusFilter}]),onClick:a[2]||(a[2]=e=>l.setFilter("used"))},[e.createElementVNode("text",{class:"filter-text"},"å·²ä½¿ç”¨")],2)])]),e.createElementVNode("view",{class:"code-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.codes,(t=>(e.openBlock(),e.createElementBlock("view",{class:"code-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["code-badge",{used:1===t.status}])},e.toDisplayString(0===t.status?"æœªä½¿ç”¨":"å·²ä½¿ç”¨"),3),e.createElementVNode("text",{class:"code-amount"},e.toDisplayString(t.amount_text||"Â¥"+t.amount),1)]),e.createElementVNode("view",{class:"code-body",onClick:e=>l.copyCode(t.code)},[e.createElementVNode("text",{class:"code-text"},e.toDisplayString(t.code),1),e.createElementVNode("text",{class:"copy-btn"},"ğŸ“‹")],8,["onClick"]),e.createElementVNode("view",{class:"code-footer"},[t.used_by?(e.openBlock(),e.createElementBlock("text",{key:0,class:"code-user"},"ä½¿ç”¨è€…: "+e.toDisplayString(l.formatUser(t.used_by)),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"code-time"},e.toDisplayString(l.formatTime(t.created_at)),1)])])))),128)),0!==n.codes.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ«"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å¡å¯†")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fab",onClick:a[4]||(a[4]=(...e)=>l.showGenerate&&l.showGenerate(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showGenModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[10]||(a[10]=e.withModifiers((e=>n.showGenModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”Ÿæˆå¡å¯†"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å……å€¼é‡‘é¢"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[5]||(a[5]=e=>n.genForm.amount=e),placeholder:"-1ä¸ºæ— é™"},null,512),[[e.vModelText,n.genForm.amount]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>n.genForm.count=e),placeholder:"1-100"},null,512),[[e.vModelText,n.genForm.count]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è¿‡æœŸå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>n.genForm.expires_days=e),placeholder:"ç•™ç©ºä¸è¿‡æœŸ"},null,512),[[e.vModelText,n.genForm.expires_days]])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>n.showGenModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[9]||(a[9]=(...e)=>l.handleGenerate&&l.handleGenerate(...e))},[e.createElementVNode("text",null,"ç”Ÿæˆ")])])])])):e.createCommentVNode("",!0),n.showResultModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[12]||(a[12]=e.withModifiers((e=>n.showResultModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç”ŸæˆæˆåŠŸ"),e.createElementVNode("view",{class:"result-codes"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.generatedCodes,((t,a)=>(e.openBlock(),e.createElementBlock("text",{class:"result-code",key:a},e.toDisplayString(t),1)))),128))]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[11]||(a[11]=(...e)=>l.copyAll&&l.copyAll(...e))},[e.createElementVNode("text",null,"å¤åˆ¶å…¨éƒ¨")])])])])):e.createCommentVNode("",!0)])}]]);const F=s({data:()=>({orders:[],searchKey:"",page:1,hasMore:!0,loading:!1}),onLoad(){this.loadOrders()},methods:{async loadOrders(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.searchKey&&(t.search=this.searchKey);const s=await function(e={}){return n({url:"/admin/purchase-records",method:"GET",data:e})}(t),o=(null==(e=s.data)?void 0:e.records)||[];1===this.page?this.orders=o:this.orders=[...this.orders,...o];const l=(null==(a=s.data)?void 0:a.pagination)||{};this.hasMore=this.page<l.pages}catch(s){t("error","at pages/admin/orders.vue:89","è®¢å•åŠ è½½å¤±è´¥:",s)}this.loading=!1}},doSearch(){this.page=1,this.loadOrders()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadOrders())},formatTime:e=>e?e.replace("T"," ").substring(0,16):""}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"è®¢å•ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.orders.length)+" æ¡",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.searchKey=e),placeholder:"æœç´¢åŸŸå/å¥—é¤å",onConfirm:a[1]||(a[1]=(...e)=>l.doSearch&&l.doSearch(...e))},null,544),[[e.vModelText,n.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>l.doSearch&&l.doSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"order-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.orders,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"order-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"order-domain"},e.toDisplayString(t.subdomain_name),1),e.createElementVNode("text",{class:"order-price"},e.toDisplayString(t.price_text||"Â¥"+t.price),1)]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"ç”¨æˆ·"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(null==(a=t.user)?void 0:a.username),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"å¥—é¤"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.plan_name),1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"order-duration"},e.toDisplayString(t.duration_text),1),e.createElementVNode("text",{class:"order-time"},e.toDisplayString(l.formatTime(t.created_at)),1)])])})),128)),0!==n.orders.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— è®¢å•")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0)])}]]);const $=s({data:()=>({announcements:[],showModal:!1,isEdit:!1,currentId:null,userInfo:null,form:{title:"",content:"",is_important:!1,status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadAnnouncements()},methods:{async loadAnnouncements(){var e;try{const t=await function(e={}){return n({url:"/admin/announcements",method:"GET",data:e})}();this.announcements=(null==(e=t.data)?void 0:e.announcements)||[]}catch(t){}},formatTime:e=>e?e.split("T")[0]:"",showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.form={title:"",content:"",is_important:!1,status:1},this.showModal=!0)},editAnnouncement(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.form={title:e.title,content:e.content,is_important:e.is_important,status:e.status},this.showModal=!0)},async handleSave(){var e,t;if(this.form.title&&this.form.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),this.isEdit?await(e=this.currentId,t=this.form,n({url:`/admin/announcements/${e}`,method:"PUT",data:t})):await function(e){return n({url:"/admin/announcements",method:"POST",data:e})}(this.form),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadAnnouncements()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡å…¬å‘Šå—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,n({url:`/admin/announcements/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadAnnouncements()}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"å…¬å‘Šç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.announcements.length)+" æ¡",1)]),e.createElementVNode("view",{class:"announcement-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.announcements,(t=>(e.openBlock(),e.createElementBlock("view",{class:"announcement-card",key:t.id,onClick:e=>l.editAnnouncement(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"tag-row"},[t.is_important?(e.openBlock(),e.createElementBlock("view",{key:0,class:"important-tag"},"ğŸ”¥ é‡è¦")):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å·²å‘å¸ƒ":"å·²ä¸‹æ¶"),3)])]),e.createElementVNode("text",{class:"card-content"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(l.formatTime(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0===n.announcements.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¢"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— å…¬å‘Š")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>l.showAdd&&l.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[8]||(a[8]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.isEdit?"ç¼–è¾‘å…¬å‘Š":"æ·»åŠ å…¬å‘Š"),1),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ ‡é¢˜"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[1]||(a[1]=e=>n.form.title=e),placeholder:"è¾“å…¥æ ‡é¢˜"},null,512),[[e.vModelText,n.form.title]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"å†…å®¹"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[2]||(a[2]=e=>n.form.content=e),placeholder:"è¾“å…¥å†…å®¹"},null,512),[[e.vModelText,n.form.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é‡è¦å…¬å‘Š"),e.createElementVNode("switch",{checked:n.form.is_important,onChange:a[3]||(a[3]=e=>n.form.is_important=e.detail.value)},null,40,["checked"])]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"å‘å¸ƒçŠ¶æ€"),e.createElementVNode("switch",{checked:1===n.form.status,onChange:a[4]||(a[4]=e=>n.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[6]||(a[6]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[7]||(a[7]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const z=s({data:()=>({userInfo:null,settings:{site_name:"",site_description:"",admin_email:"",smtp_host:"",smtp_port:"",smtp_user:"",smtp_password:"",smtp_ssl:"1",redeem_channel_text:"",redeem_channel_url:""}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){if(this.userInfo=h(),this.isDemo)return uni.showToast({title:"æ¼”ç¤ºç”¨æˆ·æ— æƒè®¿é—®è®¾ç½®",icon:"none"}),void setTimeout((()=>{uni.navigateBack()}),1500);this.loadSettings()},methods:{async loadSettings(){var e;try{const t=await n({url:"/admin/settings",method:"GET"});this.settings={...this.settings,...null==(e=t.data)?void 0:e.settings}}catch(t){}},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.settings,n({url:"/admin/settings",method:"PUT",data:e})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"})}catch(t){uni.hideLoading()}var e},testSmtpConfig(){uni.showModal({title:"æµ‹è¯•SMTP",editable:!0,placeholderText:"è¾“å…¥æµ‹è¯•é‚®ç®±",success:async e=>{if(e.confirm&&e.content)try{uni.showLoading({title:"å‘é€ä¸­..."}),await(t=e.content,n({url:"/admin/settings/test-smtp",method:"POST",data:{email:t}})),uni.hideLoading(),uni.showToast({title:"å‘é€æˆåŠŸ",icon:"success"})}catch(a){uni.hideLoading()}var t}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"section-title"},"ç«™ç‚¹è®¾ç½®"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç«™ç‚¹åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[0]||(a[0]=e=>n.settings.site_name=e),placeholder:"è¾“å…¥ç«™ç‚¹åç§°"},null,512),[[e.vModelText,n.settings.site_name]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"ç«™ç‚¹æè¿°"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[1]||(a[1]=e=>n.settings.site_description=e),placeholder:"è¾“å…¥æè¿°"},null,512),[[e.vModelText,n.settings.site_description]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç®¡ç†å‘˜é‚®ç®±"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[2]||(a[2]=e=>n.settings.admin_email=e),placeholder:"è¾“å…¥é‚®ç®±"},null,512),[[e.vModelText,n.settings.admin_email]])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"section-title"},"SMTPè®¾ç½®"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTPæœåŠ¡å™¨"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>n.settings.smtp_host=e),placeholder:"smtp.example.com"},null,512),[[e.vModelText,n.settings.smtp_host]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTPç«¯å£"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[4]||(a[4]=e=>n.settings.smtp_port=e),placeholder:"465"},null,512),[[e.vModelText,n.settings.smtp_port]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTPç”¨æˆ·å"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[5]||(a[5]=e=>n.settings.smtp_user=e),placeholder:"è¾“å…¥ç”¨æˆ·å"},null,512),[[e.vModelText,n.settings.smtp_user]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"SMTPå¯†ç "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"password","onUpdate:modelValue":a[6]||(a[6]=e=>n.settings.smtp_password=e),placeholder:"è¾“å…¥å¯†ç "},null,512),[[e.vModelText,n.settings.smtp_password]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¯ç”¨SSL"),e.createElementVNode("switch",{checked:"1"===n.settings.smtp_ssl,onChange:a[7]||(a[7]=e=>n.settings.smtp_ssl=e.detail.value?"1":"0")},null,40,["checked"])]),e.createElementVNode("view",{class:"test-btn",onClick:a[8]||(a[8]=(...e)=>l.testSmtpConfig&&l.testSmtpConfig(...e))},[e.createElementVNode("text",null,"æµ‹è¯•SMTPé…ç½®")])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"section-title"},"å¡å¯†æ¸ é“"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æŒ‰é’®æ–‡å­—"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[9]||(a[9]=e=>n.settings.redeem_channel_text=e),placeholder:"è´­ä¹°å¡å¯†"},null,512),[[e.vModelText,n.settings.redeem_channel_text]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"é“¾æ¥åœ°å€"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[10]||(a[10]=e=>n.settings.redeem_channel_url=e),placeholder:"https://..."},null,512),[[e.vModelText,n.settings.redeem_channel_url]])])]),e.createElementVNode("view",{class:"save-btn",onClick:a[11]||(a[11]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",{class:"save-text"},"ä¿å­˜è®¾ç½®")])])}]]);const O=s({data:()=>({channels:[],providers:[],showModal:!1,isEdit:!1,currentId:null,selectedProvider:null,userInfo:null,form:{name:"",provider_type:"",credentials:{},remark:"",status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)},credentialFields(){var e;return{cloudflare:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ Global API Key",secret:!0},{key:"email",label:"é‚®ç®±",placeholder:"è¾“å…¥ Cloudflare é‚®ç®±"}],aliyun:[{key:"access_key_id",label:"AccessKey ID",placeholder:"è¾“å…¥ AccessKey ID"},{key:"access_key_secret",label:"AccessKey Secret",placeholder:"è¾“å…¥ AccessKey Secret",secret:!0}],dnspod:[{key:"secret_id",label:"SecretId",placeholder:"è¾“å…¥ SecretId"},{key:"secret_key",label:"SecretKey",placeholder:"è¾“å…¥ SecretKey",secret:!0}],huawei:[{key:"ak",label:"AK",placeholder:"è¾“å…¥ Access Key"},{key:"sk",label:"SK",placeholder:"è¾“å…¥ Secret Key",secret:!0}],westcn:[{key:"username",label:"ç”¨æˆ·å",placeholder:"è¾“å…¥ç”¨æˆ·å"},{key:"api_password",label:"APIå¯†ç ",placeholder:"è¾“å…¥ API å¯†ç ",secret:!0}],route53:[{key:"access_key_id",label:"Access Key ID",placeholder:"è¾“å…¥ Access Key ID"},{key:"secret_access_key",label:"Secret Access Key",placeholder:"è¾“å…¥ Secret Access Key",secret:!0}],godaddy:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key"},{key:"api_secret",label:"API Secret",placeholder:"è¾“å…¥ API Secret",secret:!0}],namecheap:[{key:"api_user",label:"API User",placeholder:"è¾“å…¥ API User"},{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key",secret:!0},{key:"client_ip",label:"Client IP",placeholder:"è¾“å…¥ç™½åå• IP"}],namecom:[{key:"username",label:"ç”¨æˆ·å",placeholder:"è¾“å…¥ç”¨æˆ·å"},{key:"api_token",label:"API Token",placeholder:"è¾“å…¥ API Token",secret:!0}],baiducloud:[{key:"access_key",label:"Access Key",placeholder:"è¾“å…¥ Access Key"},{key:"secret_key",label:"Secret Key",placeholder:"è¾“å…¥ Secret Key",secret:!0}],namesilo:[{key:"api_key",label:"API Key",placeholder:"è¾“å…¥ API Key",secret:!0}]}[this.isEdit?this.form.provider_type:null==(e=this.selectedProvider)?void 0:e.type]||[]}},onLoad(){this.userInfo=h(),this.loadChannels(),this.loadProviders()},methods:{async loadChannels(){var e;try{const t=await P();this.channels=(null==(e=t.data)?void 0:e.channels)||[]}catch(a){t("error","at pages/admin/cf-accounts.vue:188","åŠ è½½æ¸ é“å¤±è´¥:",a)}},async loadProviders(){var e;try{const t=await n({url:"/admin/channels/providers",method:"GET"});this.providers=(null==(e=t.data)?void 0:e.providers)||[]}catch(t){this.providers=[{type:"cloudflare",name:"Cloudflare"},{type:"aliyun",name:"é˜¿é‡Œäº‘DNS"},{type:"dnspod",name:"è…¾è®¯äº‘DNSPod"},{type:"huawei",name:"åä¸ºäº‘DNS"},{type:"westcn",name:"è¥¿éƒ¨æ•°ç "},{type:"route53",name:"AWS Route53"},{type:"godaddy",name:"GoDaddy"},{type:"namecheap",name:"Namecheap"},{type:"namecom",name:"Name.com"},{type:"baiducloud",name:"ç™¾åº¦æ™ºèƒ½äº‘"},{type:"namesilo",name:"NameSilo"}]}},getProviderIcon:e=>({cloudflare:"â˜ï¸",aliyun:"ğŸŒ",dnspod:"ğŸ”·",huawei:"ğŸ”´",westcn:"ğŸŒ",route53:"ğŸŸ ",godaddy:"ğŸŸ¢",namecheap:"ğŸ”¶",namecom:"ğŸ“›",baiducloud:"ğŸ”µ",namesilo:"ğŸŸ£"}[e]||"â˜ï¸"),getProviderName(e){const t=this.providers.find((t=>t.type===e));return(null==t?void 0:t.name)||e},showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.selectedProvider=null,this.form={name:"",provider_type:"",credentials:{},remark:"",status:1},this.showModal=!0)},editChannel(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.selectedProvider=null,this.form={name:e.name,provider_type:e.provider_type,credentials:{},remark:e.remark||"",status:e.status},this.showModal=!0)},onProviderChange(e){this.selectedProvider=this.providers[e.detail.value],this.form.provider_type=this.selectedProvider.type,this.form.credentials={}},async handleVerify(){try{uni.showLoading({title:"éªŒè¯ä¸­..."}),await(e=this.currentId,n({url:`/admin/channels/${e}/verify`,method:"POST"})),uni.hideLoading(),uni.showToast({title:"éªŒè¯æˆåŠŸ",icon:"success"})}catch(t){uni.hideLoading(),uni.showToast({title:"éªŒè¯å¤±è´¥",icon:"none"})}var e},async handleSave(){if(this.form.name)if(this.isEdit||this.form.provider_type){if(!this.isEdit)for(const e of this.credentialFields)if(!this.form.credentials[e.key])return void uni.showToast({title:`è¯·è¾“å…¥${e.label}`,icon:"none"});try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={name:this.form.name,remark:this.form.remark};if(this.isEdit){e.status=this.form.status;const t={};for(const e in this.form.credentials)this.form.credentials[e]&&(t[e]=this.form.credentials[e]);Object.keys(t).length>0&&(e.credentials=t),await function(e,t){return n({url:`/admin/channels/${e}`,method:"PUT",data:t})}(this.currentId,e)}else e.provider_type=this.form.provider_type,e.credentials=this.form.credentials,await function(e){return n({url:"/admin/channels",method:"POST",data:e})}(e);uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadChannels()}catch(e){uni.hideLoading()}}else uni.showToast({title:"è¯·é€‰æ‹©æœåŠ¡å•†",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥æ¸ é“åç§°",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¸ é“å—ï¼Ÿéœ€å…ˆåˆ é™¤è¯¥æ¸ é“ä¸‹çš„æ‰€æœ‰åŸŸåã€‚",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentId,n({url:`/admin/channels/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadChannels()}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"æ¸ é“ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.channels.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"account-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.channels,(t=>(e.openBlock(),e.createElementBlock("view",{class:"account-card",key:t.id,onClick:e=>l.editChannel(t)},[e.createElementVNode("view",{class:"card-icon"},e.toDisplayString(l.getProviderIcon(t.provider_type)),1),e.createElementVNode("view",{class:"card-main"},[e.createElementVNode("text",{class:"account-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"account-email"},e.toDisplayString(l.getProviderName(t.provider_type)),1),e.createElementVNode("view",{class:"account-stats"},[e.createElementVNode("view",{class:e.normalizeClass(["auth-badge",{active:1===t.status}])},e.toDisplayString(1===t.status?"æ­£å¸¸":"ç¦ç”¨"),3),e.createElementVNode("text",{class:"stat-text"},e.toDisplayString(t.domains_count||0)+" åŸŸå",1),t.remark?(e.openBlock(),e.createElementBlock("text",{key:0,class:"stat-text"},"Â· "+e.toDisplayString(t.remark),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("text",{class:"card-arrow"},"â€º")],8,["onClick"])))),128)),0===n.channels.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"â˜ï¸"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ¸ é“")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[0]||(a[0]=(...e)=>l.showAdd&&l.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[9]||(a[9]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("scroll-view",{class:"modal-content","scroll-y":""},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.isEdit?"ç¼–è¾‘æ¸ é“":"æ·»åŠ æ¸ é“"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ¸ é“åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[1]||(a[1]=e=>n.form.name=e),placeholder:"è¾“å…¥åç§°"},null,512),[[e.vModelText,n.form.name]])]),n.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœåŠ¡å•†"),e.createElementVNode("picker",{range:n.providers,"range-key":"name",onChange:a[2]||(a[2]=(...e)=>l.onProviderChange&&l.onProviderChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString((null==(i=n.selectedProvider)?void 0:i.name)||"è¯·é€‰æ‹©"),1)],40,["range"])])),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœåŠ¡å•†"),e.createElementVNode("text",{class:"value"},e.toDisplayString(l.getProviderName(n.form.provider_type)),1)])):e.createCommentVNode("",!0),n.selectedProvider||n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.credentialFields,(t=>(e.openBlock(),e.createElementBlock("view",{class:"form-item",key:t.key},[e.createElementVNode("text",{class:"label"},e.toDisplayString(t.label),1),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":e=>n.form.credentials[t.key]=e,placeholder:n.isEdit?"ç•™ç©ºä¸ä¿®æ”¹":t.placeholder,type:t.secret?"password":"text"},null,8,["onUpdate:modelValue","placeholder","type"]),[[e.vModelDynamic,n.form.credentials[t.key]]])])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¤‡æ³¨"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[3]||(a[3]=e=>n.form.remark=e),placeholder:"å¯é€‰"},null,512),[[e.vModelText,n.form.remark]])]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:3,class:"form-item"},[e.createElementVNode("text",{class:"label"},"çŠ¶æ€"),e.createElementVNode("switch",{checked:1===n.form.status,onChange:a[4]||(a[4]=e=>n.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[5]||(a[5]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn verify",onClick:a[6]||(a[6]=(...e)=>l.handleVerify&&l.handleVerify(...e))},[e.createElementVNode("text",null,"éªŒè¯")])):e.createCommentVNode("",!0),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-btn danger",onClick:a[7]||(a[7]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[8]||(a[8]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const q=s({data:()=>({records:[],domains:[],domainOptions:[{id:0,name:"å…¨éƒ¨åŸŸå"}],filterDomain:null,loading:!1,showModal:!1,currentRecord:{},userInfo:null,editForm:{content:"",ttl:1,proxied:!1},ttlOptions:[{value:1,label:"è‡ªåŠ¨"},{value:300,label:"5åˆ†é’Ÿ"},{value:1800,label:"30åˆ†é’Ÿ"},{value:3600,label:"1å°æ—¶"},{value:86400,label:"1å¤©"}]}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadDomains(),this.loadRecords()},methods:{async loadDomains(){var e;try{const t=await B();this.domains=(null==(e=t.data)?void 0:e.domains)||[],this.domainOptions=[{id:0,name:"å…¨éƒ¨åŸŸå"},...this.domains]}catch(t){}},async loadRecords(){var e,a;this.loading=!0;try{const t={};(null==(e=this.filterDomain)?void 0:e.id)&&(t.domain_id=this.filterDomain.id);const s=await function(e={}){return n({url:"/admin/dns-records",method:"GET",data:e})}(t);this.records=(null==(a=s.data)?void 0:a.records)||[]}catch(s){t("error","at pages/admin/dns-records.vue:151","åŠ è½½DNSè®°å½•å¤±è´¥:",s)}this.loading=!1},onDomainFilter(e){this.filterDomain=this.domainOptions[e.detail.value],0===this.filterDomain.id&&(this.filterDomain=null),this.loadRecords()},editRecord(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentRecord=e,this.editForm={content:e.content,ttl:e.ttl||1,proxied:e.proxied||!1},this.showModal=!0)},onTtlChange(e){this.editForm.ttl=this.ttlOptions[e.detail.value].value},getTtlLabel(e){const t=this.ttlOptions.find((t=>t.value===e));return t?t.label:"è‡ªåŠ¨"},async handleSave(){var e,t;if(this.editForm.content)try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),await(e=this.currentRecord.id,t={domain_id:this.currentRecord.domain_id,content:this.editForm.content,ttl:this.editForm.ttl,proxied:this.editForm.proxied},n({url:`/admin/dns-records/${e}`,method:"PUT",data:t})),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadRecords()}catch(a){uni.hideLoading()}else uni.showToast({title:"è¯·è¾“å…¥è®°å½•å€¼",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™æ¡DNSè®°å½•å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await function(e,t={}){return n({url:`/admin/dns-records/${e}`,method:"DELETE",data:t})}(this.currentRecord.id,{domain_id:this.currentRecord.domain_id}),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadRecords()}catch(t){}}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"DNSè®°å½•ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.records.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:n.domainOptions,"range-key":"name",onChange:a[0]||(a[0]=(...e)=>l.onDomainFilter&&l.onDomainFilter(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString((null==(i=n.filterDomain)?void 0:i.name)||"å…¨éƒ¨åŸŸå"),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"record-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.records,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-card",key:t.id,onClick:e=>l.editRecord(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["type-badge",t.type.toLowerCase()])},e.toDisplayString(t.type),3),e.createElementVNode("text",{class:"record-name"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"record-body"},[e.createElementVNode("text",{class:"record-content"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"meta-tags"},[e.createElementVNode("text",{class:"meta-tag"},"TTL: "+e.toDisplayString(1===t.ttl?"è‡ªåŠ¨":t.ttl),1),t.proxied?(e.openBlock(),e.createElementBlock("text",{key:0,class:"meta-tag proxy"},"ğŸ›¡ï¸ ä»£ç†")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0!==n.records.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“¡"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— DNSè®°å½•")]))]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[7]||(a[7]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ç¼–è¾‘DNSè®°å½•"),e.createElementVNode("view",{class:"detail-row"},[e.createElementVNode("text",{class:"detail-label"},"ç±»å‹"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.currentRecord.type),1)]),e.createElementVNode("view",{class:"detail-row"},[e.createElementVNode("text",{class:"detail-label"},"åç§°"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.currentRecord.name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è®°å½•å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input","onUpdate:modelValue":a[1]||(a[1]=e=>n.editForm.content=e),placeholder:"è¾“å…¥è®°å½•å€¼"},null,512),[[e.vModelText,n.editForm.content]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"TTL"),e.createElementVNode("picker",{range:n.ttlOptions,"range-key":"label",onChange:a[2]||(a[2]=(...e)=>l.onTtlChange&&l.onTtlChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(l.getTtlLabel(n.editForm.ttl)),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"CDNä»£ç†"),e.createElementVNode("switch",{checked:n.editForm.proxied,onChange:a[3]||(a[3]=e=>n.editForm.proxied=e.detail.value)},null,40,["checked"])]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[4]||(a[4]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[5]||(a[5]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[6]||(a[6]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);const G=s({data:()=>({subdomains:[],searchKey:"",page:1,hasMore:!0,loading:!1,showModal:!1,currentItem:{},extendDays:"",editStatus:1,userInfo:null,statusList:[{value:"",label:"å…¨éƒ¨çŠ¶æ€"},{value:0,label:"ç¦ç”¨"},{value:1,label:"æ­£å¸¸"},{value:2,label:"å¾…å®¡æ ¸"}],expiredList:[{value:"",label:"å…¨éƒ¨"},{value:"1",label:"å·²è¿‡æœŸ"},{value:"0",label:"æœªè¿‡æœŸ"}],statusOptions:[{value:0,label:"ç¦ç”¨"},{value:1,label:"æ­£å¸¸"},{value:2,label:"å¾…å®¡æ ¸"}],filterStatus:"",filterExpired:""}),computed:{currentStatusLabel(){const e=this.statusList.find((e=>e.value===this.filterStatus));return e?e.label:"å…¨éƒ¨çŠ¶æ€"},currentExpiredLabel(){const e=this.expiredList.find((e=>e.value===this.filterExpired));return e?e.label:"å…¨éƒ¨"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadData()},methods:{async loadData(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.searchKey&&(t.search=this.searchKey),""!==this.filterStatus&&(t.status=this.filterStatus),""!==this.filterExpired&&(t.expired=this.filterExpired);const s=await function(e={}){return n({url:"/admin/subdomains",method:"GET",data:e})}(t),o=(null==(e=s.data)?void 0:e.subdomains)||[];1===this.page?this.subdomains=o:this.subdomains=[...this.subdomains,...o];const l=(null==(a=s.data)?void 0:a.pagination)||{};this.hasMore=this.page<l.pages}catch(s){t("error","at pages/admin/subdomains.vue:181",s)}this.loading=!1}},doSearch(){this.page=1,this.loadData()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},onStatusChange(e){this.filterStatus=this.statusList[e.detail.value].value,this.page=1,this.loadData()},onExpiredChange(e){this.filterExpired=this.expiredList[e.detail.value].value,this.page=1,this.loadData()},getStatusClass:e=>e.is_expired?"expired":0===e.status?"disabled":2===e.status?"pending":"normal",getStatusText:e=>e.is_expired?"å·²è¿‡æœŸ":0===e.status?"ç¦ç”¨":2===e.status?"å¾…å®¡æ ¸":"æ­£å¸¸",formatDate:e=>e?e.replace("T"," ").substring(0,10):"-",showDetail(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.currentItem={...e},this.editStatus=e.status,this.extendDays="",this.showModal=!0)},onEditStatusChange(e){this.editStatus=this.statusOptions[e.detail.value].value},getEditStatusLabel(){const e=this.statusOptions.find((e=>e.value===this.editStatus));return e?e.label:"æ­£å¸¸"},async handleSave(){try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={status:this.editStatus};this.extendDays&&(e.extend_days=parseInt(this.extendDays)),await function(e,t){return n({url:`/admin/subdomains/${e}`,method:"PUT",data:t})}(this.currentItem.id,e),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadData()}catch(e){uni.hideLoading()}},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ ${this.currentItem.full_name} å—ï¼Ÿå°†åŒæ—¶åˆ é™¤DNSè®°å½•ï¼`,confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentItem.id,n({url:`/admin/subdomains/${t}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.page=1,this.loadData()}catch(a){}var t}})},async handleSendEmail(){try{await(e=this.currentItem.id,n({url:`/admin/subdomains/${e}/send-expiry-email`,method:"POST"})),uni.showToast({title:"é‚®ä»¶å·²å‘é€",icon:"success"})}catch(t){}var e},handleClearDns(){uni.showModal({title:"ç¡®è®¤æ¸…ç†",content:"ç¡®å®šè¦æ¸…ç†è¯¥åŸŸåçš„æ‰€æœ‰DNSè®°å½•å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t=this.currentItem.id,n({url:`/admin/subdomains/${t}/clear-dns`,method:"POST"})),uni.showToast({title:"æ¸…ç†æˆåŠŸ",icon:"success"})}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"äºŒçº§åŸŸåç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.subdomains.length)+" ä¸ª",1)]),e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("text",{class:"search-icon"},"ğŸ”"),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>n.searchKey=e),placeholder:"æœç´¢åŸŸå",onConfirm:a[1]||(a[1]=(...e)=>l.doSearch&&l.doSearch(...e))},null,544),[[e.vModelText,n.searchKey]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>l.doSearch&&l.doSearch(...e))},"æœç´¢")])]),e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("picker",{range:n.statusList,"range-key":"label",onChange:a[3]||(a[3]=(...e)=>l.onStatusChange&&l.onStatusChange(...e))},[e.createElementVNode("view",{class:"filter-chip"},[e.createElementVNode("text",{class:"chip-text"},e.toDisplayString(l.currentStatusLabel),1),e.createElementVNode("text",{class:"chip-arrow"},"â–¼")])],40,["range"]),e.createElementVNode("picker",{range:n.expiredList,"range-key":"label",onChange:a[4]||(a[4]=(...e)=>l.onExpiredChange&&l.onExpiredChange(...e))},[e.createElementVNode("view",{class:"filter-chip"},[e.createElementVNode("text",{class:"chip-text"},e.toDisplayString(l.currentExpiredLabel),1),e.createElementVNode("text",{class:"chip-arrow"},"â–¼")])],40,["range"])]),e.createElementVNode("view",{class:"subdomain-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.subdomains,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"subdomain-card",key:t.id,onClick:e=>l.showDetail(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"subdomain-name"},e.toDisplayString(t.full_name),1),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",l.getStatusClass(t)])},e.toDisplayString(l.getStatusText(t)),3)]),e.createElementVNode("view",{class:"card-info"},[e.createElementVNode("text",{class:"info-item"},"ğŸ‘¤ "+e.toDisplayString(null==(a=t.user)?void 0:a.username),1),e.createElementVNode("text",{class:"info-item"},"ğŸ“ "+e.toDisplayString(t.records_count)+" æ¡è®°å½•",1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:e.normalizeClass(["expire-tag",{expired:t.is_expired}])},e.toDisplayString(t.is_expired?"å·²è¿‡æœŸ":"åˆ°æœŸ: "+l.formatDate(t.expires_at)),3),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])})),128)),0!==n.subdomains.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ”—"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ•°æ®")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[5]||(a[5]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[13]||(a[13]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"åŸŸåè¯¦æƒ…"),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åŸŸå"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(n.currentItem.full_name),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"æ‰€å±ç”¨æˆ·"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(null==(i=n.currentItem.user)?void 0:i.username),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"çŠ¶æ€"),e.createElementVNode("picker",{range:n.statusOptions,"range-key":"label",onChange:a[6]||(a[6]=(...e)=>l.onEditStatusChange&&l.onEditStatusChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(l.getEditStatusLabel()),1)],40,["range"])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"å»¶æœŸå¤©æ•°"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>n.extendDays=e),placeholder:"è¾“å…¥å¤©æ•°"},null,512),[[e.vModelText,n.extendDays]])]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"detail-label"},"åˆ°æœŸæ—¶é—´"),e.createElementVNode("text",{class:"detail-value"},e.toDisplayString(l.formatDate(n.currentItem.expires_at)),1)]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[8]||(a[8]=e=>n.showModal=!1)},"å–æ¶ˆ"),e.createElementVNode("view",{class:"modal-btn danger",onClick:a[9]||(a[9]=(...e)=>l.handleDelete&&l.handleDelete(...e))},"åˆ é™¤"),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[10]||(a[10]=(...e)=>l.handleSave&&l.handleSave(...e))},"ä¿å­˜")]),e.createElementVNode("view",{class:"extra-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[11]||(a[11]=(...e)=>l.handleSendEmail&&l.handleSendEmail(...e))},"å‘é€åˆ°æœŸæé†’"),e.createElementVNode("view",{class:"action-btn warning",onClick:a[12]||(a[12]=(...e)=>l.handleClearDns&&l.handleClearDns(...e))},"æ¸…ç†DNSè®°å½•")])])])):e.createCommentVNode("",!0)])}]]);const K=s({data:()=>({logs:[],page:1,hasMore:!0,loading:!1,filterAction:"",userInfo:null,actionList:[{value:"",label:"å…¨éƒ¨æ“ä½œ"},{value:"create",label:"åˆ›å»º"},{value:"update",label:"æ›´æ–°"},{value:"delete",label:"åˆ é™¤"},{value:"login",label:"ç™»å½•"}]}),computed:{currentActionLabel(){const e=this.actionList.find((e=>e.value===this.filterAction));return e?e.label:"å…¨éƒ¨æ“ä½œ"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadData()},methods:{async loadData(){var e,a;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};this.filterAction&&(t.action=this.filterAction);const s=await function(e={}){return n({url:"/admin/logs",method:"GET",data:e})}(t),o=(null==(e=s.data)?void 0:e.logs)||[];1===this.page?this.logs=o:this.logs=[...this.logs,...o];const l=(null==(a=s.data)?void 0:a.pagination)||{};this.hasMore=this.page<l.pages}catch(s){t("error","at pages/admin/logs.vue:109",s)}this.loading=!1}},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadData())},onActionChange(e){this.filterAction=this.actionList[e.detail.value].value,this.page=1,this.loadData()},getActionText:e=>({create:"åˆ›å»º",update:"æ›´æ–°",delete:"åˆ é™¤",login:"ç™»å½•"}[e]||e),formatTime:e=>e?e.replace("T"," ").substring(0,16):"",showDeleteConfirm(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•åˆ é™¤",icon:"none"}):uni.showActionSheet({itemList:["åˆ é™¤æ­¤æ¡æ—¥å¿—"],success:async t=>{if(0===t.tapIndex)try{await(a=e.id,n({url:`/admin/logs/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.page=1,this.loadData()}catch(s){}var a}})},handleClearAll(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ¸…ç©º",icon:"none"}):uni.showModal({title:"ç¡®è®¤æ¸…ç©º",content:"ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥å¿—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(t={clear_all:!0},n({url:"/admin/logs/batch-delete",method:"POST",data:t})),uni.showToast({title:"æ¸…ç©ºæˆåŠŸ",icon:"success"}),this.page=1,this.loadData()}catch(a){}var t}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"æ“ä½œæ—¥å¿—"),e.createElementVNode("view",{class:"header-action",onClick:a[0]||(a[0]=(...e)=>l.handleClearAll&&l.handleClearAll(...e))},[e.createElementVNode("text",{class:"action-text"},"æ¸…ç©º")])]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("picker",{range:n.actionList,"range-key":"label",onChange:a[1]||(a[1]=(...e)=>l.onActionChange&&l.onActionChange(...e))},[e.createElementVNode("view",{class:"filter-picker"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(l.currentActionLabel),1),e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["range"])])]),e.createElementVNode("view",{class:"log-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.logs,(t=>{var a,s;return e.openBlock(),e.createElementBlock("view",{class:"log-card",key:t.id,onLongpress:e=>l.showDeleteConfirm(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-avatar"},e.toDisplayString((null==(s=null==(a=t.username)?void 0:a.charAt(0))?void 0:s.toUpperCase())||"U"),1),e.createElementVNode("text",{class:"user-name"},e.toDisplayString(t.username),1)]),e.createElementVNode("view",{class:e.normalizeClass(["action-badge",t.action])},e.toDisplayString(l.getActionText(t.action)),3)]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("text",{class:"log-detail"},e.toDisplayString(t.detail),1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"log-target"},e.toDisplayString(t.target_type)+" #"+e.toDisplayString(t.target_id),1),e.createElementVNode("text",{class:"log-ip"},e.toDisplayString(t.ip_address),1),e.createElementVNode("text",{class:"log-time"},e.toDisplayString(l.formatTime(t.created_at)),1)])],40,["onLongpress"])})),128)),0!==n.logs.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“œ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— æ—¥å¿—")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[2]||(a[2]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0)])}]]);const H=s({data:()=>({coupons:[],loading:!1,page:1,hasMore:!0,statusFilter:"all",typeOptions:[{label:"æŠ˜æ‰£ç™¾åˆ†æ¯”",value:"percent"},{label:"å›ºå®šé‡‘é¢",value:"fixed"}],showModal:!1,isEdit:!1,formData:{name:"",code:"",type:"percent",value:"",min_amount:"",max_discount:"",total_count:"-1",per_user_limit:"1",expires_at:""},editingId:null,showUsagesModal:!1,currentCoupon:null,usages:[],userInfo:null}),computed:{currentTypeLabel(){const e=this.typeOptions.find((e=>e.value===this.formData.type));return e?e.label:"æŠ˜æ‰£ç™¾åˆ†æ¯”"},isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadCoupons()},methods:{async loadCoupons(){var e,a,s;if(!this.loading){this.loading=!0;try{const t={page:this.page,per_page:20};"active"===this.statusFilter?t.status=1:"disabled"===this.statusFilter&&(t.status=0);const o=await function(e={}){return n({url:"/admin/coupons",method:"GET",data:e})}(t),l=(null==(e=o.data)?void 0:e.coupons)||(null==(a=o.data)?void 0:a.list)||[];1===this.page?this.coupons=l:this.coupons=[...this.coupons,...l];const i=(null==(s=o.data)?void 0:s.pagination)||{};this.hasMore=this.page<(i.pages||1)}catch(o){t("error","at pages/admin/coupons.vue:245","åŠ è½½ä¼˜æƒ åˆ¸å¤±è´¥",o)}this.loading=!1}},setFilter(e){this.statusFilter=e,this.page=1,this.loadCoupons()},loadMore(){this.hasMore&&!this.loading&&(this.page++,this.loadCoupons())},formatTime:e=>e?e.split("T")[0]:"",onTypeChange(e){this.formData.type=this.typeOptions[e.detail.value].value},onExpiresDateChange(e){this.formData.expires_at=e.detail.value},showAddModal(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.editingId=null,this.formData={name:"",code:"",type:"percent",value:"",min_amount:"",max_discount:"",total_count:"-1",per_user_limit:"1",expires_at:""},this.showModal=!0)},editCoupon(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.editingId=e.id,this.formData={name:e.name||"",code:e.code||"",type:e.type||"percent",value:String(e.value||""),min_amount:String(e.min_amount||""),max_discount:String(e.max_discount||""),total_count:String(e.total_count??"-1"),per_user_limit:String(e.per_user_limit||"1"),expires_at:e.expires_at?e.expires_at.split("T")[0]:""},this.showModal=!0)},closeModal(){this.showModal=!1},async submitForm(){if(!this.formData.name)return void uni.showToast({title:"è¯·è¾“å…¥åç§°",icon:"none"});if(!this.formData.value)return void uni.showToast({title:"è¯·è¾“å…¥ä¼˜æƒ å€¼",icon:"none"});const e={name:this.formData.name,type:this.formData.type,value:parseFloat(this.formData.value)};!this.isEdit&&this.formData.code&&(e.code=this.formData.code),this.formData.min_amount&&(e.min_amount=parseFloat(this.formData.min_amount)),this.formData.max_discount&&(e.max_discount=parseFloat(this.formData.max_discount)),this.formData.total_count&&(e.total_count=parseInt(this.formData.total_count)),this.formData.per_user_limit&&(e.per_user_limit=parseInt(this.formData.per_user_limit)),this.formData.expires_at&&(e.expires_at=this.formData.expires_at+"T23:59:59Z");try{uni.showLoading({title:"ä¿å­˜ä¸­..."}),this.isEdit?await function(e,t){return n({url:`/admin/coupons/${e}`,method:"PUT",data:t})}(this.editingId,e):await function(e){return n({url:"/admin/coupons",method:"POST",data:e})}(e),uni.hideLoading(),uni.showToast({title:this.isEdit?"æ›´æ–°æˆåŠŸ":"åˆ›å»ºæˆåŠŸ",icon:"success"}),this.closeModal(),this.page=1,this.loadCoupons()}catch(a){uni.hideLoading(),t("error","at pages/admin/coupons.vue:362","ä¿å­˜å¤±è´¥",a)}},deleteCouponConfirm(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•åˆ é™¤",icon:"none"}):uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ä¼˜æƒ åˆ¸ "${e.code}" å—ï¼Ÿ`,success:async a=>{if(a.confirm)try{await(s=e.id,n({url:`/admin/coupons/${s}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.page=1,this.loadCoupons()}catch(o){t("error","at pages/admin/coupons.vue:381","åˆ é™¤å¤±è´¥",o)}var s}})},async viewUsages(e){var a,s,o;this.currentCoupon=e,this.usages=[],this.showUsagesModal=!0;try{const t=await(o=e.id,n({url:`/admin/coupons/${o}/usages`,method:"GET"}));this.usages=(null==(a=t.data)?void 0:a.usages)||(null==(s=t.data)?void 0:s.list)||[]}catch(l){t("error","at pages/admin/coupons.vue:396","åŠ è½½ä½¿ç”¨è®°å½•å¤±è´¥",l)}},closeUsagesModal(){this.showUsagesModal=!1,this.currentCoupon=null,this.usages=[]},copyCode(e){uni.setClipboardData({data:e,success:()=>{uni.showToast({title:"ä¼˜æƒ ç å·²å¤åˆ¶",icon:"success"})}})}}},[["render",function(t,a,s,o,n,l){var i;return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"ä¼˜æƒ åˆ¸ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.coupons.length)+" æ¡",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"all"===n.statusFilter}]),onClick:a[0]||(a[0]=e=>l.setFilter("all"))},[e.createElementVNode("text",{class:"filter-text"},"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"active"===n.statusFilter}]),onClick:a[1]||(a[1]=e=>l.setFilter("active"))},[e.createElementVNode("text",{class:"filter-text"},"æœ‰æ•ˆ")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-item",{active:"disabled"===n.statusFilter}]),onClick:a[2]||(a[2]=e=>l.setFilter("disabled"))},[e.createElementVNode("text",{class:"filter-text"},"å·²ç¦ç”¨")],2)])]),e.createElementVNode("view",{class:"coupon-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.coupons,(t=>(e.openBlock(),e.createElementBlock("view",{class:"coupon-card",key:t.id},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["coupon-badge",{disabled:1!==t.status}])},e.toDisplayString(1===t.status?"æœ‰æ•ˆ":"å·²ç¦ç”¨"),3),e.createElementVNode("text",{class:"coupon-value"},e.toDisplayString("percent"===t.type?t.value+"%æŠ˜æ‰£":"Â¥"+t.value),1)]),e.createElementVNode("view",{class:"coupon-body",onClick:e=>l.copyCode(t.code)},[e.createElementVNode("text",{class:"coupon-code"},e.toDisplayString(t.code),1),e.createElementVNode("text",{class:"copy-btn"},"ğŸ“‹")],8,["onClick"]),e.createElementVNode("view",{class:"coupon-info"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"åç§°"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.name),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"æœ€ä½æ¶ˆè´¹"),e.createElementVNode("text",{class:"info-value"},"Â¥"+e.toDisplayString(t.min_amount||0),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"ä½¿ç”¨æ¬¡æ•°"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(t.used_count||0)+" / "+e.toDisplayString(-1===t.total_count?"æ— é™":t.total_count),1)]),t.expires_at?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"è¿‡æœŸæ—¶é—´"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(l.formatTime(t.expires_at)),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"action-btn",onClick:e=>l.viewUsages(t)},[e.createElementVNode("text",null,"ä½¿ç”¨è®°å½•")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn",onClick:e=>l.editCoupon(t)},[e.createElementVNode("text",null,"ç¼–è¾‘")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn danger",onClick:e=>l.deleteCouponConfirm(t)},[e.createElementVNode("text",null,"åˆ é™¤")],8,["onClick"])])])))),128)),0!==n.coupons.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ä¼˜æƒ åˆ¸")]))]),n.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"load-more",onClick:a[3]||(a[3]=(...e)=>l.loadMore&&l.loadMore(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.loading?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fab",onClick:a[4]||(a[4]=(...e)=>l.showAddModal&&l.showAddModal(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal",onClick:a[16]||(a[16]=e.withModifiers(((...e)=>l.closeModal&&l.closeModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.isEdit?"ç¼–è¾‘ä¼˜æƒ åˆ¸":"åˆ›å»ºä¼˜æƒ åˆ¸"),1),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"åç§°"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>n.formData.name=e),placeholder:"ä¼˜æƒ åˆ¸åç§°"},null,512),[[e.vModelText,n.formData.name]])]),n.isEdit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä¼˜æƒ ç "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"text","onUpdate:modelValue":a[6]||(a[6]=e=>n.formData.code=e),placeholder:"ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ"},null,512),[[e.vModelText,n.formData.code]])])),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ç±»å‹"),e.createElementVNode("picker",{range:n.typeOptions,"range-key":"label",onChange:a[7]||(a[7]=(...e)=>l.onTypeChange&&l.onTypeChange(...e))},[e.createElementVNode("view",{class:"picker-input"},e.toDisplayString(l.currentTypeLabel),1)],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"ä¼˜æƒ å€¼"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[8]||(a[8]=e=>n.formData.value=e),placeholder:"percent"===n.formData.type?"å¦‚10è¡¨ç¤º9æŠ˜":"å›ºå®šé‡‘é¢"},null,8,["placeholder"]),[[e.vModelText,n.formData.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€ä½æ¶ˆè´¹"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[9]||(a[9]=e=>n.formData.min_amount=e),placeholder:"0æ— é™åˆ¶"},null,512),[[e.vModelText,n.formData.min_amount]])]),"percent"===n.formData.type?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"label"},"æœ€å¤§ä¼˜æƒ "),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":a[10]||(a[10]=e=>n.formData.max_discount=e),placeholder:"ç•™ç©ºæ— é™åˆ¶"},null,512),[[e.vModelText,n.formData.max_discount]])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ€»æ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[11]||(a[11]=e=>n.formData.total_count=e),placeholder:"-1æ— é™"},null,512),[[e.vModelText,n.formData.total_count]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"æ¯äººé™ç”¨"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"number","onUpdate:modelValue":a[12]||(a[12]=e=>n.formData.per_user_limit=e),placeholder:"é»˜è®¤1"},null,512),[[e.vModelText,n.formData.per_user_limit]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"è¿‡æœŸæ—¶é—´"),e.createElementVNode("picker",{mode:"date",onChange:a[13]||(a[13]=(...e)=>l.onExpiresDateChange&&l.onExpiresDateChange(...e))},[e.createElementVNode("view",{class:"picker-input"},e.toDisplayString(n.formData.expires_at||"æ°¸ä¸è¿‡æœŸ"),1)],32)]),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=(...e)=>l.closeModal&&l.closeModal(...e))},[e.createElementVNode("text",null,"å–æ¶ˆ")]),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[15]||(a[15]=(...e)=>l.submitForm&&l.submitForm(...e))},[e.createElementVNode("text",null,e.toDisplayString(n.isEdit?"ä¿å­˜":"åˆ›å»º"),1)])])])])):e.createCommentVNode("",!0),n.showUsagesModal?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal",onClick:a[18]||(a[18]=e.withModifiers(((...e)=>l.closeUsagesModal&&l.closeUsagesModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"ä½¿ç”¨è®°å½• - "+e.toDisplayString(null==(i=n.currentCoupon)?void 0:i.code),1),n.usages.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"usage-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.usages,(t=>{var a;return e.openBlock(),e.createElementBlock("view",{class:"usage-item",key:t.id},[e.createElementVNode("text",{class:"usage-user"},e.toDisplayString((null==(a=t.user)?void 0:a.email)||"æœªçŸ¥ç”¨æˆ·"),1),e.createElementVNode("text",{class:"usage-amount"},"-Â¥"+e.toDisplayString(t.discount_amount),1),e.createElementVNode("text",{class:"usage-time"},e.toDisplayString(l.formatTime(t.created_at)),1)])})),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state small"},[e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ä½¿ç”¨è®°å½•")])),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[17]||(a[17]=(...e)=>l.closeUsagesModal&&l.closeUsagesModal(...e))},[e.createElementVNode("text",null,"å…³é—­")])])])])):e.createCommentVNode("",!0)])}]]);const j=s({data:()=>({versions:[],currentPlatform:"",showModal:!1,isEdit:!1,currentId:null,userInfo:null,form:{platform:"android",version:"",build:"",download_url:"",file_size:"",update_log:"",force_update:!1,min_version:"",status:1}}),computed:{isDemo(){var e;return"demo"===(null==(e=this.userInfo)?void 0:e.role)}},onLoad(){this.userInfo=h(),this.loadVersions()},methods:{async loadVersions(){var e;try{const t={};this.currentPlatform&&(t.platform=this.currentPlatform);const a=await function(e={}){return n({url:"/admin/app-versions",method:"GET",data:e})}(t);this.versions=(null==(e=a.data)?void 0:e.versions)||[]}catch(a){t("error","at pages/admin/app-versions.vue:191","åŠ è½½ç‰ˆæœ¬åˆ—è¡¨å¤±è´¥",a)}},filterPlatform(e){this.currentPlatform=e,this.loadVersions()},formatTime:e=>e?e.split("T")[0]:"",showAdd(){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•æ·»åŠ ",icon:"none"}):(this.isEdit=!1,this.currentId=null,this.form={platform:"android",version:"",build:"",download_url:"",file_size:"",update_log:"",force_update:!1,min_version:"",status:1},this.showModal=!0)},editVersion(e){this.isDemo?uni.showToast({title:"æ¼”ç¤ºæ¨¡å¼ä¸‹æ— æ³•ç¼–è¾‘",icon:"none"}):(this.isEdit=!0,this.currentId=e.id,this.form={platform:e.platform,version:e.version,build:String(e.build),download_url:e.download_url,file_size:e.file_size||"",update_log:e.update_log||"",force_update:e.force_update||!1,min_version:e.min_version||"",status:e.status},this.showModal=!0)},async handleSave(){if(this.form.platform&&this.form.version&&this.form.build&&this.form.download_url)if(/^\d+(\.\d+)*$/.test(this.form.version))try{uni.showLoading({title:"ä¿å­˜ä¸­..."});const e={...this.form,build:parseInt(this.form.build)};this.isEdit?await function(e,t){return n({url:`/admin/app-versions/${e}`,method:"PUT",data:t})}(this.currentId,e):await function(e){return n({url:"/admin/app-versions",method:"POST",data:e})}(e),uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadVersions()}catch(e){uni.hideLoading(),t("error","at pages/admin/app-versions.vue:272","ä¿å­˜å¤±è´¥",e)}else uni.showToast({title:"ç‰ˆæœ¬å·æ ¼å¼é”™è¯¯",icon:"none"});else uni.showToast({title:"è¯·å¡«å†™å¿…å¡«é¡¹",icon:"none"})},handleDelete(){uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç‰ˆæœ¬å—ï¼Ÿ",confirmColor:"#ff4d4f",success:async e=>{if(e.confirm)try{await(a=this.currentId,n({url:`/admin/app-versions/${a}`,method:"DELETE"})),uni.showToast({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.showModal=!1,this.loadVersions()}catch(s){t("error","at pages/admin/app-versions.vue:288","åˆ é™¤å¤±è´¥",s)}var a}})}}},[["render",function(t,a,s,o,n,l){return e.openBlock(),e.createElementBlock("view",{class:"page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("text",{class:"header-title"},"APPç‰ˆæœ¬ç®¡ç†"),e.createElementVNode("text",{class:"header-count"},"å…± "+e.toDisplayString(n.versions.length)+" ä¸ªç‰ˆæœ¬",1)]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:""===n.currentPlatform}]),onClick:a[0]||(a[0]=e=>l.filterPlatform(""))},[e.createElementVNode("text",null,"å…¨éƒ¨")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"android"===n.currentPlatform}]),onClick:a[1]||(a[1]=e=>l.filterPlatform("android"))},[e.createElementVNode("text",null,"ğŸ¤– Android")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"ios"===n.currentPlatform}]),onClick:a[2]||(a[2]=e=>l.filterPlatform("ios"))},[e.createElementVNode("text",null,"ğŸ iOS")],2)])]),e.createElementVNode("view",{class:"version-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.versions,(t=>(e.openBlock(),e.createElementBlock("view",{class:"version-card",key:t.id,onClick:e=>l.editVersion(t)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:e.normalizeClass(["platform-badge",t.platform])},[e.createElementVNode("text",null,e.toDisplayString("android"===t.platform?"ğŸ¤–":"ğŸ"),1),e.createElementVNode("text",null,e.toDisplayString("android"===t.platform?"Android":"iOS"),1)],2),e.createElementVNode("view",{class:"tag-row"},[t.force_update?(e.openBlock(),e.createElementBlock("view",{key:0,class:"force-tag"},"å¼ºåˆ¶æ›´æ–°")):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",{disabled:0===t.status}])},e.toDisplayString(1===t.status?"å·²å‘å¸ƒ":"å·²ç¦ç”¨"),3)])]),e.createElementVNode("view",{class:"version-info"},[e.createElementVNode("view",{class:"version-main"},[e.createElementVNode("text",{class:"version-number"},"v"+e.toDisplayString(t.version),1),e.createElementVNode("text",{class:"build-number"},"Build "+e.toDisplayString(t.build),1)]),e.createElementVNode("view",{class:"version-meta"},[t.file_size?(e.openBlock(),e.createElementBlock("text",{key:0,class:"meta-item"},"ğŸ“¦ "+e.toDisplayString(t.file_size),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"meta-item"},"ğŸ“¥ "+e.toDisplayString(t.download_count||0)+" æ¬¡ä¸‹è½½",1)])]),t.update_log?(e.openBlock(),e.createElementBlock("view",{key:0,class:"update-log"},[e.createElementVNode("text",{class:"log-text"},e.toDisplayString(t.update_log),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"card-time"},e.toDisplayString(l.formatTime(t.created_at)),1),e.createElementVNode("text",{class:"card-arrow"},"â€º")])],8,["onClick"])))),128)),0===n.versions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸ“±"),e.createElementVNode("text",{class:"empty-text"},"æš‚æ— ç‰ˆæœ¬")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"fab",onClick:a[3]||(a[3]=(...e)=>l.showAdd&&l.showAdd(...e))},[e.createElementVNode("text",{class:"fab-icon"},"+")]),n.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal",onClick:a[17]||(a[17]=e.withModifiers((e=>n.showModal=!1),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(n.isEdit?"ç¼–è¾‘ç‰ˆæœ¬":"æ·»åŠ ç‰ˆæœ¬"),1),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("å¹³å° "),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"platform-select"},[e.createElementVNode("view",{class:e.normalizeClass(["platform-option",{active:"android"===n.form.platform}]),onClick:a[4]||(a[4]=e=>n.form.platform="android")},[e.createElementVNode("text",null,"ğŸ¤– Android")],2),e.createElementVNode("view",{class:e.normalizeClass(["platform-option",{active:"ios"===n.form.platform}]),onClick:a[5]||(a[5]=e=>n.form.platform="ios")},[e.createElementVNode("text",null,"ğŸ iOS")],2)])]),e.createElementVNode("view",{class:"form-row"},[e.createElementVNode("view",{class:"form-item column half"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("ç‰ˆæœ¬å· "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[6]||(a[6]=e=>n.form.version=e),placeholder:"å¦‚ 1.0.0"},null,512),[[e.vModelText,n.form.version]])]),e.createElementVNode("view",{class:"form-item column half"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("æ„å»ºå· "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full",type:"number","onUpdate:modelValue":a[7]||(a[7]=e=>n.form.build=e),placeholder:"å¦‚ 1"},null,512),[[e.vModelText,n.form.build]])])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},[e.createTextVNode("ä¸‹è½½åœ°å€ "),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[8]||(a[8]=e=>n.form.download_url=e),placeholder:"è¾“å…¥ä¸‹è½½é“¾æ¥"},null,512),[[e.vModelText,n.form.download_url]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ–‡ä»¶å¤§å°"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[9]||(a[9]=e=>n.form.file_size=e),placeholder:"å¦‚ 15.2 MB"},null,512),[[e.vModelText,n.form.file_size]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æœ€ä½æ”¯æŒç‰ˆæœ¬"),e.withDirectives(e.createElementVNode("input",{class:"input-full","onUpdate:modelValue":a[10]||(a[10]=e=>n.form.min_version=e),placeholder:"ä½äºæ­¤ç‰ˆæœ¬å°†å¼ºåˆ¶æ›´æ–°"},null,512),[[e.vModelText,n.form.min_version]])]),e.createElementVNode("view",{class:"form-item column"},[e.createElementVNode("text",{class:"label"},"æ›´æ–°æ—¥å¿—"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea","onUpdate:modelValue":a[11]||(a[11]=e=>n.form.update_log=e),placeholder:"è¾“å…¥æ›´æ–°å†…å®¹"},null,512),[[e.vModelText,n.form.update_log]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"å¼ºåˆ¶æ›´æ–°"),e.createElementVNode("switch",{checked:n.form.force_update,onChange:a[12]||(a[12]=e=>n.form.force_update=e.detail.value)},null,40,["checked"])]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"label"},"å‘å¸ƒçŠ¶æ€"),e.createElementVNode("switch",{checked:1===n.form.status,onChange:a[13]||(a[13]=e=>n.form.status=e.detail.value?1:0)},null,40,["checked"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btns"},[e.createElementVNode("view",{class:"modal-btn cancel",onClick:a[14]||(a[14]=e=>n.showModal=!1)},[e.createElementVNode("text",null,"å–æ¶ˆ")]),n.isEdit?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-btn danger",onClick:a[15]||(a[15]=(...e)=>l.handleDelete&&l.handleDelete(...e))},[e.createElementVNode("text",null,"åˆ é™¤")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"modal-btn confirm",onClick:a[16]||(a[16]=(...e)=>l.handleSave&&l.handleSave(...e))},[e.createElementVNode("text",null,"ä¿å­˜")])])])])):e.createCommentVNode("",!0)])}]]);__definePage("pages/index/index",g),__definePage("pages/mine/mine",V),__definePage("pages/login/login",N),__definePage("pages/register/register",f),__definePage("pages/forgot-password/forgot-password",y),__definePage("pages/domain/list",x),__definePage("pages/domain/purchase",k),__definePage("pages/domain/detail",D),__definePage("pages/recharge/recharge",C),__definePage("pages/record/record",b),__definePage("pages/announcement/list",S),__definePage("pages/settings/settings",T),__definePage("pages/admin/index",L),__definePage("pages/admin/users",I),__definePage("pages/admin/domains",A),__definePage("pages/admin/plans",U),__definePage("pages/admin/redeem",R),__definePage("pages/admin/orders",F),__definePage("pages/admin/announcements",$),__definePage("pages/admin/settings",z),__definePage("pages/admin/cf-accounts",O),__definePage("pages/admin/dns-records",q),__definePage("pages/admin/subdomains",G),__definePage("pages/admin/logs",K),__definePage("pages/admin/coupons",H),__definePage("pages/admin/app-versions",j);const Z={onLaunch:function(){t("log","at App.vue:6","App Launch"),this.checkUpdate()},onShow:function(){t("log","at App.vue:11","App Show")},onHide:function(){t("log","at App.vue:14","App Hide")},methods:{async checkUpdate(){try{const e=uni.getSystemInfoSync().platform;plus.runtime.getProperty(plus.runtime.appid,(a=>{const s=a.version;var o;t("log","at App.vue:27","å½“å‰ç‰ˆæœ¬ï¼š",s),(o={platform:e,version:s},n({url:"/app/check-update",method:"GET",data:o})).then((e=>{var a;t("log","at App.vue:33","æ£€æµ‹æ›´æ–°ç»“æœï¼š",e),(null==(a=e.data)?void 0:a.has_update)&&this.showUpdateDialog(e.data)})).catch((e=>{t("log","at App.vue:38","æ£€æµ‹æ›´æ–°å¤±è´¥",e)}))}))}catch(e){t("log","at App.vue:42","æ£€æµ‹æ›´æ–°å¼‚å¸¸",e)}},showUpdateDialog(e){const t=`å‘ç°æ–°ç‰ˆæœ¬ v${e.latest_version}\n\n${e.update_log||"ä¿®å¤å·²çŸ¥é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒ"}`;e.force_update?uni.showModal({title:"å‘ç°æ–°ç‰ˆæœ¬",content:t,showCancel:!1,confirmText:"ç«‹å³æ›´æ–°",success:t=>{t.confirm&&this.downloadUpdate(e)}}):uni.showModal({title:"å‘ç°æ–°ç‰ˆæœ¬",content:t,cancelText:"ç¨åå†è¯´",confirmText:"ç«‹å³æ›´æ–°",success:t=>{t.confirm&&this.downloadUpdate(e)}})},downloadUpdate(e){const a=e.download_url;t("log","at App.vue:80","å¼€å§‹ä¸‹è½½æ›´æ–°ï¼š",a),plus.runtime.openURL(a)}}};const J=uni.getSystemInfoSync(),W="4.75",X="https://tongji.dcloud.io/uni/stat",Y="__UNI__56C7881",Q=(e,t)=>{let a=uni.getStorageSync("$$STAT__DBDATA:"+Y)||{};a||(a={}),a[e]=t,uni.setStorageSync("$$STAT__DBDATA:"+Y,a)},ee=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+Y)||{};if(!t[e]){let a=uni.getStorageSync("$$STAT__DBDATA:"+Y);if(a||(a={}),!a[e])return;t[e]=a[e]}return t[e]},te=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+Y)||{};t[e]?(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+Y,t)):(t=uni.getStorageSync("$$STAT__DBDATA:"+Y),t[e]&&(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+Y,t)))},ae={enable:!0,version:"1"};let se={};se={"pages/index/index":"é¦–é¡µ","pages/mine/mine":"æˆ‘çš„","pages/login/login":"ç™»å½•","pages/register/register":"æ³¨å†Œ","pages/forgot-password/forgot-password":"å¿˜è®°å¯†ç ","pages/domain/list":"æˆ‘çš„åŸŸå","pages/domain/purchase":"è´­ä¹°åŸŸå","pages/domain/detail":"åŸŸåè¯¦æƒ…","pages/recharge/recharge":"å……å€¼","pages/record/record":"è´­ä¹°è®°å½•","pages/announcement/list":"å…¬å‘Š","pages/settings/settings":"è®¾ç½®","pages/admin/index":"ç®¡ç†ä¸­å¿ƒ","pages/admin/users":"ç”¨æˆ·ç®¡ç†","pages/admin/domains":"åŸŸåç®¡ç†","pages/admin/plans":"å¥—é¤ç®¡ç†","pages/admin/redeem":"å¡å¯†ç®¡ç†","pages/admin/orders":"è®¢å•ç®¡ç†","pages/admin/announcements":"å…¬å‘Šç®¡ç†","pages/admin/settings":"ç³»ç»Ÿè®¾ç½®","pages/admin/cf-accounts":"æ¸ é“ç®¡ç†","pages/admin/dns-records":"DNSè®°å½•ç®¡ç†","pages/admin/subdomains":"äºŒçº§åŸŸåç®¡ç†","pages/admin/logs":"æ“ä½œæ—¥å¿—","pages/admin/coupons":"ä¼˜æƒ åˆ¸ç®¡ç†","pages/admin/app-versions":"APPç‰ˆæœ¬ç®¡ç†"};const oe="__DC_STAT_UUID",ne="__DC_UUID_VALUE";function le(){let e="";if("n"===ce()){try{e=plus.runtime.getDCloudId()}catch(t){e=""}return e}try{e=uni.getStorageSync(oe)}catch(t){e=ne}if(!e){e=Date.now()+""+Math.floor(1e7*Math.random());try{uni.setStorageSync(oe,e)}catch(t){uni.setStorageSync(oe,ne)}}return e}const ie={appid:"__UNI__56C7881"},ce=()=>{const e={app:"n","app-plus":"n","app-harmony":"n","mp-harmony":"mhm",h5:"h5","mp-weixin":"wx",[["y","a","p","mp-ali"].reverse().join("")]:"ali","mp-baidu":"bd","mp-toutiao":"tt","mp-qq":"qq","quickapp-native":"qn","mp-kuaishou":"ks","mp-lark":"lark","quickapp-webview":"qw","mp-xhs":"xhs"};if("ali"===e.app&&my&&my.env){const e=my.env.clientName;if("ap"===e)return"ali";if("dingtalk"===e)return"dt"}return e.app||"app"},re=e=>{const t=ce();let a="";return e||("wx"===t&&(a=uni.getLaunchOptionsSync().scene),a)},de=e=>{let t="";for(var a in e)t+=a+"="+e[a]+"&";return t.substr(0,t.length-1)},me=e=>{let t=e||he();if("bd"===ce()){let e=t.$mp&&t.$mp.page&&t.$mp.page.is,a=t.$scope&&t.$scope.is;return e||a||""}return t.route||t.$scope&&t.$scope.route||t.$mp&&t.$mp.page.route},ue=e=>{let t=e&&(e.$page||e.$scope&&e.$scope.$page),a=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return t?"/"===t.fullPath?t.route:t.fullPath||t.route:a||""},he=()=>{let e=getCurrentPages(),t=e[e.length-1];return t?t.$vm:null},pe=e=>"page"===e.mpType||"page"===e.$mpType||e.$mp&&"page"===e.$mp.mpType||"page"===e.$options.mpType?"page":"app"===e.mpType||"app"===e.$mpType||e.$mp&&"app"===e.$mp.mpType||"app"===e.$options.mpType?"app":null,Ee=e=>{let t=[],a=[],s=[];for(let o in e){e[o].forEach((e=>{let n="";n=de(e),0===o?t.push(n):3===o?s.push(n):a.push(n)}))}return t.push(...a,...s),JSON.stringify(t)},ge=e=>se&&se[e]||"",ve="Report_Data_Time",we="Report_Status",Ve=e=>{let t={usv:W,conf:JSON.stringify({ak:"__UNI__56C7881"})};uni.request({url:X,method:"GET",data:t,success:t=>{const{data:a}=t;0===a.ret&&"function"==typeof e&&e({enable:a.enable})},fail:t=>{let a=1;try{a=uni.getStorageSync(we)}catch(s){a=1}""===a&&(a=1),"function"==typeof e&&e({enable:a})}})},Ne=()=>{if(ae.collectItems){const e=ae.collectItems.uniStatPageLog;return void 0===e||("boolean"!=typeof e||e)}return!0},fe="__first__visit__time",ye="__last__visit__time",xe=()=>parseInt((new Date).getTime()/1e3),ke=()=>{const e=ee(fe);let t=0;return e?t=e:(t=xe(),Q(fe,t),te(ye)),t},De="__page__residence__time";let _e=0,Ce=0;const be=()=>(_e=xe(),Q(De,_e),_e),Se="__total__visit__count",Te=()=>{const e=ee(Se);let t=1;return e&&(t=e,t++),Q(Se,t),t},Be="__first_time",Me=()=>{let e=xe();return Q(Be,e)},Pe=e=>{let t=0;const a=ee(Be),s=xe();if(0!==a&&(t=s-a),t=t<1?1:t,"app"===e){return{residenceTime:t,overtime:t>300}}if("page"===e){return{residenceTime:t,overtime:t>1800}}return{residenceTime:t}},Le=(e=>{let t=ae.reportInterval;if(0===Number(t))return 0;t=t||e;return/(^[1-9]\d*$)/.test(t)?Number(t):e})(10);let Ie={uuid:J.deviceId||le(),ak:ie.appid,p:"",ut:ce(),mpn:(()=>{let e="";return"wx"!==ce()&&"qq"!==ce()||uni.canIUse("getAccountInfoSync")&&(e=uni.getAccountInfoSync().miniProgram.appId||""),ce(),e})(),usv:W,v:"n"===ce()?plus.runtime.version:"",ch:(()=>{let e="";return"n"===ce()&&(e=plus.runtime.channel),e})(),cn:"",pn:"",ct:"",t:xe(),tt:"",brand:J.brand||"",md:J.model,sv:"",mpsdk:J.SDKVersion||"",mpv:J.version||"",lang:J.language,pr:J.pixelRatio,ww:J.windowWidth,wh:J.windowHeight,sw:J.screenWidth,sh:J.screenHeight};if(J.platform)switch(J.platform){case"android":Ie.p="a";break;case"ios":Ie.p="i";break;case"harmonyos":Ie.p="h"}J.system&&(Ie.sv=J.system.replace(/(Android|iOS)\s/,""));class Ae extends class{constructor(){this.self="",this.__licationShow=!1,this.__licationHide=!1,this.statData=Ie,this._navigationBarTitle={config:"",page:"",report:"",lt:""},this._query={},"function"==typeof uni.addInterceptor&&(this.addInterceptorInit(),this.interceptLogin(),this.interceptShare(!0),this.interceptRequestPayment())}addInterceptorInit(){let e=this;uni.addInterceptor("setNavigationBarTitle",{invoke(t){e._navigationBarTitle.page=t.title}})}interceptLogin(){let e=this;uni.addInterceptor("login",{complete(){e._login()}})}interceptShare(e){let t=this;e?uni.addInterceptor("share",{success(){t._share()},fail(){t._share()}}):t._share()}interceptRequestPayment(){let e=this;uni.addInterceptor("requestPayment",{success(){e._payment("pay_success")},fail(){e._payment("pay_fail")}})}_login(){this.sendEventRequest({key:"login"},0)}_share(){this.sendEventRequest({key:"share"},0)}_payment(e){this.sendEventRequest({key:e},0)}applicationShow(){if(this.__licationHide){if(Pe("app").overtime){let e={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:this.statData.sc,cst:2};this.sendReportRequest(e)}else{const e=re();if(e!==this.statData.sc){let t={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:e,cst:2};this.sendReportRequest(t)}}this.__licationHide=!1}}applicationHide(e,t){e||(e=he()),this.__licationHide=!0;const a=Pe(),s=ue(e);uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",s),this.sendHideRequest({urlref:s,urlref_ts:a.residenceTime},t),Me()}pageShow(e){this._navigationBarTitle={config:"",page:"",report:"",lt:""};const t=ue(e),a=me(e);if(this._navigationBarTitle.config=ge(a),this.__licationShow)return Me(),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",t),void(this.__licationShow=!1);if(Pe("page").overtime){let e={path:t,scene:this.statData.sc,cst:3};this.sendReportRequest(e)}Me()}pageHide(e){if(!this.__licationHide){const t=Pe("page");let a=ue(e),s=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return s||(s=a),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",a),void this.sendPageRequest({url:a,urlref:s,urlref_ts:t.residenceTime})}}sendReportRequest(e,t){this._navigationBarTitle.lt="1",this._navigationBarTitle.config=ge(e.path);let a=e.query&&"{}"!==JSON.stringify(e.query)?"?"+JSON.stringify(e.query):"";const s=(()=>{const e=ee(ye);let t=0;return e&&(t=e),Q(ye,xe()),t})();if(0!==s||!s){const e=(e=>{let t="";if("n"===ce()){try{t=plus.device.uuid}catch(a){t=""}return t}return J.deviceId||le()})();this.statData.odid=e}Object.assign(this.statData,{lt:"1",url:e.path+a||"",t:xe(),sc:re(e.scene),fvts:ke(),lvts:s,tvc:Te(),cst:e.cst||1}),"n"===ce()?this.getProperty(t):this.getNetworkInfo(t)}sendPageRequest(e){let{url:t,urlref:a,urlref_ts:s}=e;this._navigationBarTitle.lt="11";let o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"11",ut:this.statData.ut,url:t,tt:this.statData.tt,urlref:a,urlref_ts:s,ch:this.statData.ch,usv:this.statData.usv,t:xe()};this.request(o)}sendHideRequest(e,t){let{urlref:a,urlref_ts:s}=e,o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"3",ut:this.statData.ut,urlref:a,urlref_ts:s,ch:this.statData.ch,usv:this.statData.usv,t:xe()};this.request(o,t)}sendEventRequest({key:e="",value:t=""}={}){let a="";try{a=me()}catch(o){a=ee("__launch_options").path}this._navigationBarTitle.config=ge(a),this._navigationBarTitle.lt="21";let s={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"21",ut:this.statData.ut,url:a,ch:this.statData.ch,e_n:e,e_v:"object"==typeof t?JSON.stringify(t):t.toString(),usv:this.statData.usv,t:xe()};this.request(s)}sendPushRequest(e,t){let a=xe();const s={lt:"101",cid:t,t:a,ut:this.statData.ut},o=Ee({101:[s]});let n={usv:W,t:a,requests:o};"h5"!==s.ut?"n"!==ce()||"a"!==this.statData.p?this.sendRequest(n):setTimeout((()=>{this.sendRequest(n)}),200):this.imageRequest(n)}getProperty(e){plus.runtime.getProperty(plus.runtime.appid,(t=>{this.statData.v=t.version||"",this.getNetworkInfo(e)}))}getNetworkInfo(e){uni.getNetworkType({success:t=>{this.statData.net=t.networkType,this.getLocation(e)}})}getLocation(e){ie.getLocation?uni.getLocation({type:"wgs84",geocode:!0,success:t=>{t.address&&(this.statData.cn=t.address.country,this.statData.pn=t.address.province,this.statData.ct=t.address.city),this.statData.lat=t.latitude,this.statData.lng=t.longitude,this.request(this.statData,e)}}):(this.statData.lat=0,this.statData.lng=0,this.request(this.statData,e))}request(e,t){let a=xe();const s=this._navigationBarTitle;Object.assign(e,{ttn:s.page,ttpj:s.config,ttc:s.report});let o=ee("__UNI__STAT__DATA")||{};if(o[e.lt]||(o[e.lt]=[]),o[e.lt].push(e),Q("__UNI__STAT__DATA",o),(Ce=xe(),_e=ee(De),Ce-_e)<Le&&!t)return;be();const n=Ee(o);let l={usv:W,t:a,requests:n};te("__UNI__STAT__DATA"),"h5"!==e.ut?"n"!==ce()||"a"!==this.statData.p?this.sendRequest(l):setTimeout((()=>{this.sendRequest(l)}),200):this.imageRequest(l)}getIsReportData(){return new Promise(((e,t)=>{let a="",s=(new Date).getTime(),o=1;try{a=uni.getStorageSync(ve),o=uni.getStorageSync(we)}catch(n){a="",o=1}""!==o?(1===o&&e(),a||(uni.setStorageSync(ve,s),a=s),s-a>864e5&&Ve((({enable:e})=>{uni.setStorageSync(ve,s),uni.setStorageSync(we,e)}))):Ve((({enable:t})=>{uni.setStorageSync(ve,s),uni.setStorageSync(we,t),1===t&&e()}))}))}sendRequest(e){this.getIsReportData().then((()=>{uni.request({url:X,method:"POST",data:e,success:()=>{},fail:t=>{++this._retry<3&&setTimeout((()=>{this.sendRequest(e)}),1e3)}})}))}imageRequest(e){this.getIsReportData().then((()=>{let t=new Image,a=(e=>{let t=Object.keys(e).sort(),a={},s="";for(var o in t)a[t[o]]=e[t[o]],s+=t[o]+"="+e[t[o]]+"&";return{sign:"",options:s.substr(0,s.length-1)}})((e=>{let t={};for(let a in e)t[a]=encodeURIComponent(e[a]);return t})(e)).options;t.src="https://tongji.dcloud.io/uni/stat.gif?"+a}))}sendEvent(e,t){var a,s;(s=t,(a=e)?"string"!=typeof a?(console.error("uni.report [eventName] Parameter type error, it can only be of type String"),1):a.length>255?(console.error("uni.report [eventName] Parameter length cannot be greater than 255"),1):"string"!=typeof s&&"object"!=typeof s?(console.error("uni.report [options] Parameter type error, Only supports String or Object type"),1):"string"==typeof s&&s.length>255?(console.error("uni.report [options] Parameter length cannot be greater than 255"),1):"title"===a&&"string"!=typeof s?(console.error("uni.report [eventName] When the parameter is title, the [options] parameter can only be of type String"),1):void 0:(console.error("uni.report Missing [eventName] parameter"),1))||("title"!==e?this.sendEventRequest({key:e,value:"object"==typeof t?JSON.stringify(t):t},1):this._navigationBarTitle.report=t)}}{static getInstance(){return uni.__stat_instance||(uni.__stat_instance=new Ae),uni.__stat_instance}constructor(){super()}pushEvent(e){const t=(()=>{if(ae.collectItems){const e=ae.collectItems.uniPushClientID;return"boolean"==typeof e&&e}return!1})();uni.getPushClientId&&t&&uni.getPushClientId({success:t=>{const a=t.cid||!1;a&&this.sendPushRequest(e,a)}})}launch(e,t){be(),this.__licationShow=!0,Q("__launch_options",e),e.cst=1,this.sendReportRequest(e,!0)}load(e,t){this.self=t,this._query=e}appHide(e){this.applicationHide(e,!0)}appShow(e){this.applicationShow(e)}show(e){if(this.self=e,"page"===pe(e)){Ne()&&this.pageShow(e)}"h5"!==ce()&&"n"!==ce()||"app"===pe(e)&&this.appShow()}hide(e){if(this.self=e,"page"===pe(e)){Ne()&&this.pageHide(e)}"h5"!==ce()&&"n"!==ce()||"app"===pe(e)&&this.appHide()}error(e){let t="";t=e.message?e.stack:JSON.stringify(e);let a="";try{a=me()}catch(o){a=""}let s={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"31",url:a,ut:this.statData.ut,ch:this.statData.ch,mpsdk:this.statData.mpsdk,mpv:this.statData.mpv,v:this.statData.v,em:t,usv:this.statData.usv,t:parseInt((new Date).getTime()/1e3)};this.request(s)}}const Ue=Ae.getInstance();let Re=!1;const Fe={onLaunch(e){Ue.launch(e,this),Ue.pushEvent(e)},onLoad(e){if(Ue.load(e,this),this.$scope&&this.$scope.onShareAppMessage){let e=this.$scope.onShareAppMessage;this.$scope.onShareAppMessage=function(t){return Ue.interceptShare(!1),e.call(this,t)}}},onShow(){Re=!1,Ue.show(this)},onHide(){Re=!0,Ue.hide(this)},onUnload(){Re?Re=!1:Ue.hide(this)},onError(e){try{Ue.error(e)}catch(t){console.error("uni-stat error:",t)}}};uni.onCreateVueApp((e=>{e.mixin(Fe),uni.report=function(e,t){Ue.sendEvent(e,t)}})),"h5"!==ce()&&"n"!==ce()&&(uni.onAppHide((()=>{Ue.appHide(he())})),uni.onAppShow((()=>{Ue.appShow(he())})));const{app:$e,Vuex:ze,Pinia:Oe}={app:e.createVueApp(Z)};uni.Vuex=ze,uni.Pinia=Oe,$e.provide("__globalStyles",__uniConfig.styles),$e._component.mpType="app",$e._component.render=()=>{},$e.mount("#app")}(Vue);
